
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Python Binding and Packaging &#8212; tvm-ffi</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css?v=a885cde7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=38aa6179" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=a1637f0b"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js?v=73120307"></script>
    <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js?v=660e4f45"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="https://tvm.apache.org/images/logo/tvm-logo-square.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="C++ Guide" href="cpp_guide.html" />
    <link rel="prev" title="Quick Start" href="../get_started/quickstart.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Oct 20, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">tvm-ffi</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../get_started/quickstart.html">Quick Start</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Python Binding and Packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="cpp_guide.html">C++ Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_guide.html">Python Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="rust_guide.html">Rust Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="stable_c_abi.html">Stable C ABI</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiler_integration.html">Compiler Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_from_source.html">Build from Source</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../concepts/abi_overview.html">ABI Overview</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/python/index.html">Python API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Object.html">tvm_ffi.Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Tensor.html">tvm_ffi.Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Shape.html">tvm_ffi.Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Device_class.html">tvm_ffi.Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.from_dlpack.html">tvm_ffi.from_dlpack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.DLDeviceType.html">tvm_ffi.DLDeviceType</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.device_function.html">tvm_ffi.device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.dtype.html">tvm_ffi.dtype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Function.html">tvm_ffi.Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Module.html">tvm_ffi.Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.system_lib.html">tvm_ffi.system_lib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.load_module.html">tvm_ffi.load_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Array.html">tvm_ffi.Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Map.html">tvm_ffi.Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.register_error.html">tvm_ffi.register_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.register_object.html">tvm_ffi.register_object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.register_global_func.html">tvm_ffi.register_global_func</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.get_global_func.html">tvm_ffi.get_global_func</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.get_global_func_metadata.html">tvm_ffi.get_global_func_metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.init_ffi_api.html">tvm_ffi.init_ffi_api</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.remove_global_func.html">tvm_ffi.remove_global_func</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.StreamContext.html">tvm_ffi.StreamContext</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.use_torch_stream.html">tvm_ffi.use_torch_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.use_raw_stream.html">tvm_ffi.use_raw_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/cpp/generated/tvm_ffi.cpp.load_inline.html">tvm_ffi.cpp.load_inline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/cpp/generated/tvm_ffi.cpp.build_inline.html">tvm_ffi.cpp.build_inline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.serialization.html">tvm_ffi.serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.access_path.html">tvm_ffi.access_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.convert.html">tvm_ffi.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.ObjectConvertible.html">tvm_ffi.ObjectConvertible</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/cpp/index.html">C++ API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/cpp/generated/index.html">Full API Index</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm.html">Namespace tvm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi.html">Namespace tvm::ffi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi__json.html">Namespace tvm::ffi::json</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi__reflection.html">Namespace tvm::ffi::reflection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi__symbol.html">Namespace tvm::ffi::symbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1AnyEqual.html">Struct AnyEqual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1AnyHash.html">Struct AnyHash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1DenseMapObj_1_1Block.html">Struct DenseMapObj::Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1DenseMapObj_1_1ItemType.html">Struct DenseMapObj::ItemType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1DenseMapObj_1_1ListNode.html">Struct DenseMapObj::ListNode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1EnvErrorAlreadySet.html">Struct EnvErrorAlreadySet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1FallbackOnlyTraitsBase.html">Template Struct FallbackOnlyTraitsBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1is__valid__iterator.html">Template Struct is_valid_iterator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1is__valid__iterator_3_01Any_00_01IterType_01_4.html">Template Struct is_valid_iterator&lt; Any, IterType &gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1is__valid__iterator_3_01Optional_3_01T_01_4_00_01IterType_01_4.html">Template Struct is_valid_iterator&lt; Optional&lt; T &gt;, IterType &gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1ObjectPtrEqual.html">Struct ObjectPtrEqual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1ObjectPtrHash.html">Struct ObjectPtrHash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1ObjectRefWithFallbackTraitsBase.html">Template Struct ObjectRefWithFallbackTraitsBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1reflection_1_1FieldInfoBuilder.html">Struct FieldInfoBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1reflection_1_1InfoTrait.html">Struct InfoTrait</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1reflection_1_1init.html">Template Struct init</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1reflection_1_1MethodInfoBuilder.html">Struct MethodInfoBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1StaticTypeKey.html">Struct StaticTypeKey</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1TypeToFieldStaticTypeIndex.html">Template Struct TypeToFieldStaticTypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1TypeToRuntimeTypeIndex.html">Template Struct TypeToRuntimeTypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1UnsafeInit.html">Struct UnsafeInit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIAny.html">Struct TVMFFIAny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIByteArray.html">Struct TVMFFIByteArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIErrorCell.html">Struct TVMFFIErrorCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIFieldInfo.html">Struct TVMFFIFieldInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIFunctionCell.html">Struct TVMFFIFunctionCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIMethodInfo.html">Struct TVMFFIMethodInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIObject.html">Struct TVMFFIObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIOpaqueObjectCell.html">Struct TVMFFIOpaqueObjectCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIShapeCell.html">Struct TVMFFIShapeCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFITypeAttrColumn.html">Struct TVMFFITypeAttrColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFITypeInfo.html">Struct TVMFFITypeInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFITypeMetadata.html">Struct TVMFFITypeMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIVersion.html">Struct TVMFFIVersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html">Class Any</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html">Class AnyView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Array.html">Template Class Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ArrayObj.html">Class ArrayObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Bytes.html">Class Bytes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1DenseMapObj.html">Class DenseMapObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Error.html">Class Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ErrorObj.html">Class ErrorObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Function.html">Class Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1FunctionObj.html">Class FunctionObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Map.html">Template Class Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1MapObj.html">Class MapObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Module.html">Class Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ModuleObj.html">Class ModuleObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Object.html">Class Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ObjectPtr.html">Template Class ObjectPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ObjectRef.html">Class ObjectRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Optional.html">Template Class Optional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1PackedArgs.html">Class PackedArgs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AccessPath.html">Class AccessPath</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AccessPathObj.html">Class AccessPathObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AccessStep.html">Class AccessStep</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AccessStepObj.html">Class AccessStepObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AttachFieldFlag.html">Class AttachFieldFlag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1DefaultValue.html">Class DefaultValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1FieldGetter.html">Class FieldGetter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1FieldSetter.html">Class FieldSetter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1GlobalDef.html">Class GlobalDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1Metadata.html">Class Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1ObjectCreator.html">Class ObjectCreator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1ObjectDef.html">Template Class ObjectDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1TypeAttrColumn.html">Class TypeAttrColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1TypeAttrDef.html">Template Class TypeAttrDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1RValueRef.html">Template Class RValueRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Shape.html">Class Shape</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ShapeObj.html">Class ShapeObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ShapeView.html">Class ShapeView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1SmallMapObj.html">Class SmallMapObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1StrictBool.html">Class StrictBool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1String.html">Class String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1StructuralEqual.html">Class StructuralEqual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1StructuralHash.html">Class StructuralHash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html">Class Tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html">Class TensorObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html">Class TensorView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tuple.html">Template Class Tuple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TypedFunction.html">Template Class TypedFunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TypedFunction_3_01R_07Args_8_8_8_08_4.html">Template Class TypedFunction&lt; R(Args…) &gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Variant.html">Template Class Variant</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1WeakObjectPtr.html">Template Class WeakObjectPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_dtype_8h_1a16f66b97fa44d7bd6114324c8b8e1bed.html">Enum DLExtDataTypeCode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_namespacetvm_1_1ffi_1_1reflection_1a9c2cd4d683e7c7065942e36e628a2517.html">Enum AccessKind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1ad6a441d28d4a6406418489609e975a19.html">Enum TVMFFIBacktraceUpdateMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1ad5a608f648c4f86cafdc8dc09f870bc5.html">Enum TVMFFIFieldFlagBitMask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a8eb3fb55f6ec3c46b6e57740af4ca58a.html">Enum TVMFFIObjectDeleterFlagBitMask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1aea0f30bf60e26c1322e525e246ef5be9.html">Enum TVMFFISEqHashKind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html">Enum TVMFFITypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_base64_8h_1ae1d4736f7dc56b224acd303ba7bf7a45.html">Function tvm::ffi::Base64Decode(TVMFFIByteArray)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_base64_8h_1acb849cdb1d9b9620be10bbcda0257afa.html">Function tvm::ffi::Base64Decode(const String&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_base64_8h_1aa5b2a4531449585b9f079cb170a79f0b.html">Function tvm::ffi::Base64Encode(TVMFFIByteArray)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_base64_8h_1a279b4ba2f4c7ea16291ef24b73e43963.html">Function tvm::ffi::Base64Encode(const Bytes&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_endian_8h_1ab4e0ed8000c632cd2c7cd089c0a0d1af.html">Function tvm::ffi::ByteSwap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_array_8h_1af5983fd2a31e79635307875b3a216472.html">Template Function tvm::ffi::Concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_dtype_8h_1a94787950883e5a7e97b764ddd342afc3.html">Function tvm::ffi::DLDataTypeToString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_string_8h_1aa190eed2516ff9a633009cc62f660502.html">Function tvm::ffi::EscapeString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_serialization_8h_1a56baa5d1ca415dbdebf19ac1f54bd5b7.html">Function tvm::ffi::FromJSONGraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a71e4a492b5a03a19a95087771a7e9ed1.html">Function tvm::ffi::GetDataSize(size_t, DLDataType)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a226723176642cde5996498e7da6a6368.html">Function tvm::ffi::GetDataSize(const DLTensor&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a011d0a2dcbe5702156124d7a7223b3dd.html">Function tvm::ffi::GetDataSize(const Tensor&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a65b3a61c540c72d9410150a3a7a76dde.html">Function tvm::ffi::GetDataSize(const TensorView&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_cast_8h_1a4dba749dd934d8a7891ad126a8fdcc1f.html">Template Function tvm::ffi::GetObjectPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_cast_8h_1a3c5fed9bb23b4804b61037c8ac4874f1.html">Template Function tvm::ffi::GetRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1aa79cf4e1e3873d8947050b3cee41153a.html">Function tvm::ffi::IsAligned</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a93094b6b3f20c2cd5aa1c1c2522bc3e4.html">Function tvm::ffi::IsContiguous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1aab70a15ca1dde710bc3052c5ce1f6fbd.html">Function tvm::ffi::IsDirectAddressDevice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_json_8h_1a86217bda8bfebd85f8265878bc8a59b8.html">Function tvm::ffi::json::Parse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_json_8h_1a2cd33b0fbc0194eaa803b8a476670587.html">Function tvm::ffi::json::Stringify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_memory_8h_1a801e8ecc2e3adbc1dac52c714e7cef11.html">Template Function tvm::ffi::make_inplace_array_object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_array_8h_1a3b56317c7cfb2760cf6c09c303840967.html">Specialized Template Function tvm::ffi::make_object()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_memory_8h_1a8892f2a3cad8dbc51930c464f2ab863b.html">Template Function tvm::ffi::make_object(Args&amp;&amp;…)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_map_8h_1a611844db41026b7a95846dd316b435af.html">Template Function tvm::ffi::Merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1a735285a70c7c4308816450a5b27f03f2.html">Function tvm::ffi::reflection::EnsureTypeAttrColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1a32d91001c82e10566c69e237ab0de50a.html">Template Function tvm::ffi::reflection::ForEachFieldInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1acc0ded3ead1cc6ffc836005d3bb2cc9c.html">Template Function tvm::ffi::reflection::ForEachFieldInfoWithEarlyStop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1a6b1f837cf822ded72a31f343ce987f4c.html">Template Function tvm::ffi::reflection::GetFieldByteOffsetToObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1a80c4984a43d14113b20a67c966833709.html">Function tvm::ffi::reflection::GetFieldInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1aba4d7fd771bea88a32803dda191b7044.html">Function tvm::ffi::reflection::GetMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1ac902a725008e348254ee7a2d07c8a95a.html">Function tvm::ffi::reflection::GetMethodInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_dtype_8h_1a8a71c64237efaa13a8d40dfacd6c3165.html">Function tvm::ffi::StringToDLDataType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_serialization_8h_1a24d1febeb5c1026e7fd66dee9dd9915f.html">Function tvm::ffi::ToJSONGraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_string_8h_1ad045700080c053c50d68cde298b2b4b2.html">Function tvm::ffi::ToStringView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_object_8h_1a0d6e075f219808c4ff7adebd99210a7b.html">Function tvm::ffi::TypeIndexToTypeKey</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_8h_1a111e2ed7444eb220e19c7624d0932d89.html">Function tvm::ffi::TypeKeyToIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a63149ed43a6ecffa2146f92914c0bc7b.html">Function TVMFFIAnyViewToOwnedAny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac0e2d59d3a8ba7f2b32eac47b1c6fc5d.html">Function TVMFFIBacktrace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aa2a81275b69ba0f61ce556df85517ef9.html">Function TVMFFIBytesFromByteArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1dd5584d94f6e00a18f4cfa003dfb93a.html">Function TVMFFIBytesGetByteArrayPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a44604b1d0db208ed82cbc7cf0fd0f47c.html">Function TVMFFIDataTypeFromString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a402f64dec7a665f281e55cf946a7481b.html">Function TVMFFIDataTypeToString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a762fc5c881dc5f66066eb45b65a5781f.html">Function TVMFFIDLDeviceFromIntPair</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a0e01ad3ed44c0240f1b76dbed7014234.html">Function TVMFFIEnvCheckSignals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1ac8f7894c4f205756b7aee01108ab8e84.html">Function TVMFFIEnvGetDLPackManagedTensorAllocator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a8ce2ba89ca1d010a084b4c36ed6b2965.html">Function TVMFFIEnvGetStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1abcbbccfc02c57418e757033afce42ece.html">Function TVMFFIEnvModLookupFromImports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a7451ab18593d70d30a6214d622e200d2.html">Function TVMFFIEnvModRegisterContextSymbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a9b142b59ab84bc06e4a0f66a3510e8f7.html">Function TVMFFIEnvModRegisterSystemLibSymbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a36c15024744584acceaf0233947f9505.html">Function TVMFFIEnvRegisterCAPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1aaf8960c33546788950b8e35ac18efe39.html">Function TVMFFIEnvSetDLPackManagedTensorAllocator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1ae24b47945440d1c0aca13af13bdaf916.html">Function TVMFFIEnvSetStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a683191d48d3fdebc98b68f3b717baf6a.html">Function TVMFFIEnvTensorAlloc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a3479c144d165e717d1464b7b4df84897.html">Function TVMFFIErrorCreate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a0ee6d2da9a72749561838bf503f62f93.html">Function TVMFFIErrorGetCellPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a268d0b5dc89146020c09f77fa0eb8f67.html">Function TVMFFIErrorMoveFromRaised</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1af108ca4da596c634b4cb9e82c8bec1ce.html">Function TVMFFIErrorSetRaised</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aedd89f80f73d54dd5904d943dd0690c6.html">Function TVMFFIErrorSetRaisedFromCStr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a56ce10d1e6fc2d34a1a496bdace4af33.html">Function TVMFFIErrorSetRaisedFromCStrParts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1ac76d88e0d79843403ce2e0239d7fe2.html">Function TVMFFIFunctionCall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a4ce84fc667040bba425664c78b5f2c69.html">Function TVMFFIFunctionCreate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a0d3dcd6ceff356614a6924201c02cf97.html">Function TVMFFIFunctionGetCellPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a3bf47f6e1229627902c80217d674ed29.html">Function TVMFFIFunctionGetGlobal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a177d080127ef8f3e338beb7dba4c04fd.html">Function TVMFFIFunctionSetGlobal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aa26fa16c024c6f2fa15e46aa1333fdb9.html">Function TVMFFIFunctionSetGlobalFromMethodInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a53c5ec2971806966ed96a6add32b5238.html">Function TVMFFIGetTypeAttrColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1afee5a803e22f9baf5ee2ff1f0ace6429.html">Function TVMFFIGetTypeInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a145f2694254410fd4814541e2cde99c1.html">Function TVMFFIGetVersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a6415c088928d62af8749f3dc57dcf23b.html">Function TVMFFIObjectCreateOpaque</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aba50ba2cee84b1ef7a718211ab349031.html">Function TVMFFIObjectDecRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a31a317a32bfa641180eed1bfb3d5cf01.html">Function TVMFFIObjectGetTypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac66c1d142240be0cdf65c8ba38770eb6.html">Function TVMFFIObjectIncRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a3253bbf35e2ad1361b2ce1de13d2c9b2.html">Function TVMFFIOpaqueObjectGetCellPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a74c26efdd74840abc3e1581c73a38bfa.html">Function TVMFFIShapeGetCellPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a724b0d386cf3d50c7d141ca37be19092.html">Function TVMFFISmallBytesGetContentByteArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a5a7e3fe8a94e066bc1bf897fbf736651.html">Function TVMFFIStringFromByteArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1af1b8a29eb3f9405982c344f5e572dd65.html">Function TVMFFITensorFromDLPack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1adaf9a5ab3d30bb3eca58b430f2592fc0.html">Function TVMFFITensorFromDLPackVersioned</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ab691fd5bc4442c631c1f70985a962f50.html">Function TVMFFITensorGetDLTensorPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1adec9f8a8f0683caeb9dd194d9a3c62d5.html">Function TVMFFITensorToDLPack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1162f2cbaf1a7628a03ed9488cff858b.html">Function TVMFFITensorToDLPackVersioned</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a3f859b60d99c85f43fce8226c69f3c5e.html">Function TVMFFITypeGetOrAllocIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac64df2793c84fc8ba5d24968d60bcada.html">Function TVMFFITypeKeyToIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac5a4f48eacde3c69ad3154b6aa39fa3c.html">Function TVMFFITypeRegisterAttr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1a99289a314c6c3de865721bd3efb525.html">Function TVMFFITypeRegisterField</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aeee9dab8873b5b2f327f4dfe50f802ab.html">Function TVMFFITypeRegisterMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a4e8b3caff4da72205ec1ac9a811748e5.html">Function TVMFFITypeRegisterMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_array_8h_1a3bbf4c2bf19b72b026ad9e19a23143d5.html">Variable tvm::ffi::is_valid_iterator_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1aae0405c7615139afd4f68b72a862cffe.html">Variable tvm::ffi::symbol::tvm_ffi_library_bin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1a76f8a8fd1e38fd98cc501623d959ee58.html">Variable tvm::ffi::symbol::tvm_ffi_library_ctx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1ad9c186f1359987cef9278993037b3f66.html">Variable tvm::ffi::symbol::tvm_ffi_main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1a07576e172e0788da4982148edcf53b05.html">Variable tvm::ffi::symbol::tvm_ffi_metadata_prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1ac261d9ce6ffb49dd9878610ce217075e.html">Variable tvm::ffi::symbol::tvm_ffi_symbol_prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a288653475dd42db1c715a11ab2972578.html">Define TVM_FFI_ALWAYS_LOG_BEFORE_THROW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a7205bbaef1c45e57f939af6deefb6449.html">Define TVM_FFI_BACKTRACE_ON_SEGFAULT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1ad4674e1cb9c051f47127e5331a4bcadc.html">Define TVM_FFI_CHECK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a64c939463f90816ffc2b70bc89ea3e43.html">Define TVM_FFI_CHECK_FUNC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1a14328d95ccda4b1691b9874645aef4bd.html">Define TVM_FFI_CHECK_SAFE_CALL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a438ff7ee1fc503216d35e156081280c0.html">Define TVM_FFI_DECLARE_OBJECT_INFO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1ac593f4065568c8f61cf38d00d585befd.html">Define TVM_FFI_DECLARE_OBJECT_INFO_FINAL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a9d1c42071de0440f70c7bb5e0bd0f325.html">Define TVM_FFI_DECLARE_OBJECT_INFO_PREDEFINED_TYPE_KEY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a6ad2a76d53c8c695743f7a275c8c0523.html">Define TVM_FFI_DECLARE_OBJECT_INFO_STATIC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a4ac33631a9b51877808ec7edf010f0d2.html">Define TVM_FFI_DEFINE_OBJECT_REF_METHODS_NOTNULLABLE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a0fc0cc2d8f4318bc41a896c117e8a15c.html">Define TVM_FFI_DEFINE_OBJECT_REF_METHODS_NULLABLE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1a01777f12f8f99771331d679a0c1d2ed4.html">Define TVM_FFI_DLL_EXPORT_TYPED_FUNC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a6c01470f76c6437edf93ac668ea6242a.html">Define TVM_FFI_ICHECK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a83986fc775d68d4abcc209c2f67dde6e.html">Define TVM_FFI_ICHECK_BINARY_OP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a394ec1781a34c49e29d47db5c3dfad9c.html">Define TVM_FFI_ICHECK_EQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1ae5be195e80d32413cbe5e2ad11e146f7.html">Define TVM_FFI_ICHECK_GE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1af1f84686ce5635b3a378567368e89e4d.html">Define TVM_FFI_ICHECK_GT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1aade00b2e0a9789e3e8bf33441d651455.html">Define TVM_FFI_ICHECK_LE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a1a94c8b78e74adec05051abb9055e7b8.html">Define TVM_FFI_ICHECK_LT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1afcd5778e656fa2c20aa0b81fbcebc497.html">Define TVM_FFI_ICHECK_NE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a26827bb8bc9e39255060f6be1d2a37fb.html">Define TVM_FFI_ICHECK_NOTNULL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_endian_8h_1a2ebd9542b313b3b45b2892f2b3d4f26d.html">Define TVM_FFI_IO_NO_ENDIAN_SWAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_endian_8h_1a912dbc7a68913612c723f877acaa8105.html">Define TVM_FFI_IO_USE_LITTLE_ENDIAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a927d4ae2bbf7a08723643993e780f183.html">Define TVM_FFI_LOG_AND_THROW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1a10bd932564c8e71a3978a061fbb82360.html">Define TVM_FFI_SAFE_CALL_BEGIN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1ae3c016c4bf383aa205b4485edd7ca17c.html">Define TVM_FFI_SAFE_CALL_END</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a8df4e0ff8a6195274c6f7c031a4f0db4.html">Define TVM_FFI_THROW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a386641a33bb14802830471a2442ddd7d.html">Define TVM_FFI_USE_LIBBACKTRACE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_c__api_8h_1a4241f838270253b885e1de02534bc273.html">Define TVM_FFI_VERSION_MAJOR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_c__api_8h_1a717daddad98d127813ba8ff5a715e929.html">Define TVM_FFI_VERSION_MINOR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_c__api_8h_1a42634cb2690dce4d9af6c2a402fc903c.html">Define TVM_FFI_VERSION_PATCH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_c__api_8h_1a01871644eed04162005df7faa5442f92.html">Define TVM_FFI_WEAK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_memory_8h_1a65bf625279df21dec5c8097264415113.html">Typedef tvm::ffi::FObjectDeleter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_json_8h_1aeb9cdccfbc28034e94e46f9f6bd8d92a.html">Typedef tvm::ffi::json::Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_json_8h_1a74ca72d0b686c114af683d63e96f2998.html">Typedef tvm::ffi::json::Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_json_8h_1a8e808548bb6a99d0a6093ab3e2229ad3.html">Typedef tvm::ffi::json::Value</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_namespacetvm_1_1ffi_1_1reflection_1a96513314d45b43eada132d9b96653d9a.html">Typedef tvm::ffi::reflection::_MetadataType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_namespacetvm_1_1ffi_1_1reflection_1a32b044a71a094de492867144ca299c15.html">Typedef tvm::ffi::reflection::AccessPathPair</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_object_8h_1a7ba296d84188e5970ba854332a1f04a6.html">Typedef tvm::ffi::TypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_object_8h_1ae125f5f5a8a94c7340577c1959805295.html">Typedef tvm::ffi::TypeInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1ae22f1a87cbaf7f744d9201948c05d2a5.html">Typedef TVMFFIFieldGetter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1aba6bf585b03799369fb535db4a5d2e79.html">Typedef TVMFFIFieldSetter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1a19fdd3c500a70abb3def842c73694548.html">Typedef TVMFFIObjectCreator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1aa0abef2444fde82d76337218e5c13b3f.html">Typedef TVMFFIObjectHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1a9eee5afddb1b39723847d67d109c03fe.html">Typedef TVMFFISafeCallType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__env__api_8h_1aa7abccefa41ac9d3040df689c0c72fa4.html">Typedef TVMFFIStreamHandle</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/rust/index.html">Rust API</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/apache/tvm-ffi" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/guides/python_packaging.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Python Binding and Packaging</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directly-using-exported-library">Directly using Exported Library</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pybind11-and-nanobind-style-usage">Pybind11 and Nanobind style Usage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relations-to-existing-solutions">Relations to Existing Solutions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-with-existing-solutions">Mix with Existing Solutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-project-walk-through">Example Project Walk Through</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-pyproject-toml">Setup pyproject.toml</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-cmakelists-txt">Setup CMakeLists.txt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exposing-c-functions">Exposing C++ Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#library-loading-in-python">Library Loading in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-and-use-the-package">Build and Use the Package</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wheel-auditing">Wheel Auditing</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <!--- Licensed to the Apache Software Foundation (ASF) under one -->
<!--- or more contributor license agreements.  See the NOTICE file -->
<!--- distributed with this work for additional information -->
<!--- regarding copyright ownership.  The ASF licenses this file -->
<!--- to you under the Apache License, Version 2.0 (the -->
<!--- "License"); you may not use this file except in compliance -->
<!--- with the License.  You may obtain a copy of the License at -->
<!---   http://www.apache.org/licenses/LICENSE-2.0 -->
<!--- Unless required by applicable law or agreed to in writing, -->
<!--- software distributed under the License is distributed on an -->
<!--- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY -->
<!--- KIND, either express or implied.  See the License for the -->
<!--- specific language governing permissions and limitations -->
<!--- under the License. -->
<section class="tex2jax_ignore mathjax_ignore" id="python-binding-and-packaging">
<h1>Python Binding and Packaging<a class="headerlink" href="#python-binding-and-packaging" title="Link to this heading">#</a></h1>
<p>This guide explains how to leverage tvm-ffi to expose C++ functions into Python and package them into a wheel.
At a high level, packaging with tvm-ffi offers several benefits:</p>
<ul class="simple">
<li><p><strong>Ship one wheel</strong> that can be used across Python versions, including free-threaded Python.</p></li>
<li><p><strong>Multi-language access</strong> to functions from Python, C++, Rust and other languages that support the ABI.</p></li>
<li><p><strong>ML Systems Interop</strong> with ML frameworks, DSLs, and libraries while maintaining minimal dependency.</p></li>
</ul>
<section id="directly-using-exported-library">
<h2>Directly using Exported Library<a class="headerlink" href="#directly-using-exported-library" title="Link to this heading">#</a></h2>
<p>If you just need to expose a simple set of functions,
you can declare an exported symbol in C++:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Compiles to mylib.so</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tvm/ffi/function.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">add_one</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">TVM_FFI_DLL_EXPORT_TYPED_FUNC</span><span class="p">(</span><span class="n">add_one</span><span class="p">,</span><span class="w"> </span><span class="n">add_one</span><span class="p">)</span>
</pre></div>
</div>
<p>You then load the exported function in your Python project via <a class="reference internal" href="../reference/python/generated/tvm_ffi.load_module.html#tvm_ffi.load_module" title="tvm_ffi.load_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvm_ffi.load_module()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In your __init__.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tvm_ffi</span>

<span class="n">_LIB</span> <span class="o">=</span> <span class="n">tvm_ffi</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="s2">&quot;/path/to/mlib.so&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">add_one</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Expose mylib.add_one&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_LIB</span><span class="o">.</span><span class="n">add_one</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>This approach is like using <a class="reference external" href="https://docs.python.org/3.12/library/ctypes.html#module-ctypes" title="(in Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a> to load and run DLLs, except we have more powerful features:</p>
<ul class="simple">
<li><p>We can pass in <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code> (or any other DLPack-compatible arrays).</p></li>
<li><p>We can pass in a richer set of data structures such as strings, tuples, and dicts.</p></li>
<li><p><a class="reference internal" href="../reference/python/generated/tvm_ffi.Function.html#tvm_ffi.Function" title="tvm_ffi.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">tvm_ffi.Function</span></code></a> enables natural callbacks to Python lambdas or other languages.</p></li>
<li><p>Exceptions are propagated naturally across language boundaries.</p></li>
</ul>
</section>
<section id="pybind11-and-nanobind-style-usage">
<h2>Pybind11 and Nanobind style Usage<a class="headerlink" href="#pybind11-and-nanobind-style-usage" title="Link to this heading">#</a></h2>
<p>For advanced use cases where users may wish to register global functions or custom object types,
we also provide a pybind11/nanobind style API to register functions and custom objects.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tvm/ffi/error.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tvm/ffi/reflection/registry.h&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">my_ffi_extension</span><span class="w"> </span><span class="p">{</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ffi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">tvm</span><span class="o">::</span><span class="nn">ffi</span><span class="p">;</span>

<span class="cm">/*!</span>
<span class="cm"> * \brief Example of a custom object that is exposed to the FFI library</span>
<span class="cm"> */</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IntPairObj</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ffi</span><span class="o">::</span><span class="n">Object</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>

<span class="w">  </span><span class="n">IntPairObj</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="w">  </span><span class="n">IntPairObj</span><span class="p">(</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="w">  </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">GetFirst</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Required: declare type information</span>
<span class="w">  </span><span class="n">TVM_FFI_DECLARE_OBJECT_INFO_FINAL</span><span class="p">(</span><span class="s">&quot;my_ffi_extension.IntPair&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">IntPairObj</span><span class="p">,</span><span class="w"> </span><span class="n">ffi</span><span class="o">::</span><span class="n">Object</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/*!</span>
<span class="cm"> * \brief Defines an explicit reference to IntPairObj</span>
<span class="cm"> *</span>
<span class="cm"> * A reference wrapper serves as a reference-counted pointer to the object.</span>
<span class="cm"> * You can use obj-&gt;field to access the fields of the object.</span>
<span class="cm"> */</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IntPair</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">tvm</span><span class="o">::</span><span class="n">ffi</span><span class="o">::</span><span class="n">ObjectRef</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="c1">// Constructor</span>
<span class="w">  </span><span class="k">explicit</span><span class="w"> </span><span class="n">IntPair</span><span class="p">(</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">data_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tvm</span><span class="o">::</span><span class="n">ffi</span><span class="o">::</span><span class="n">make_object</span><span class="o">&lt;</span><span class="n">IntPairObj</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Required: define object reference methods</span>
<span class="w">  </span><span class="n">TVM_FFI_DEFINE_OBJECT_REF_METHODS_NULLABLE</span><span class="p">(</span><span class="n">IntPair</span><span class="p">,</span><span class="w"> </span><span class="n">tvm</span><span class="o">::</span><span class="n">ffi</span><span class="o">::</span><span class="n">ObjectRef</span><span class="p">,</span><span class="w"> </span><span class="n">IntPairObj</span><span class="p">);</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">RaiseError</span><span class="p">(</span><span class="n">ffi</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">TVM_FFI_THROW</span><span class="p">(</span><span class="n">RuntimeError</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="n">TVM_FFI_STATIC_INIT_BLOCK</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">namespace</span><span class="w"> </span><span class="nn">refl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">tvm</span><span class="o">::</span><span class="nn">ffi</span><span class="o">::</span><span class="nn">reflection</span><span class="p">;</span>
<span class="w">  </span><span class="n">refl</span><span class="o">::</span><span class="n">GlobalDef</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;my_ffi_extension.raise_error&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">RaiseError</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// register object definition</span>
<span class="w">  </span><span class="n">refl</span><span class="o">::</span><span class="n">ObjectDef</span><span class="o">&lt;</span><span class="n">IntPairObj</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">      </span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">refl</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">int64_t</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="o">&gt;</span><span class="p">())</span>
<span class="w">       </span><span class="c1">// Example static method that returns the second element of the pair</span>
<span class="w">      </span><span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;static_get_second&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[](</span><span class="n">IntPair</span><span class="w"> </span><span class="n">pair</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">pair</span><span class="o">-&gt;</span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="p">})</span>
<span class="w">      </span><span class="c1">// Example to bind an instance method</span>
<span class="w">      </span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;get_first&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">IntPairObj</span><span class="o">::</span><span class="n">GetFirst</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="n">def_ro</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">IntPairObj</span><span class="o">::</span><span class="n">a</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="n">def_ro</span><span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">IntPairObj</span><span class="o">::</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span><span class="w">  </span><span class="c1">// namespace my_ffi_extension</span>
</pre></div>
</div>
<p>Then these functions and objects can be accessed from Python as long as the library is loaded.
You can use <a class="reference internal" href="../reference/python/generated/tvm_ffi.load_module.html#tvm_ffi.load_module" title="tvm_ffi.load_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvm_ffi.load_module()</span></code></a> or simply use <a class="reference external" href="https://docs.python.org/3.12/library/ctypes.html#ctypes.CDLL" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ctypes.CDLL</span></code></a>. Then you can access
the function through <a class="reference internal" href="../reference/python/generated/tvm_ffi.get_global_func.html#tvm_ffi.get_global_func" title="tvm_ffi.get_global_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvm_ffi.get_global_func()</span></code></a> or <a class="reference internal" href="../reference/python/generated/tvm_ffi.init_ffi_api.html#tvm_ffi.init_ffi_api" title="tvm_ffi.init_ffi_api"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvm_ffi.init_ffi_api()</span></code></a>.
We also allow direct exposure of object via <a class="reference internal" href="../reference/python/generated/tvm_ffi.register_object.html#tvm_ffi.register_object" title="tvm_ffi.register_object"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvm_ffi.register_object()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># __init__.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tvm_ffi</span>

<span class="k">def</span><span class="w"> </span><span class="nf">raise_error</span><span class="p">(</span><span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrap raise error function.&quot;&quot;&quot;</span>
    <span class="c1"># Usually we reorganize these functions into a _ffi_api.py and load once</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">tvm_ffi</span><span class="o">.</span><span class="n">get_global_func</span><span class="p">(</span><span class="s2">&quot;my_ffi_extension.raise_error&quot;</span><span class="p">)</span>
    <span class="n">func</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>


<span class="nd">@tvm_ffi</span><span class="o">.</span><span class="n">register_object</span><span class="p">(</span><span class="s2">&quot;my_ffi_extension.IntPair&quot;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IntPair</span><span class="p">(</span><span class="n">tvm_ffi</span><span class="o">.</span><span class="n">Object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;IntPair object.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct the object.&quot;&quot;&quot;</span>
        <span class="c1"># __ffi_init__ call into the refl::init&lt;&gt; registered</span>
        <span class="c1"># in the static initialization block of the extension library</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ffi_init__</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_example</span><span class="p">():</span>
    <span class="n">pair</span> <span class="o">=</span> <span class="n">IntPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c1"># prints 1</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_first</span><span class="p">())</span>
    <span class="c1"># prints 2</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">IntPair</span><span class="o">.</span><span class="n">static_get_second</span><span class="p">(</span><span class="n">pair</span><span class="p">))</span>
    <span class="c1"># Raises a RuntimeError(&quot;error happens&quot;)</span>
    <span class="n">raise_error</span><span class="p">(</span><span class="s2">&quot;error happens&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="relations-to-existing-solutions">
<h3>Relations to Existing Solutions<a class="headerlink" href="#relations-to-existing-solutions" title="Link to this heading">#</a></h3>
<p>Most current binding systems focus on creating one-to-one bindings
that take a source language and bind to an existing target language runtime and ABI.
We deliberately take a more decoupled approach here:</p>
<ul class="simple">
<li><p>Build stable, minimal ABI convention that is agnostic to the target language.</p></li>
<li><p>Create bindings to connect the source and target language to the ABI.</p></li>
</ul>
<p>The focus of this project is the ABI itself which we believe can help the overall ecosystem.
We also anticipate there are possibilities for existing binding generators to also target the tvm-ffi ABI.</p>
<p><strong>Design philosophy</strong>. We have the following design philosophies focusing on ML systems.</p>
<ul class="simple">
<li><p>FFI and cross-language interop should be first-class citizens in ML systems rather than an add-on.</p></li>
<li><p>Enable multi-environment support in both source and target languages.</p></li>
<li><p>The same ABI should be minimal and targetable by DSL compilers.</p></li>
</ul>
<p>Of course, there is always a tradeoff. It is by design impossible to support arbitrary advanced language features
in the target language, as different programming languages have their own design considerations.
We do believe it is possible to build a universal, effective, and minimal ABI for machine learning
system use cases. Based on the above design philosophies, we focus our cross-language
interaction interface through the FFI ABI for machine learning systems.</p>
<p>So if you are building projects related to machine learning compilers, runtimes,
libraries, frameworks, DSLs, or generally scientific computing, we encourage you
to try it out. The extension mechanism can likely support features in other domains as well
and we welcome you to try it out as well.</p>
</section>
<section id="mix-with-existing-solutions">
<h3>Mix with Existing Solutions<a class="headerlink" href="#mix-with-existing-solutions" title="Link to this heading">#</a></h3>
<p>Because the global registry mechanism only relies on the code being linked,
you can also partially use tvm-ffi-based registration together with pybind11/nanobind in your project.
Just add the related code, link to <code class="docutils literal notranslate"><span class="pre">libtvm_ffi</span></code> and make sure you <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">tvm_ffi</span></code> before importing
your module to ensure related symbols are available.
This approach may help to quickly leverage some of the cross-language features we have.
It also provides more powerful interaction with the host Python language, but of course the tradeoff
is that the final library will now also depend on the Python ABI.</p>
</section>
</section>
<section id="example-project-walk-through">
<h2>Example Project Walk Through<a class="headerlink" href="#example-project-walk-through" title="Link to this heading">#</a></h2>
<p>To get hands-on experience with the packaging flow,
you can try out an example project in our folder.
First, obtain a copy of the tvm-ffi source code.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/apache/tvm-ffi<span class="w"> </span>--recursive
<span class="nb">cd</span><span class="w"> </span>tvm-ffi
</pre></div>
</div>
<p>The examples are now in the examples folder. You can quickly build
and install the example using the following commands.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>examples/packaging
pip<span class="w"> </span>install<span class="w"> </span>-v<span class="w"> </span>.
</pre></div>
</div>
<p>Then you can run examples that leverage the built wheel package.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>run_example.py<span class="w"> </span>add_one
</pre></div>
</div>
</section>
<section id="setup-pyproject-toml">
<h2>Setup pyproject.toml<a class="headerlink" href="#setup-pyproject-toml" title="Link to this heading">#</a></h2>
<p>A typical tvm-ffi-based project has the following structure:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>├── CMakeLists.txt          # CMake build configuration
├── pyproject.toml          # Python packaging configuration
├── src/
│   └── extension.cc        # C++ source code
├── python/
│   └── my_ffi_extension/
│       ├── __init__.py     # Python package initialization
│       ├── base.py         # Library loading logic
│       └── _ffi_api.py     # FFI API registration
└── README.md               # Project documentation
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file configures the build system and project metadata.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[project]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my-ffi-extension&quot;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;0.1.0&quot;</span>
<span class="c1"># ... more project metadata omitted ...</span>

<span class="k">[build-system]</span>
<span class="n">requires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;scikit-build-core&gt;=0.10.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;apache-tvm-ffi&quot;</span><span class="p">]</span>
<span class="n">build-backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;scikit_build_core.build&quot;</span>

<span class="k">[tool.scikit-build]</span>
<span class="c1"># ABI-agnostic wheel</span>
<span class="n">wheel</span><span class="p">.</span><span class="n">py-api</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;py3&quot;</span>
<span class="c1"># ... more build configuration omitted ...</span>
</pre></div>
</div>
<p>We use scikit-build-core for building the wheel. Make sure you add tvm-ffi as a build-system requirement.
Importantly, we should set <code class="docutils literal notranslate"><span class="pre">wheel.py-api</span></code> to <code class="docutils literal notranslate"><span class="pre">py3</span></code> to indicate it is ABI-generic.</p>
<section id="setup-cmakelists-txt">
<h3>Setup CMakeLists.txt<a class="headerlink" href="#setup-cmakelists-txt" title="Link to this heading">#</a></h3>
<p>The CMakeLists.txt handles the build and linking of the project.
There are two ways you can build with tvm-ffi:</p>
<ul class="simple">
<li><p>Link the pre-built <code class="docutils literal notranslate"><span class="pre">libtvm_ffi</span></code> shipped from the pip package</p></li>
<li><p>Build tvm-ffi from source</p></li>
</ul>
<p>For common cases, using the pre-built library and linking tvm_ffi_shared is sufficient.
To build with the pre-built library, you can do:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.18</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">my_ffi_extension</span><span class="p">)</span>

<span class="nb">find_package</span><span class="p">(</span><span class="s">Python</span><span class="w"> </span><span class="s">COMPONENTS</span><span class="w"> </span><span class="s">Interpreter</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="c"># find the prebuilt package</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">tvm_ffi</span><span class="w"> </span><span class="s">CONFIG</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>

<span class="c"># ... more cmake configuration omitted ...</span>

<span class="c"># linking the library</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">my_ffi_extension</span><span class="w"> </span><span class="s">tvm_ffi_shared</span><span class="p">)</span>
</pre></div>
</div>
<p>There are cases where one may want to cross-compile or bundle part of tvm_ffi objects directly
into the project. In such cases, you should build from source.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">execute_process</span><span class="p">(</span>
<span class="w">  </span><span class="s">COMMAND</span><span class="w"> </span><span class="s2">&quot;${Python_EXECUTABLE}&quot;</span><span class="w"> </span><span class="s">-m</span><span class="w"> </span><span class="s">tvm_ffi.config</span><span class="w"> </span><span class="s">--sourcedir</span>
<span class="w">  </span><span class="s">OUTPUT_STRIP_TRAILING_WHITESPACE</span><span class="w"> </span><span class="s">OUTPUT_VARIABLE</span><span class="w"> </span><span class="s">tvm_ffi_ROOT</span><span class="p">)</span>
<span class="c"># add the shipped source code as a cmake subdirectory</span>
<span class="nb">add_subdirectory</span><span class="p">(</span><span class="o">${</span><span class="nv">tvm_ffi_ROOT</span><span class="o">}</span><span class="w"> </span><span class="s">tvm_ffi</span><span class="p">)</span>

<span class="c"># ... more cmake configuration omitted ...</span>

<span class="c"># linking the library</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">my_ffi_extension</span><span class="w"> </span><span class="s">tvm_ffi_shared</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that it is always safe to build from source, and the extra cost of building tvm-ffi is small
because tvm-ffi is a lightweight library. If you are in doubt,
you can always choose to build tvm-ffi from source.
In Python or other cases when we dynamically load libtvm_ffi shipped with the dedicated pip package,
you do not need to ship libtvm_ffi.so in your package even if you build tvm-ffi from source.
The built objects are only used to supply the linking information.</p>
</section>
<section id="exposing-c-functions">
<h3>Exposing C++ Functions<a class="headerlink" href="#exposing-c-functions" title="Link to this heading">#</a></h3>
<p>The C++ implementation is defined in <code class="docutils literal notranslate"><span class="pre">src/extension.cc</span></code>.
There are two ways one can expose a function in C++ to the FFI library.
First, <code class="docutils literal notranslate"><span class="pre">TVM_FFI_DLL_EXPORT_TYPED_FUNC</span></code> can be used to expose the function directly as a C symbol that follows the tvm-ffi ABI,
which can later be accessed via <code class="docutils literal notranslate"><span class="pre">tvm_ffi.load_module</span></code>.</p>
<p>Here’s a basic example of the function implementation:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">AddOne</span><span class="p">(</span><span class="n">ffi</span><span class="o">::</span><span class="n">TensorView</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">ffi</span><span class="o">::</span><span class="n">TensorView</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ... implementation omitted ...</span>
<span class="p">}</span>

<span class="n">TVM_FFI_DLL_EXPORT_TYPED_FUNC</span><span class="p">(</span><span class="n">add_one</span><span class="p">,</span><span class="w"> </span><span class="n">my_ffi_extension</span><span class="o">::</span><span class="n">AddOne</span><span class="p">);</span>
</pre></div>
</div>
<p>We can also register a function into the global function table with a given name:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">RaiseError</span><span class="p">(</span><span class="n">ffi</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">TVM_FFI_THROW</span><span class="p">(</span><span class="n">RuntimeError</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">TVM_FFI_STATIC_INIT_BLOCK</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">namespace</span><span class="w"> </span><span class="nn">refl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">tvm</span><span class="o">::</span><span class="nn">ffi</span><span class="o">::</span><span class="nn">reflection</span><span class="p">;</span>
<span class="w">  </span><span class="n">refl</span><span class="o">::</span><span class="n">GlobalDef</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;my_ffi_extension.raise_error&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">RaiseError</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Make sure to have a unique name across all registered functions when registering a global function.
Always prefix with a package namespace name to avoid name collisions.
The function can then be found via <code class="docutils literal notranslate"><span class="pre">tvm_ffi.get_global_func(name)</span></code>
and is expected to stay throughout the lifetime of the program.</p>
<p>We recommend using <code class="docutils literal notranslate"><span class="pre">TVM_FFI_DLL_EXPORT_TYPED_FUNC</span></code> for functions that are supposed to be dynamically
loaded (such as JIT scenarios) so they won’t be exposed to the global function table.</p>
</section>
<section id="library-loading-in-python">
<h3>Library Loading in Python<a class="headerlink" href="#library-loading-in-python" title="Link to this heading">#</a></h3>
<p>The base module handles loading the compiled extension:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tvm_ffi</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_load_lib</span><span class="p">():</span>
    <span class="n">file_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

    <span class="c1"># Platform-specific library names</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;win32&quot;</span><span class="p">):</span>
        <span class="n">lib_name</span> <span class="o">=</span> <span class="s2">&quot;my_ffi_extension.dll&quot;</span>
    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;darwin&quot;</span><span class="p">):</span>
        <span class="n">lib_name</span> <span class="o">=</span> <span class="s2">&quot;my_ffi_extension.dylib&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lib_name</span> <span class="o">=</span> <span class="s2">&quot;my_ffi_extension.so&quot;</span>

    <span class="n">lib_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_dir</span><span class="p">,</span> <span class="n">lib_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tvm_ffi</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="n">lib_path</span><span class="p">)</span>

<span class="n">_LIB</span> <span class="o">=</span> <span class="n">_load_lib</span><span class="p">()</span>
</pre></div>
</div>
<p>Effectively, it leverages the <code class="docutils literal notranslate"><span class="pre">tvm_ffi.load_module</span></code> call to load the library
extension DLL shipped along with the package. The <code class="docutils literal notranslate"><span class="pre">_ffi_api.py</span></code> contains a function
call to <code class="docutils literal notranslate"><span class="pre">tvm_ffi.init_ffi_api</span></code> that registers all global functions prefixed
with <code class="docutils literal notranslate"><span class="pre">my_ffi_extension</span></code> into the module.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># _ffi_api.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tvm_ffi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">_LIB</span>

<span class="c1"># Register all global functions prefixed with &#39;my_ffi_extension.&#39;</span>
<span class="c1"># This makes functions registered via TVM_FFI_STATIC_INIT_BLOCK available</span>
<span class="n">tvm_ffi</span><span class="o">.</span><span class="n">init_ffi_api</span><span class="p">(</span><span class="s2">&quot;my_ffi_extension&quot;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we can redirect the calls to the related functions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">_LIB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">_ffi_api</span>

<span class="k">def</span><span class="w"> </span><span class="nf">add_one</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># ... docstring omitted ...</span>
    <span class="k">return</span> <span class="n">_LIB</span><span class="o">.</span><span class="n">add_one</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">raise_error</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="c1"># ... docstring omitted ...</span>
    <span class="k">return</span> <span class="n">_ffi_api</span><span class="o">.</span><span class="n">raise_error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="build-and-use-the-package">
<h3>Build and Use the Package<a class="headerlink" href="#build-and-use-the-package" title="Link to this heading">#</a></h3>
<p>First, build the wheel:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>wheel<span class="w"> </span>-v<span class="w"> </span>-w<span class="w"> </span>dist<span class="w"> </span>.
</pre></div>
</div>
<p>Then install the built wheel:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>dist/*.whl
</pre></div>
</div>
<p>Then you can try it out:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">my_ffi_extension</span>

<span class="c1"># Create input and output tensors</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Call the function</span>
<span class="n">my_ffi_extension</span><span class="o">.</span><span class="n">add_one</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># Output: tensor([2., 3., 4., 5., 6.])</span>
</pre></div>
</div>
<p>You can also run the following command to see how errors are raised and propagated
across language boundaries:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>run_example.py<span class="w"> </span>raise_error
</pre></div>
</div>
<p>When possible, tvm-ffi will try to preserve backtraces across language boundaries. You will see outputs like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>File &quot;src/extension.cc&quot;, line 45, in void my_ffi_extension::RaiseError(tvm::ffi::String)
</pre></div>
</div>
</section>
</section>
<section id="wheel-auditing">
<h2>Wheel Auditing<a class="headerlink" href="#wheel-auditing" title="Link to this heading">#</a></h2>
<p>When using <code class="docutils literal notranslate"><span class="pre">auditwheel</span></code>, exclude <code class="docutils literal notranslate"><span class="pre">libtvm_ffi</span></code> as it will be shipped with the <code class="docutils literal notranslate"><span class="pre">tvm_ffi</span></code> package.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>auditwheel<span class="w"> </span>repair<span class="w"> </span>--exclude<span class="w"> </span>libtvm_ffi.so<span class="w"> </span>dist/*.whl
</pre></div>
</div>
<p>As long as you import <code class="docutils literal notranslate"><span class="pre">tvm_ffi</span></code> first before loading the library, the symbols will be available.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../get_started/quickstart.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Quick Start</p>
      </div>
    </a>
    <a class="right-next"
       href="cpp_guide.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">C++ Guide</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directly-using-exported-library">Directly using Exported Library</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pybind11-and-nanobind-style-usage">Pybind11 and Nanobind style Usage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relations-to-existing-solutions">Relations to Existing Solutions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-with-existing-solutions">Mix with Existing Solutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-project-walk-through">Example Project Walk Through</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-pyproject-toml">Setup pyproject.toml</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-cmakelists-txt">Setup CMakeLists.txt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exposing-c-functions">Exposing C++ Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#library-loading-in-python">Library Loading in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-and-use-the-package">Build and Use the Package</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wheel-auditing">Wheel Auditing</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Oct 20, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  
  <div class="footer-container" style="margin: 5px 0; font-size: 0.9em; color: #6c757d;">
      <div class="footer-line1" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 3px;">
          <div class="footer-copyright-short">
              Copyright © 2025, Apache Software Foundation
          </div>
          <div class="footer-dropdown">
              <div class="dropdown">
                  <button class="btn btn-link dropdown-toggle" type="button" id="footerDropdown" data-bs-toggle="dropdown"
                  aria-expanded="false" style="font-size: 0.9em; color: #6c757d; text-decoration: none; padding: 0; border: none; background: none;">
                      ASF
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="footerDropdown" style="font-size: 0.9em;">
<li><a class="dropdown-item" href="https://apache.org/" target="_blank" style="font-size: 0.9em;">ASF Homepage</a></li>
<li><a class="dropdown-item" href="https://www.apache.org/licenses/" target="_blank" style="font-size: 0.9em;">License</a></li>
<li><a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html" target="_blank" style="font-size: 0.9em;">Sponsorship</a></li>
<li><a class="dropdown-item" href="https://tvm.apache.org/docs/reference/security.html" target="_blank" style="font-size: 0.9em;">Security</a></li>
<li><a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html" target="_blank" style="font-size: 0.9em;">Thanks</a></li>
<li><a class="dropdown-item" href="https://www.apache.org/events/current-event" target="_blank" style="font-size: 0.9em;">Events</a></li>
                  </ul>
              </div>
          </div>
      </div>
      <div class="footer-line2" style="font-size: 0.9em; color: #6c757d;">
          Apache TVM, Apache, the Apache feather, and the Apache TVM project logo are either trademarks or registered trademarks of the Apache Software Foundation.
      </div>
  </div>
  
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>