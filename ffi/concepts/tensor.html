
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tensor and DLPack &#8212; tvm-ffi</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css?v=a885cde7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=38aa6179" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=692f76eb"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js?v=73120307"></script>
    <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js?v=660e4f45"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="../_static/downloads/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'concepts/tensor';</script>
    <link rel="icon" href="https://tvm.apache.org/images/logo/tvm-logo-square.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python Packaging" href="../packaging/python_packaging.html" />
    <link rel="prev" title="ABI Overview" href="abi_overview.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Jan 05, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">tvm-ffi</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../get_started/quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/stable_c_abi.html">Stable C ABI</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../guides/kernel_library_guide.html">Kernel Library Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/compiler_integration.html">Compiler Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/cubin_launcher.html">CUBIN Launcher Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/python_lang_guide.html">Python Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/cpp_lang_guide.html">C++ Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/rust_lang_guide.html">Rust Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abi_overview.html">ABI Overview</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Tensor and DLPack</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Packaging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../packaging/python_packaging.html">Python Packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packaging/cpp_tooling.html">C++ Tooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packaging/cpp_packaging.html">C++ Packaging and Distribution</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/python/index.html">Python API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Object.html">tvm_ffi.Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Tensor.html">tvm_ffi.Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.from_dlpack.html">tvm_ffi.from_dlpack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Shape.html">tvm_ffi.Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.dtype.html">tvm_ffi.dtype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Device_class.html">tvm_ffi.Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.DLDeviceType.html">tvm_ffi.DLDeviceType</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.device_function.html">tvm_ffi.device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Function.html">tvm_ffi.Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Module.html">tvm_ffi.Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.system_lib.html">tvm_ffi.system_lib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.load_module.html">tvm_ffi.load_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Array.html">tvm_ffi.Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.Map.html">tvm_ffi.Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.register_error.html">tvm_ffi.register_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.register_object.html">tvm_ffi.register_object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.register_global_func.html">tvm_ffi.register_global_func</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.get_global_func.html">tvm_ffi.get_global_func</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.get_global_func_metadata.html">tvm_ffi.get_global_func_metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.init_ffi_api.html">tvm_ffi.init_ffi_api</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.remove_global_func.html">tvm_ffi.remove_global_func</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.StreamContext.html">tvm_ffi.StreamContext</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.use_torch_stream.html">tvm_ffi.use_torch_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.use_raw_stream.html">tvm_ffi.use_raw_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.get_raw_stream.html">tvm_ffi.get_raw_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/cpp/generated/tvm_ffi.cpp.load_inline.html">tvm_ffi.cpp.load_inline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/cpp/generated/tvm_ffi.cpp.build_inline.html">tvm_ffi.cpp.build_inline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/cpp/generated/tvm_ffi.cpp.load.html">tvm_ffi.cpp.load</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/cpp/generated/tvm_ffi.cpp.build.html">tvm_ffi.cpp.build</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/cpp/generated/tvm_ffi.libinfo.load_lib_module.html">tvm_ffi.libinfo.load_lib_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/cpp/generated/tvm_ffi.cpp.nvrtc.nvrtc_compile.html">tvm_ffi.cpp.nvrtc.nvrtc_compile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.serialization.from_json_graph_str.html">tvm_ffi.serialization.from_json_graph_str</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.serialization.to_json_graph_str.html">tvm_ffi.serialization.to_json_graph_str</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.access_path.AccessKind.html">tvm_ffi.access_path.AccessKind</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.access_path.AccessPath.html">tvm_ffi.access_path.AccessPath</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.access_path.AccessStep.html">tvm_ffi.access_path.AccessStep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.convert.html">tvm_ffi.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/python/generated/tvm_ffi.ObjectConvertible.html">tvm_ffi.ObjectConvertible</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/cpp/index.html">C++ API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/cpp/generated/index.html">Full API Index</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm.html">Namespace tvm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi.html">Namespace tvm::ffi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi__cuda_api.html">Namespace tvm::ffi::cuda_api</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi__json.html">Namespace tvm::ffi::json</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi__reflection.html">Namespace tvm::ffi::reflection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm__ffi__symbol.html">Namespace tvm::ffi::symbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/namespace_tvm_ffi.html">Namespace tvm_ffi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1AnyEqual.html">Struct AnyEqual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1AnyHash.html">Struct AnyHash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1CUDADeviceGuard.html">Struct CUDADeviceGuard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1DenseMapObj_1_1Block.html">Struct DenseMapObj::Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1DenseMapObj_1_1ItemType.html">Struct DenseMapObj::ItemType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1DenseMapObj_1_1ListNode.html">Struct DenseMapObj::ListNode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1dim3.html">Struct dim3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1EnvErrorAlreadySet.html">Struct EnvErrorAlreadySet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1FallbackOnlyTraitsBase.html">Template Struct FallbackOnlyTraitsBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1is__valid__iterator.html">Template Struct is_valid_iterator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1is__valid__iterator_3_01Any_00_01IterType_01_4.html">Template Struct is_valid_iterator&lt; Any, IterType &gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1is__valid__iterator_3_01Optional_3_01T_01_4_00_01IterType_01_4.html">Template Struct is_valid_iterator&lt; Optional&lt; T &gt;, IterType &gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1ObjectPtrEqual.html">Struct ObjectPtrEqual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1ObjectPtrHash.html">Struct ObjectPtrHash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1ObjectRefWithFallbackTraitsBase.html">Template Struct ObjectRefWithFallbackTraitsBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1reflection_1_1FieldInfoBuilder.html">Struct FieldInfoBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1reflection_1_1InfoTrait.html">Struct InfoTrait</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1reflection_1_1init.html">Template Struct init</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1reflection_1_1MethodInfoBuilder.html">Struct MethodInfoBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1StaticTypeKey.html">Struct StaticTypeKey</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1TypeToFieldStaticTypeIndex.html">Template Struct TypeToFieldStaticTypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1TypeToRuntimeTypeIndex.html">Template Struct TypeToRuntimeTypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structtvm_1_1ffi_1_1UnsafeInit.html">Struct UnsafeInit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIAny.html">Struct TVMFFIAny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIByteArray.html">Struct TVMFFIByteArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIErrorCell.html">Struct TVMFFIErrorCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIFieldInfo.html">Struct TVMFFIFieldInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIFunctionCell.html">Struct TVMFFIFunctionCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIMethodInfo.html">Struct TVMFFIMethodInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIObject.html">Struct TVMFFIObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIOpaqueObjectCell.html">Struct TVMFFIOpaqueObjectCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIShapeCell.html">Struct TVMFFIShapeCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFITypeAttrColumn.html">Struct TVMFFITypeAttrColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFITypeInfo.html">Struct TVMFFITypeInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFITypeMetadata.html">Struct TVMFFITypeMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/structTVMFFIVersion.html">Struct TVMFFIVersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html">Class Any</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html">Class AnyView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Array.html">Template Class Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ArrayObj.html">Class ArrayObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Bytes.html">Class Bytes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1CubinKernel.html">Class CubinKernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1CubinModule.html">Class CubinModule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1DenseMapObj.html">Class DenseMapObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Error.html">Class Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ErrorObj.html">Class ErrorObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Function.html">Class Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1FunctionObj.html">Class FunctionObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Map.html">Template Class Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1MapObj.html">Class MapObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Module.html">Class Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ModuleObj.html">Class ModuleObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Object.html">Class Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ObjectPtr.html">Template Class ObjectPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ObjectRef.html">Class ObjectRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Optional.html">Template Class Optional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1PackedArgs.html">Class PackedArgs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AccessPath.html">Class AccessPath</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AccessPathObj.html">Class AccessPathObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AccessStep.html">Class AccessStep</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AccessStepObj.html">Class AccessStepObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1AttachFieldFlag.html">Class AttachFieldFlag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1DefaultValue.html">Class DefaultValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1FieldGetter.html">Class FieldGetter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1FieldSetter.html">Class FieldSetter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1GlobalDef.html">Class GlobalDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1Metadata.html">Class Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1ObjectCreator.html">Class ObjectCreator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1ObjectDef.html">Template Class ObjectDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1OverloadObjectDef.html">Template Class OverloadObjectDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1TypeAttrColumn.html">Class TypeAttrColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1reflection_1_1TypeAttrDef.html">Template Class TypeAttrDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1RValueRef.html">Template Class RValueRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Shape.html">Class Shape</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ShapeObj.html">Class ShapeObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ShapeView.html">Class ShapeView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1SmallMapObj.html">Class SmallMapObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1StrictBool.html">Class StrictBool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1String.html">Class String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1StructuralEqual.html">Class StructuralEqual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1StructuralHash.html">Class StructuralHash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html">Class Tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html">Class TensorObj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html">Class TensorView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tuple.html">Template Class Tuple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TypedFunction.html">Template Class TypedFunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TypedFunction_3_01R_07Args_8_8_8_08_4.html">Template Class TypedFunction&lt; R(Args…) &gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Variant.html">Template Class Variant</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1WeakObjectPtr.html">Template Class WeakObjectPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_dtype_8h_1a16f66b97fa44d7bd6114324c8b8e1bed.html">Enum DLExtDataTypeCode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_namespacetvm_1_1ffi_1_1reflection_1a9c2cd4d683e7c7065942e36e628a2517.html">Enum AccessKind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1ad6a441d28d4a6406418489609e975a19.html">Enum TVMFFIBacktraceUpdateMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1ad5a608f648c4f86cafdc8dc09f870bc5.html">Enum TVMFFIFieldFlagBitMask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a8eb3fb55f6ec3c46b6e57740af4ca58a.html">Enum TVMFFIObjectDeleterFlagBitMask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1aea0f30bf60e26c1322e525e246ef5be9.html">Enum TVMFFISEqHashKind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html">Enum TVMFFITypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_base64_8h_1ae1d4736f7dc56b224acd303ba7bf7a45.html">Function tvm::ffi::Base64Decode(TVMFFIByteArray)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_base64_8h_1acb849cdb1d9b9620be10bbcda0257afa.html">Function tvm::ffi::Base64Decode(const String&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_base64_8h_1aa5b2a4531449585b9f079cb170a79f0b.html">Function tvm::ffi::Base64Encode(TVMFFIByteArray)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_base64_8h_1a279b4ba2f4c7ea16291ef24b73e43963.html">Function tvm::ffi::Base64Encode(const Bytes&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_endian_8h_1ab4e0ed8000c632cd2c7cd089c0a0d1af.html">Function tvm::ffi::ByteSwap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_array_8h_1af5983fd2a31e79635307875b3a216472.html">Template Function tvm::ffi::Concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1a8d6ac296b5142517449c57c387ec8c21.html">Function tvm::ffi::cuda_api::GetDeviceAttribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1afe299c48605bbb76772042acae7dc6de.html">Function tvm::ffi::cuda_api::GetDeviceCount</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1a08e79db6318f80253199c3eb6c3a61d9.html">Function tvm::ffi::cuda_api::GetDeviceHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1a8dfc6904c4424309f4a490daaec7ed3e.html">Function tvm::ffi::cuda_api::GetErrorString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1a3016d84c6ad28cc7213440c0e2513737.html">Function tvm::ffi::cuda_api::GetKernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1a9d158620f8ae2da73b9d5d53eb6151de.html">Function tvm::ffi::cuda_api::GetKernelSharedMem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1a1d6ae21c397f551f1f2f12d5d7cdb88a.html">Function tvm::ffi::cuda_api::LaunchKernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1a4d4f73e984897c9a4da2d0dccc11e1a1.html">Function tvm::ffi::cuda_api::LoadLibrary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1a9f15e6a91d49c1a9d373b9f031edfe69.html">Function tvm::ffi::cuda_api::SetKernelMaxDynamicSharedMem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_unified__api_8h_1aaf09051ae19acf959b1521f9495f1beb.html">Function tvm::ffi::cuda_api::UnloadLibrary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_dtype_8h_1a94787950883e5a7e97b764ddd342afc3.html">Function tvm::ffi::DLDataTypeToString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_string_8h_1aa190eed2516ff9a633009cc62f660502.html">Function tvm::ffi::EscapeString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_serialization_8h_1a56baa5d1ca415dbdebf19ac1f54bd5b7.html">Function tvm::ffi::FromJSONGraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a71e4a492b5a03a19a95087771a7e9ed1.html">Function tvm::ffi::GetDataSize(size_t, DLDataType)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a226723176642cde5996498e7da6a6368.html">Function tvm::ffi::GetDataSize(const DLTensor&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a011d0a2dcbe5702156124d7a7223b3dd.html">Function tvm::ffi::GetDataSize(const Tensor&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a65b3a61c540c72d9410150a3a7a76dde.html">Function tvm::ffi::GetDataSize(const TensorView&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_cast_8h_1a4dba749dd934d8a7891ad126a8fdcc1f.html">Template Function tvm::ffi::GetObjectPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_cast_8h_1a3c5fed9bb23b4804b61037c8ac4874f1.html">Template Function tvm::ffi::GetRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1aa79cf4e1e3873d8947050b3cee41153a.html">Function tvm::ffi::IsAligned</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1a93094b6b3f20c2cd5aa1c1c2522bc3e4.html">Function tvm::ffi::IsContiguous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_tensor_8h_1aab70a15ca1dde710bc3052c5ce1f6fbd.html">Function tvm::ffi::IsDirectAddressDevice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_json_8h_1a86217bda8bfebd85f8265878bc8a59b8.html">Function tvm::ffi::json::Parse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_json_8h_1a2cd33b0fbc0194eaa803b8a476670587.html">Function tvm::ffi::json::Stringify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_memory_8h_1a801e8ecc2e3adbc1dac52c714e7cef11.html">Template Function tvm::ffi::make_inplace_array_object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_array_8h_1a3b56317c7cfb2760cf6c09c303840967.html">Specialized Template Function tvm::ffi::make_object()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_memory_8h_1a8892f2a3cad8dbc51930c464f2ab863b.html">Template Function tvm::ffi::make_object(Args&amp;&amp;…)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_map_8h_1a611844db41026b7a95846dd316b435af.html">Template Function tvm::ffi::Merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1a735285a70c7c4308816450a5b27f03f2.html">Function tvm::ffi::reflection::EnsureTypeAttrColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1a32d91001c82e10566c69e237ab0de50a.html">Template Function tvm::ffi::reflection::ForEachFieldInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1acc0ded3ead1cc6ffc836005d3bb2cc9c.html">Template Function tvm::ffi::reflection::ForEachFieldInfoWithEarlyStop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1a6b1f837cf822ded72a31f343ce987f4c.html">Template Function tvm::ffi::reflection::GetFieldByteOffsetToObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1a80c4984a43d14113b20a67c966833709.html">Function tvm::ffi::reflection::GetFieldInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1aba4d7fd771bea88a32803dda191b7044.html">Function tvm::ffi::reflection::GetMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_namespacetvm_1_1ffi_1_1reflection_1ac902a725008e348254ee7a2d07c8a95a.html">Function tvm::ffi::reflection::GetMethodInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_dtype_8h_1a8a71c64237efaa13a8d40dfacd6c3165.html">Function tvm::ffi::StringToDLDataType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_serialization_8h_1a24d1febeb5c1026e7fd66dee9dd9915f.html">Function tvm::ffi::ToJSONGraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_string_8h_1ad045700080c053c50d68cde298b2b4b2.html">Function tvm::ffi::ToStringView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_object_8h_1a0d6e075f219808c4ff7adebd99210a7b.html">Function tvm::ffi::TypeIndexToTypeKey</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_8h_1a111e2ed7444eb220e19c7624d0932d89.html">Function tvm::ffi::TypeKeyToIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a63149ed43a6ecffa2146f92914c0bc7b.html">Function TVMFFIAnyViewToOwnedAny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac0e2d59d3a8ba7f2b32eac47b1c6fc5d.html">Function TVMFFIBacktrace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aa2a81275b69ba0f61ce556df85517ef9.html">Function TVMFFIBytesFromByteArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1dd5584d94f6e00a18f4cfa003dfb93a.html">Function TVMFFIBytesGetByteArrayPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a44604b1d0db208ed82cbc7cf0fd0f47c.html">Function TVMFFIDataTypeFromString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a402f64dec7a665f281e55cf946a7481b.html">Function TVMFFIDataTypeToString</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a762fc5c881dc5f66066eb45b65a5781f.html">Function TVMFFIDLDeviceFromIntPair</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a0e01ad3ed44c0240f1b76dbed7014234.html">Function TVMFFIEnvCheckSignals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1ac8f7894c4f205756b7aee01108ab8e84.html">Function TVMFFIEnvGetDLPackManagedTensorAllocator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a8ce2ba89ca1d010a084b4c36ed6b2965.html">Function TVMFFIEnvGetStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1abcbbccfc02c57418e757033afce42ece.html">Function TVMFFIEnvModLookupFromImports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a7451ab18593d70d30a6214d622e200d2.html">Function TVMFFIEnvModRegisterContextSymbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a9b142b59ab84bc06e4a0f66a3510e8f7.html">Function TVMFFIEnvModRegisterSystemLibSymbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a36c15024744584acceaf0233947f9505.html">Function TVMFFIEnvRegisterCAPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1aaf8960c33546788950b8e35ac18efe39.html">Function TVMFFIEnvSetDLPackManagedTensorAllocator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1ae24b47945440d1c0aca13af13bdaf916.html">Function TVMFFIEnvSetStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a683191d48d3fdebc98b68f3b717baf6a.html">Function TVMFFIEnvTensorAlloc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a3479c144d165e717d1464b7b4df84897.html">Function TVMFFIErrorCreate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a0ee6d2da9a72749561838bf503f62f93.html">Function TVMFFIErrorGetCellPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a268d0b5dc89146020c09f77fa0eb8f67.html">Function TVMFFIErrorMoveFromRaised</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1af108ca4da596c634b4cb9e82c8bec1ce.html">Function TVMFFIErrorSetRaised</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aedd89f80f73d54dd5904d943dd0690c6.html">Function TVMFFIErrorSetRaisedFromCStr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a56ce10d1e6fc2d34a1a496bdace4af33.html">Function TVMFFIErrorSetRaisedFromCStrParts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1ac76d88e0d79843403ce2e0239d7fe2.html">Function TVMFFIFunctionCall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a4ce84fc667040bba425664c78b5f2c69.html">Function TVMFFIFunctionCreate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a0d3dcd6ceff356614a6924201c02cf97.html">Function TVMFFIFunctionGetCellPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a3bf47f6e1229627902c80217d674ed29.html">Function TVMFFIFunctionGetGlobal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a177d080127ef8f3e338beb7dba4c04fd.html">Function TVMFFIFunctionSetGlobal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aa26fa16c024c6f2fa15e46aa1333fdb9.html">Function TVMFFIFunctionSetGlobalFromMethodInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a53c5ec2971806966ed96a6add32b5238.html">Function TVMFFIGetTypeAttrColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1afee5a803e22f9baf5ee2ff1f0ace6429.html">Function TVMFFIGetTypeInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a145f2694254410fd4814541e2cde99c1.html">Function TVMFFIGetVersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ab31a093c3633c793dc2b4ffed0825c31.html">Function TVMFFIHandleDeinitOnce</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ab15b1e535d645969fde869a5e515a885.html">Function TVMFFIHandleInitOnce</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a6415c088928d62af8749f3dc57dcf23b.html">Function TVMFFIObjectCreateOpaque</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aba50ba2cee84b1ef7a718211ab349031.html">Function TVMFFIObjectDecRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a31a317a32bfa641180eed1bfb3d5cf01.html">Function TVMFFIObjectGetTypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac66c1d142240be0cdf65c8ba38770eb6.html">Function TVMFFIObjectIncRef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a3253bbf35e2ad1361b2ce1de13d2c9b2.html">Function TVMFFIOpaqueObjectGetCellPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a74c26efdd74840abc3e1581c73a38bfa.html">Function TVMFFIShapeGetCellPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a724b0d386cf3d50c7d141ca37be19092.html">Function TVMFFISmallBytesGetContentByteArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a5a7e3fe8a94e066bc1bf897fbf736651.html">Function TVMFFIStringFromByteArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1a617dd18aa7dd47aa51a984611b67a1.html">Function TVMFFITensorCreateUnsafeView</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1af1b8a29eb3f9405982c344f5e572dd65.html">Function TVMFFITensorFromDLPack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1adaf9a5ab3d30bb3eca58b430f2592fc0.html">Function TVMFFITensorFromDLPackVersioned</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ab691fd5bc4442c631c1f70985a962f50.html">Function TVMFFITensorGetDLTensorPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1adec9f8a8f0683caeb9dd194d9a3c62d5.html">Function TVMFFITensorToDLPack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1162f2cbaf1a7628a03ed9488cff858b.html">Function TVMFFITensorToDLPackVersioned</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a3f859b60d99c85f43fce8226c69f3c5e.html">Function TVMFFITypeGetOrAllocIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac64df2793c84fc8ba5d24968d60bcada.html">Function TVMFFITypeKeyToIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac5a4f48eacde3c69ad3154b6aa39fa3c.html">Function TVMFFITypeRegisterAttr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a1a99289a314c6c3de865721bd3efb525.html">Function TVMFFITypeRegisterField</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aeee9dab8873b5b2f327f4dfe50f802ab.html">Function TVMFFITypeRegisterMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1a4e8b3caff4da72205ec1ac9a811748e5.html">Function TVMFFITypeRegisterMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_unified__api_8h_1acd118a980ee3e7e77dd76858652255a3.html">Variable tvm::ffi::cuda_api::kSuccess</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_array_8h_1a3bbf4c2bf19b72b026ad9e19a23143d5.html">Variable tvm::ffi::is_valid_iterator_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1a5a3a8ad10620c05ded5876f8e607e0eb.html">Variable tvm::ffi::symbol::tvm_ffi_doc_prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1aae0405c7615139afd4f68b72a862cffe.html">Variable tvm::ffi::symbol::tvm_ffi_library_bin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1a76f8a8fd1e38fd98cc501623d959ee58.html">Variable tvm::ffi::symbol::tvm_ffi_library_ctx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1ad9c186f1359987cef9278993037b3f66.html">Variable tvm::ffi::symbol::tvm_ffi_main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1a07576e172e0788da4982148edcf53b05.html">Variable tvm::ffi::symbol::tvm_ffi_metadata_prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/variable_module_8h_1ac261d9ce6ffb49dd9878610ce217075e.html">Variable tvm::ffi::symbol::tvm_ffi_symbol_prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_unified__api_8h_1a160bb722922e17fa17c938fcf8561732.html">Define _TVM_FFI_CUDA_FUNC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a288653475dd42db1c715a11ab2972578.html">Define TVM_FFI_ALWAYS_LOG_BEFORE_THROW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a7205bbaef1c45e57f939af6deefb6449.html">Define TVM_FFI_BACKTRACE_ON_SEGFAULT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1ad4674e1cb9c051f47127e5331a4bcadc.html">Define TVM_FFI_CHECK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_unified__api_8h_1a8b7e871d0d7206eacc60705f11827ee1.html">Define TVM_FFI_CHECK_CUDA_ERROR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a64c939463f90816ffc2b70bc89ea3e43.html">Define TVM_FFI_CHECK_FUNC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1a14328d95ccda4b1691b9874645aef4bd.html">Define TVM_FFI_CHECK_SAFE_CALL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_unified__api_8h_1a9e03c2471638d2243c3c3b79d800efe1.html">Define TVM_FFI_CUBIN_LAUNCHER_USE_DRIVER_API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a438ff7ee1fc503216d35e156081280c0.html">Define TVM_FFI_DECLARE_OBJECT_INFO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1ac593f4065568c8f61cf38d00d585befd.html">Define TVM_FFI_DECLARE_OBJECT_INFO_FINAL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a9d1c42071de0440f70c7bb5e0bd0f325.html">Define TVM_FFI_DECLARE_OBJECT_INFO_PREDEFINED_TYPE_KEY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a6ad2a76d53c8c695743f7a275c8c0523.html">Define TVM_FFI_DECLARE_OBJECT_INFO_STATIC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a4ac33631a9b51877808ec7edf010f0d2.html">Define TVM_FFI_DEFINE_OBJECT_REF_METHODS_NOTNULLABLE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_object_8h_1a0fc0cc2d8f4318bc41a896c117e8a15c.html">Define TVM_FFI_DEFINE_OBJECT_REF_METHODS_NULLABLE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1a78c6d17c063fba9ca07175f150838046.html">Define TVM_FFI_DLL_EXPORT_INCLUDE_METADATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1a01777f12f8f99771331d679a0c1d2ed4.html">Define TVM_FFI_DLL_EXPORT_TYPED_FUNC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1af84cdf62b6c193275db7e63e3bffc8bd.html">Define TVM_FFI_DLL_EXPORT_TYPED_FUNC_DOC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_cubin__launcher_8h_1a99736a44462543179cb434ebd4512ade.html">Define TVM_FFI_EMBED_CUBIN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_cubin__launcher_8h_1a55832b50e83cf39108f1e306f031433d.html">Define TVM_FFI_EMBED_CUBIN_FROM_BYTES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_cubin__launcher_8h_1ae8d64fa1cc7db9d38632e32054df72fc.html">Define TVM_FFI_EMBED_CUBIN_GET_KERNEL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a6c01470f76c6437edf93ac668ea6242a.html">Define TVM_FFI_ICHECK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a83986fc775d68d4abcc209c2f67dde6e.html">Define TVM_FFI_ICHECK_BINARY_OP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a394ec1781a34c49e29d47db5c3dfad9c.html">Define TVM_FFI_ICHECK_EQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1ae5be195e80d32413cbe5e2ad11e146f7.html">Define TVM_FFI_ICHECK_GE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1af1f84686ce5635b3a378567368e89e4d.html">Define TVM_FFI_ICHECK_GT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1aade00b2e0a9789e3e8bf33441d651455.html">Define TVM_FFI_ICHECK_LE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a1a94c8b78e74adec05051abb9055e7b8.html">Define TVM_FFI_ICHECK_LT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1afcd5778e656fa2c20aa0b81fbcebc497.html">Define TVM_FFI_ICHECK_NE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a26827bb8bc9e39255060f6be1d2a37fb.html">Define TVM_FFI_ICHECK_NOTNULL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_endian_8h_1a2ebd9542b313b3b45b2892f2b3d4f26d.html">Define TVM_FFI_IO_NO_ENDIAN_SWAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_endian_8h_1a912dbc7a68913612c723f877acaa8105.html">Define TVM_FFI_IO_USE_LITTLE_ENDIAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a927d4ae2bbf7a08723643993e780f183.html">Define TVM_FFI_LOG_AND_THROW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1a10bd932564c8e71a3978a061fbb82360.html">Define TVM_FFI_SAFE_CALL_BEGIN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_function_8h_1ae3c016c4bf383aa205b4485edd7ca17c.html">Define TVM_FFI_SAFE_CALL_END</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a8df4e0ff8a6195274c6f7c031a4f0db4.html">Define TVM_FFI_THROW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_error_8h_1a386641a33bb14802830471a2442ddd7d.html">Define TVM_FFI_USE_LIBBACKTRACE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_c__api_8h_1a4241f838270253b885e1de02534bc273.html">Define TVM_FFI_VERSION_MAJOR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_c__api_8h_1a717daddad98d127813ba8ff5a715e929.html">Define TVM_FFI_VERSION_MINOR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_c__api_8h_1a42634cb2690dce4d9af6c2a402fc903c.html">Define TVM_FFI_VERSION_PATCH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/define_c__api_8h_1a01871644eed04162005df7faa5442f92.html">Define TVM_FFI_WEAK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_unified__api_8h_1a3a921bfefc753492061768fced304aa7.html">Typedef tvm::ffi::cuda_api::DeviceAttrType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_unified__api_8h_1a92973dc82316f80c6ad935aafba39418.html">Typedef tvm::ffi::cuda_api::DeviceHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_unified__api_8h_1ab6a530cbc289dbb52b705f00c8095fc7.html">Typedef tvm::ffi::cuda_api::KernelHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_unified__api_8h_1ae60e2c3b6b2591a181c9b0ff8905c2fb.html">Typedef tvm::ffi::cuda_api::LaunchAttrType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_unified__api_8h_1a6378bff570cca29703bf0a888e62c2e1.html">Typedef tvm::ffi::cuda_api::LaunchConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_unified__api_8h_1a630f9293b2557ea7cf02fc5dc8975608.html">Typedef tvm::ffi::cuda_api::LibraryHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_unified__api_8h_1a17eed3020dde14e09827a83036143d07.html">Typedef tvm::ffi::cuda_api::ResultType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_unified__api_8h_1a6c2e323543c694ac2fc8e68c40a5fa3d.html">Typedef tvm::ffi::cuda_api::StreamHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_memory_8h_1a65bf625279df21dec5c8097264415113.html">Typedef tvm::ffi::FObjectDeleter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_json_8h_1aeb9cdccfbc28034e94e46f9f6bd8d92a.html">Typedef tvm::ffi::json::Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_json_8h_1a74ca72d0b686c114af683d63e96f2998.html">Typedef tvm::ffi::json::Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_json_8h_1a8e808548bb6a99d0a6093ab3e2229ad3.html">Typedef tvm::ffi::json::Value</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_namespacetvm_1_1ffi_1_1reflection_1a96513314d45b43eada132d9b96653d9a.html">Typedef tvm::ffi::reflection::_MetadataType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_namespacetvm_1_1ffi_1_1reflection_1a32b044a71a094de492867144ca299c15.html">Typedef tvm::ffi::reflection::AccessPathPair</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_object_8h_1a7ba296d84188e5970ba854332a1f04a6.html">Typedef tvm::ffi::TypeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_object_8h_1ae125f5f5a8a94c7340577c1959805295.html">Typedef tvm::ffi::TypeInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1ae22f1a87cbaf7f744d9201948c05d2a5.html">Typedef TVMFFIFieldGetter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1aba6bf585b03799369fb535db4a5d2e79.html">Typedef TVMFFIFieldSetter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1a19fdd3c500a70abb3def842c73694548.html">Typedef TVMFFIObjectCreator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1aa0abef2444fde82d76337218e5c13b3f.html">Typedef TVMFFIObjectHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__api_8h_1a9eee5afddb1b39723847d67d109c03fe.html">Typedef TVMFFISafeCallType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cpp/generated/typedef_c__env__api_8h_1aa7abccefa41ac9d3040df689c0c72fa4.html">Typedef TVMFFIStreamHandle</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/rust/index.html">Rust API</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../dev/build_from_source.html">Build from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/release_process.html">Release Process</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/apache/tvm-ffi" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/concepts/tensor.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tensor and DLPack</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">Glossary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-classes">Tensor Classes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dlpack-tensors">DLPack Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tvm-ffi-tensors">TVM-FFI Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-layouts">Tensor Layouts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-tensor-is-not">What Tensor is not</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-between-tvmffiany">Conversion between <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TVMFFIAny</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-non-owning-tensor">To Non-Owning Tensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-owning-tensor">To Owning Tensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#from-owning-tensor">From Owning Tensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#from-non-owning-tensor">From Non-Owning Tensor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-apis">Tensor APIs</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-apis">C++ APIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-apis">Python APIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#allocation-in-c">Allocation in C++</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stream-handling-in-c">Stream Handling in C++</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tensor-and-dlpack">
<h1>Tensor and DLPack<a class="headerlink" href="#tensor-and-dlpack" title="Link to this heading">#</a></h1>
<p>At runtime, TVM-FFI often needs to accept tensors from many sources:</p>
<ul class="simple">
<li><p>Frameworks (e.g. PyTorch, JAX) via <a class="reference external" href="https://data-apis.org/array-api/latest/API_specification/generated/array_api.array.__dlpack__.html#array_api.array.__dlpack__" title="(in Python array API standard)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">array_api.array.__dlpack__()</span></code></a>;</p></li>
<li><p>C/C++ callers passing <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor*</span></code></a>;</p></li>
<li><p>Tensors allocated by a library but managed by TVM-FFI itself.</p></li>
</ul>
<p>TVM-FFI standardizes on <strong>DLPack as the lingua franca</strong>: tensors are
built on top of DLPack structs with additional C++ convenience methods
and minimal extensions for ownership management.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Prefer <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">tvm::ffi::TensorView</span></code></a> or <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">tvm::ffi::Tensor</span></code></a> in C++ code;
they provide safer and more convenient abstractions over raw DLPack structs.</p>
</div>
<p>This tutorial is organized as follows:</p>
<ul class="simple">
<li><p><strong>Tensor Classes</strong>: introduces what tensor types are provided, and which one you should use.</p></li>
<li><p><strong>Conversion between TVMFFIAny</strong>: how tensors flow across ABI boundaries.</p></li>
<li><p><strong>Tensor APIs</strong>: the most important tensor APIs you will use, including allocation and stream handling.</p></li>
</ul>
<section id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Link to this heading">#</a></h2>
<dl class="simple">
<dt>DLPack</dt><dd><p>A cross-library tensor interchange standard defined in the small C header <code class="docutils literal notranslate"><span class="pre">dlpack.h</span></code>.
It defines pure C data structures for describing n-dimensional arrays and their memory layout,
including <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a>, <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLManagedTensorVersioned" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLManagedTensorVersioned</span></code></a>, <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLDataType" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLDataType</span></code></a>,
<a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLDevice" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLDevice</span></code></a>, and related types.</p>
</dd>
<dt>View (non-owning)</dt><dd><p>A “header” that describes a tensor but does not own its memory. When a consumer
receives a view, it must respect that the producer owns the underlying storage and controls its
lifetime. The view is valid only while the producer guarantees it remains valid.</p>
</dd>
<dt>Managed object (owning)</dt><dd><p>An object that includes lifetime management, using reference counting or a cleanup callback
mechanism. This establishes a contract between producer and consumer about when the consumer’s ownership ends.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a loose analogy, think of <strong>view</strong> vs. <strong>managed</strong> as similar to
<code class="docutils literal notranslate"><span class="pre">T*</span></code> (raw pointer) vs. <code class="docutils literal notranslate"><span class="pre">std::shared_ptr&lt;T&gt;</span></code> (reference-counted pointer) in C++.</p>
</div>
</section>
<section id="tensor-classes">
<h2>Tensor Classes<a class="headerlink" href="#tensor-classes" title="Link to this heading">#</a></h2>
<p>This section defines each tensor type you will encounter in the TVM-FFI C++ API and explains the
<em>intended</em> usage. Exact C layout details are covered later in <a class="reference internal" href="#layout-and-conversion"><span class="std std-ref">Tensor Layouts</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>On the Python side, only <a class="reference internal" href="../reference/python/generated/tvm_ffi.Tensor.html#tvm_ffi.Tensor" title="tvm_ffi.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">tvm_ffi.Tensor</span></code></a> exists. It strictly follows DLPack semantics for interop and can be converted to PyTorch via <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.from_dlpack.html#torch.from_dlpack" title="(in PyTorch v2.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.from_dlpack()</span></code></a>.</p>
</div>
<section id="dlpack-tensors">
<h3>DLPack Tensors<a class="headerlink" href="#dlpack-tensors" title="Link to this heading">#</a></h3>
<p>DLPack tensors come in two main flavors:</p>
<dl class="simple">
<dt><em>Non-owning</em> object, <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a></dt><dd><p>The tensor descriptor is a <strong>view</strong> of the underlying data.
It describes the device the tensor lives on, its shape, dtype, and data pointer. It does not own the underlying data.</p>
</dd>
<dt><em>Owning</em> object, <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLManagedTensorVersioned" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLManagedTensorVersioned</span></code></a>, or its legacy counterpart <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLManagedTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLManagedTensor</span></code></a></dt><dd><p>It is a <strong>managed</strong> variant that wraps a <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a> descriptor with additional fields.
Notably, it includes a <code class="docutils literal notranslate"><span class="pre">deleter</span></code> callback that releases ownership when the consumer is done with the tensor,
and an opaque <code class="docutils literal notranslate"><span class="pre">manager_ctx</span></code> handle used by the producer to store additional context.</p>
</dd>
</dl>
</section>
<section id="tvm-ffi-tensors">
<h3>TVM-FFI Tensors<a class="headerlink" href="#tvm-ffi-tensors" title="Link to this heading">#</a></h3>
<p>Similarly, TVM-FFI defines two main tensor types in C++:</p>
<dl class="simple">
<dt><em>Non-owning</em> object, <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">tvm::ffi::TensorView</span></code></a></dt><dd><p>A thin C++ wrapper around <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a> for inspecting metadata and accessing the data pointer.
It is designed for <strong>kernel authors</strong> to inspect metadata and access the underlying data pointer during a call,
without taking ownership of the tensor’s memory. Being a <strong>view</strong> also means you must ensure the backing tensor remains valid while you use it.</p>
</dd>
<dt><em>Owning</em> object, <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">tvm::ffi::TensorObj</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">tvm::ffi::Tensor</span></code></a></dt><dd><p><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, similar to <code class="docutils literal notranslate"><span class="pre">std::shared_ptr&lt;TensorObj&gt;</span></code>, is the managed class to hold heap-allocated
<a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj</span></code></a>. Once the reference count drops to zero, the cleanup logic deallocates the descriptor
and releases ownership of the underlying data buffer.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For handwritten C++, always use TVM-FFI tensors over DLPack’s raw C tensors.</p></li>
<li><p>For compiler development, DLPack’s raw C tensors are recommended because C is easier to target from codegen.</p></li>
</ul>
</div>
<p>The owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> is the recommended interface for passing around managed tensors.
Use owning tensors when you need one or more of the following:</p>
<ul class="simple">
<li><p>return a tensor from a function across ABI, which will be converted to <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">tvm::ffi::Any</span></code></a>;</p></li>
<li><p>allocate an output tensor as the producer, and hand it to a kernel consumer;</p></li>
<li><p>store a tensor in a long-lived object.</p></li>
</ul>
<div class="hint admonition">
<p class="admonition-title"><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj</span></code></a> vs <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
<p><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> is an intrusive pointer of a heap-allocated <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj</span></code></a>.
As an analogy to <code class="docutils literal notranslate"><span class="pre">std::shared_ptr</span></code>, think of</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Tensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">TensorObj</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>You can convert between the two types:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4NK3tvm3ffi6Tensor3getEv" title="tvm::ffi::Tensor::get"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::get()</span></code></a> converts it to <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj*</span></code></a>.</p></li>
<li><p><a class="reference internal" href="../reference/cpp/generated/function_cast_8h_1a3c5fed9bb23b4804b61037c8ac4874f1.html#_CPPv4I00EN3tvm3ffi6GetRefE7RefTypePK10ObjectType" title="tvm::ffi::GetRef"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GetRef&lt;Tensor&gt;</span></code></a> converts a <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj*</span></code></a> back to <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>.</p></li>
</ul>
</div>
</section>
<section id="tensor-layouts">
<span id="layout-and-conversion"></span><h3>Tensor Layouts<a class="headerlink" href="#tensor-layouts" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="#fig-layout-tensor"><span class="std std-ref">Figure 1</span></a> summarizes the layout relationships among DLPack tensors and TVM-FFI tensors.
All tensor classes are POD-like; <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">tvm::ffi::TensorObj</span></code></a> is also a standard TVM-FFI object, typically
heap-allocated and reference-counted.</p>
<figure class="align-center" id="fig-layout-tensor">
<img alt="Layout of DLPack Tensors and TVM-FFI Tensors" src="../_static/downloads/tensor-layout.png" />
<figcaption>
<p><span class="caption-text">Figure 1. Layout specification of DLPack tensors and TVM-FFI tensors. All the tensor types share <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a> as the common descriptor, while carrying different metadata and ownership semantics.</span><a class="headerlink" href="#fig-layout-tensor" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As demonstrated in the figure, all tensor classes share <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a> as the common descriptor.
In particular,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorView</span></code></a> share the exact same memory layout.</p></li>
<li><p><a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLManagedTensorVersioned" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLManagedTensorVersioned</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj</span></code></a> both have a deleter
callback to manage the lifetime of the underlying data buffer, while <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorView</span></code></a> do not.</p></li>
<li><p>Compared with <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorView</span></code></a>, <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj</span></code></a>
has an extra TVM-FFI object header, making it reference-countable via the standard managed reference <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>.</p></li>
</ul>
</section>
<section id="what-tensor-is-not">
<h3>What Tensor is not<a class="headerlink" href="#what-tensor-is-not" title="Link to this heading">#</a></h3>
<p>TVM-FFI is not a tensor library. While it presents a unified representation for tensors,
it does not provide any of the following:</p>
<ul class="simple">
<li><p>kernels, such as vector addition, matrix multiplication;</p></li>
<li><p>host-device copy or synchronization primitives;</p></li>
<li><p>advanced indexing or slicing;</p></li>
<li><p>automatic differentiation or computational graph support.</p></li>
</ul>
</section>
</section>
<section id="conversion-between-tvmffiany">
<h2>Conversion between <a class="reference internal" href="../reference/cpp/generated/structTVMFFIAny.html#_CPPv49TVMFFIAny" title="TVMFFIAny"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TVMFFIAny</span></code></a><a class="headerlink" href="#conversion-between-tvmffiany" title="Link to this heading">#</a></h2>
<p>At the stable C ABI boundary, TVM-FFI passes values using an “Any-like” carrier, often referred
to as <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Any</span></code></a> (owning) or <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a> (non-owning).
These are 128-bit tagged unions derived from <a class="reference internal" href="../reference/cpp/generated/structTVMFFIAny.html#_CPPv49TVMFFIAny" title="TVMFFIAny"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TVMFFIAny</span></code></a> that contain:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="../reference/cpp/generated/structTVMFFIAny.html#_CPPv4N9TVMFFIAny10type_indexE" title="TVMFFIAny::type_index"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">type_index</span></code></a> that indicates the type of the payload, and</p></li>
<li><p>a union payload that may contain:</p>
<ul>
<li><p>A1. Primitive values, such as integers, floats, enums, raw pointers, or</p></li>
<li><p>A2. TVM-FFI object handles, which are reference-counted pointers.</p></li>
</ul>
</li>
</ul>
<p>Specifically for tensors stored in <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Any</span></code></a> or <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a>,
there are two possible representations:</p>
<ul class="simple">
<li><p>Non-owning views as A1 (primitive values), i.e. <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor*</span></code></a> whose type index is <a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html#_CPPv4N15TVMFFITypeIndex18kTVMFFIDLTensorPtrE" title="TVMFFITypeIndex::kTVMFFIDLTensorPtr"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">TVMFFITypeIndex::kTVMFFIDLTensorPtr</span></code></a>.</p></li>
<li><p>Owning objects as A2 (TVM-FFI tensor object handles), i.e., <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj*</span></code></a> whose type index is <a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html#_CPPv4N15TVMFFITypeIndex13kTVMFFITensorE" title="TVMFFITypeIndex::kTVMFFITensor"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">TVMFFITypeIndex::kTVMFFITensor</span></code></a>.</p></li>
</ul>
<p>Therefore, when you see a tensor in <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Any</span></code></a> or <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a>,
first check its <a class="reference internal" href="../reference/cpp/generated/structTVMFFIAny.html#_CPPv4N9TVMFFIAny10type_indexE" title="TVMFFIAny::type_index"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">type_index</span></code></a> to determine whether it is a raw pointer or an object handle
before converting it to the desired tensor type.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>As a rule of thumb, an owning object can be converted to a non-owning view, but not vice versa.</p>
</div>
<section id="to-non-owning-tensor">
<h3>To Non-Owning Tensor<a class="headerlink" href="#to-non-owning-tensor" title="Link to this heading">#</a></h3>
<p>This converts an owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Any</span></code></a> or non-owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a> into a non-owning tensor.
Two type indices can be converted to a non-owning tensor view:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html#_CPPv4N15TVMFFITypeIndex18kTVMFFIDLTensorPtrE" title="TVMFFITypeIndex::kTVMFFIDLTensorPtr"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">TVMFFITypeIndex::kTVMFFIDLTensorPtr</span></code></a>: the payload is a raw pointer <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor*</span></code></a>.</p></li>
<li><p><a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html#_CPPv4N15TVMFFITypeIndex13kTVMFFITensorE" title="TVMFFITypeIndex::kTVMFFITensor"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">TVMFFITypeIndex::kTVMFFITensor</span></code></a>: the payload is a TVM-FFI tensor object handle, from which you can extract the underlying <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a> according to the layout defined in <a class="reference internal" href="#fig-layout-tensor"><span class="std std-ref">Figure 1</span></a>.</p></li>
</ul>
<p>The snippets below are plain C (C99-compatible) and assume the TVM-FFI C ABI definitions from
<code class="docutils literal notranslate"><span class="pre">tvm/ffi/c_api.h</span></code> are available.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Converts Any/AnyView to DLTensor*</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">AnyToDLTensorView</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">TVMFFIAny</span><span class="o">*</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">DLTensor</span><span class="o">**</span><span class="w"> </span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="o">-&gt;</span><span class="n">type_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kTVMFFIDLTensorPtr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">DLTensor</span><span class="o">*</span><span class="p">)</span><span class="n">value</span><span class="o">-&gt;</span><span class="n">v_ptr</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="o">-&gt;</span><span class="n">type_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kTVMFFITensor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// See Figure 1 for layout of tvm::ffi::TensorObj</span>
<span class="w">    </span><span class="n">TVMFFIObject</span><span class="o">*</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="o">-&gt;</span><span class="n">v_obj</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">DLTensor</span><span class="o">*</span><span class="p">)((</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">obj</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">TVMFFIObject</span><span class="p">));</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">FAILURE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorView</span></code></a> can be constructed directly from the returned <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor*</span></code></a>.</p>
</section>
<section id="to-owning-tensor">
<h3>To Owning Tensor<a class="headerlink" href="#to-owning-tensor" title="Link to this heading">#</a></h3>
<p>This converts an owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Any</span></code></a> or non-owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a> into an owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj</span></code></a>. Only type index <a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html#_CPPv4N15TVMFFITypeIndex13kTVMFFITensorE" title="TVMFFITypeIndex::kTVMFFITensor"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">TVMFFITypeIndex::kTVMFFITensor</span></code></a> can be converted to an owning tensor because it contains a TVM-FFI tensor object handle. The conversion involves incrementing the reference count to take ownership.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Converts Any/AnyView to TensorObj*</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">AnyToOwnedTensor</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">TVMFFIAny</span><span class="o">*</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">TVMFFIObjectHandle</span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="o">-&gt;</span><span class="n">type_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">kTVMFFITensor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">TVMFFIObjectHandle</span><span class="p">)</span><span class="n">value</span><span class="o">-&gt;</span><span class="n">v_obj</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">FAILURE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The caller can obtain shared ownership by calling <a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac66c1d142240be0cdf65c8ba38770eb6.html#_CPPv418TVMFFIObjectIncRef18TVMFFIObjectHandle" title="TVMFFIObjectIncRef"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TVMFFIObjectIncRef()</span></code></a> on the returned handle,
and later release it with <a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aba50ba2cee84b1ef7a718211ab349031.html#_CPPv418TVMFFIObjectDecRef18TVMFFIObjectHandle" title="TVMFFIObjectDecRef"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TVMFFIObjectDecRef()</span></code></a>.</p>
</section>
<section id="from-owning-tensor">
<h3>From Owning Tensor<a class="headerlink" href="#from-owning-tensor" title="Link to this heading">#</a></h3>
<p>This converts an owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj</span></code></a> to an owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Any</span></code></a> or non-owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a>. It sets the type index to <a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html#_CPPv4N15TVMFFITypeIndex13kTVMFFITensorE" title="TVMFFITypeIndex::kTVMFFITensor"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">TVMFFITypeIndex::kTVMFFITensor</span></code></a> and stores the tensor object handle in the payload.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Converts TensorObj* to AnyView</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">TensorToAnyView</span><span class="p">(</span><span class="n">TVMFFIObjectHandle</span><span class="w"> </span><span class="n">tensor</span><span class="p">,</span><span class="w"> </span><span class="n">TVMFFIAny</span><span class="o">*</span><span class="w"> </span><span class="n">out_any_view</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">out_any_view</span><span class="o">-&gt;</span><span class="n">type_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kTVMFFITensor</span><span class="p">;</span>
<span class="w">  </span><span class="n">out_any_view</span><span class="o">-&gt;</span><span class="n">zero_padding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">out_any_view</span><span class="o">-&gt;</span><span class="n">v_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">TVMFFIObject</span><span class="o">*</span><span class="p">)</span><span class="n">tensor</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Converts TensorObj* to Any</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">TensorToAny</span><span class="p">(</span><span class="n">TVMFFIObjectHandle</span><span class="w"> </span><span class="n">tensor</span><span class="p">,</span><span class="w"> </span><span class="n">TVMFFIAny</span><span class="o">*</span><span class="w"> </span><span class="n">out_any</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">TVMFFIAny</span><span class="w"> </span><span class="n">any_view</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TensorToAnyView</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">any_view</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">TVMFFIObjectIncRef</span><span class="p">(</span><span class="n">tensor</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="n">out_any</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">any_view</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The C API <a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1ac66c1d142240be0cdf65c8ba38770eb6.html#_CPPv418TVMFFIObjectIncRef18TVMFFIObjectHandle" title="TVMFFIObjectIncRef"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TVMFFIObjectIncRef()</span></code></a> obtains shared ownership of the tensor into <cite>out_any</cite>. Later, release it with
<a class="reference internal" href="../reference/cpp/generated/function_c__api_8h_1aba50ba2cee84b1ef7a718211ab349031.html#_CPPv418TVMFFIObjectDecRef18TVMFFIObjectHandle" title="TVMFFIObjectDecRef"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TVMFFIObjectDecRef()</span></code></a> on its <a class="reference internal" href="../reference/cpp/generated/structTVMFFIAny.html#_CPPv4N9TVMFFIAny5v_objE" title="TVMFFIAny::v_obj"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">TVMFFIAny::v_obj</span></code></a> field.</p>
</section>
<section id="from-non-owning-tensor">
<h3>From Non-Owning Tensor<a class="headerlink" href="#from-non-owning-tensor" title="Link to this heading">#</a></h3>
<p>This converts a non-owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorView</span></code></a> to non-owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a>.
It sets the type index to <a class="reference internal" href="../reference/cpp/generated/enum_c__api_8h_1a1925bb5d568a3f5c92a6c28934c9bcc2.html#_CPPv4N15TVMFFITypeIndex18kTVMFFIDLTensorPtrE" title="TVMFFITypeIndex::kTVMFFIDLTensorPtr"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">TVMFFITypeIndex::kTVMFFIDLTensorPtr</span></code></a> and stores a raw pointer to <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor*</span></code></a> in the payload.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Non-owning <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html#c.DLTensor" title="(in DLPack)"><code class="xref c c-struct docutils literal notranslate"><span class="pre">DLTensor</span></code></a> or <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorView</span></code></a> can be converted to non-owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a>, but cannot be converted to owning <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Any</span></code></a>.</p>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Converts DLTensor* to AnyView</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">DLTensorToAnyView</span><span class="p">(</span><span class="n">DLTensor</span><span class="o">*</span><span class="w"> </span><span class="n">tensor</span><span class="p">,</span><span class="w"> </span><span class="n">TVMFFIAny</span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">out</span><span class="o">-&gt;</span><span class="n">type_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kTVMFFIDLTensorPtr</span><span class="p">;</span>
<span class="w">  </span><span class="n">out</span><span class="o">-&gt;</span><span class="n">zero_padding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">out</span><span class="o">-&gt;</span><span class="n">v_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tensor</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Converts TensorView to AnyView</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">TensorViewToAnyView</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tvm</span><span class="o">::</span><span class="n">ffi</span><span class="o">::</span><span class="n">TensorView</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tensor_view</span><span class="p">,</span><span class="w"> </span><span class="n">TVMFFIAny</span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">DLTensorToAnyView</span><span class="p">(</span><span class="n">tensor_view</span><span class="p">.</span><span class="n">GetDLTensorPtr</span><span class="p">(),</span><span class="w"> </span><span class="n">out</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="tensor-apis">
<h2>Tensor APIs<a class="headerlink" href="#tensor-apis" title="Link to this heading">#</a></h2>
<p>This section introduces the most important APIs you will use in C++ and Python. It intentionally
focuses on introductory, day-to-day methods.</p>
<section id="c-apis">
<h3>C++ APIs<a class="headerlink" href="#c-apis" title="Link to this heading">#</a></h3>
<p><strong>Common pattern</strong>. A typical kernel implementation includes accepting a <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorView</span></code></a> parameter,
validating its metadata (dtype, shape, device), and then accessing its data pointer for computation.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">MyKernel</span><span class="p">(</span><span class="n">tvm</span><span class="o">::</span><span class="n">ffi</span><span class="o">::</span><span class="n">TensorView</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">tvm</span><span class="o">::</span><span class="n">ffi</span><span class="o">::</span><span class="n">TensorView</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Validate dtype &amp; device</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">dtype</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DLDataType</span><span class="p">{</span><span class="n">kDLFloat</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">})</span>
<span class="w">    </span><span class="n">TVM_FFI_THROW</span><span class="p">(</span><span class="n">TypeError</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Expect float32 input, but got &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">dtype</span><span class="p">();</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">device</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DLDevice</span><span class="p">{</span><span class="n">kDLCUDA</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">})</span>
<span class="w">    </span><span class="n">TVM_FFI_THROW</span><span class="p">(</span><span class="n">ValueError</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Expect input on CUDA:0, but got &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">device</span><span class="p">();</span>
<span class="w">  </span><span class="c1">// Access data pointer</span>
<span class="w">  </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">input_data_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">data_ptr</span><span class="p">());</span>
<span class="w">  </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">output_data_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">output</span><span class="p">.</span><span class="n">data_ptr</span><span class="p">());</span>
<span class="w">  </span><span class="n">Kernel</span><span class="o">&lt;&lt;&lt;</span><span class="p">...</span><span class="o">&gt;&gt;&gt;</span><span class="p">(...,</span><span class="w"> </span><span class="n">input_data_ptr</span><span class="p">,</span><span class="w"> </span><span class="n">output_data_ptr</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Metadata APIs</strong>. The example above uses metadata APIs for querying tensor shapes, data types, device information, data pointers, etc. Common ones include:</p>
<blockquote>
<div><dl class="simple">
<dt><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4NK3tvm3ffi10TensorView5shapeEv" title="tvm::ffi::TensorView::shape"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TensorView::shape()</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4NK3tvm3ffi6Tensor5shapeEv" title="tvm::ffi::Tensor::shape"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::shape()</span></code></a></dt><dd><p>shape array</p>
</dd>
<dt><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4NK3tvm3ffi10TensorView5dtypeEv" title="tvm::ffi::TensorView::dtype"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TensorView::dtype()</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4NK3tvm3ffi6Tensor5dtypeEv" title="tvm::ffi::Tensor::dtype"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::dtype()</span></code></a></dt><dd><p>element data type</p>
</dd>
<dt><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4NK3tvm3ffi10TensorView8data_ptrEv" title="tvm::ffi::TensorView::data_ptr"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TensorView::data_ptr()</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4NK3tvm3ffi6Tensor8data_ptrEv" title="tvm::ffi::Tensor::data_ptr"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::data_ptr()</span></code></a></dt><dd><p>base pointer to the tensor’s data</p>
</dd>
<dt><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4NK3tvm3ffi10TensorView6deviceEv" title="tvm::ffi::TensorView::device"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TensorView::device()</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4NK3tvm3ffi6Tensor6deviceEv" title="tvm::ffi::Tensor::device"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::device()</span></code></a></dt><dd><p>device type and id</p>
</dd>
<dt><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4NK3tvm3ffi10TensorView11byte_offsetEv" title="tvm::ffi::TensorView::byte_offset"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TensorView::byte_offset()</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4NK3tvm3ffi6Tensor11byte_offsetEv" title="tvm::ffi::Tensor::byte_offset"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::byte_offset()</span></code></a></dt><dd><p>byte offset to the first element</p>
</dd>
<dt><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4NK3tvm3ffi10TensorView4ndimEv" title="tvm::ffi::TensorView::ndim"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TensorView::ndim()</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4NK3tvm3ffi6Tensor4ndimEv" title="tvm::ffi::Tensor::ndim"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::ndim()</span></code></a></dt><dd><p>number of dimensions (<a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ShapeView.html#_CPPv4NK3tvm3ffi9ShapeView4sizeEv" title="tvm::ffi::ShapeView::size"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">ShapeView::size</span></code></a>)</p>
</dd>
<dt><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4NK3tvm3ffi10TensorView5numelEv" title="tvm::ffi::TensorView::numel"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TensorView::numel()</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4NK3tvm3ffi6Tensor5numelEv" title="tvm::ffi::Tensor::numel"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::numel()</span></code></a></dt><dd><p>total number of elements (<a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1ShapeView.html#_CPPv4NK3tvm3ffi9ShapeView7ProductEv" title="tvm::ffi::ShapeView::Product"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">ShapeView::Product</span></code></a>)</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="python-apis">
<h3>Python APIs<a class="headerlink" href="#python-apis" title="Link to this heading">#</a></h3>
<p>The Python-facing <a class="reference internal" href="../reference/python/generated/tvm_ffi.Tensor.html#tvm_ffi.Tensor" title="tvm_ffi.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">tvm_ffi.Tensor</span></code></a> is a managed n-dimensional array that:</p>
<ul class="simple">
<li><p>Can be created via <a class="reference internal" href="../reference/python/generated/tvm_ffi.from_dlpack.html#tvm_ffi.from_dlpack" title="tvm_ffi.from_dlpack"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvm_ffi.from_dlpack(ext_tensor,</span> <span class="pre">...)</span></code></a> to import tensors from external frameworks, e.g. <a class="reference internal" href="../get_started/quickstart.html#ship-to-pytorch"><span class="std std-ref">PyTorch</span></a>, <a class="reference internal" href="../get_started/quickstart.html#ship-to-jax"><span class="std std-ref">JAX</span></a>, <a class="reference internal" href="../get_started/quickstart.html#ship-to-numpy"><span class="std std-ref">NumPy/CuPy</span></a>.</p></li>
<li><p>Implements the DLPack protocol so it can be passed back to frameworks without copying, e.g. <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.from_dlpack.html#torch.from_dlpack" title="(in PyTorch v2.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.from_dlpack()</span></code></a>.</p></li>
</ul>
<p>Typical import pattern:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tvm_ffi</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">tvm_ffi</span><span class="o">.</span><span class="n">from_dlpack</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">require_contiguous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># t is a tvm_ffi.Tensor that views the same memory.</span>
<span class="c1"># You can pass t into TVM-FFI-exposed functions.</span>
</pre></div>
</div>
</section>
<section id="allocation-in-c">
<h3>Allocation in C++<a class="headerlink" href="#allocation-in-c" title="Link to this heading">#</a></h3>
<p>TVM-FFI is not a kernel library per se and is not linked to any specific device memory allocator or runtime.
However, for kernel library developers, it provides standardized allocation entry points by
interfacing with the surrounding framework’s allocator. For example, it uses PyTorch’s allocator when running inside
a PyTorch environment.</p>
<p><strong>Env Allocator.</strong> Use <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6Tensor12FromEnvAllocEPFiP8DLTensorP18TVMFFIObjectHandleEN3ffi9ShapeViewE10DLDataType8DLDevice" title="tvm::ffi::Tensor::FromEnvAlloc"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::FromEnvAlloc()</span></code></a> along with C API
<a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a683191d48d3fdebc98b68f3b717baf6a.html#_CPPv420TVMFFIEnvTensorAllocP8DLTensorP18TVMFFIObjectHandle" title="TVMFFIEnvTensorAlloc"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TVMFFIEnvTensorAlloc()</span></code></a> to allocate a tensor using the framework’s allocator.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Tensor</span><span class="w"> </span><span class="n">tensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Tensor</span><span class="o">::</span><span class="n">FromEnvAlloc</span><span class="p">(</span>
<span class="w">  </span><span class="n">TVMFFIEnvTensorAlloc</span><span class="p">,</span>
<span class="w">  </span><span class="cm">/*shape=*/</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span>
<span class="w">  </span><span class="cm">/*dtype=*/</span><span class="n">DLDataType</span><span class="p">({</span><span class="n">kDLFloat</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">}),</span>
<span class="w">  </span><span class="cm">/*device=*/</span><span class="n">DLDevice</span><span class="p">({</span><span class="n">kDLCPU</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">})</span>
<span class="p">);</span>
</pre></div>
</div>
<p>In a PyTorch environment, this is equivalent to <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.empty.html#torch.empty" title="(in PyTorch v2.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.empty()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While allocation APIs are available, it is generally <strong>recommended</strong> to avoid allocating tensors inside kernels.
Instead, prefer pre-allocating outputs and passing them in as <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorView.html#_CPPv4N3tvm3ffi10TensorViewE" title="tvm::ffi::TensorView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">tvm::ffi::TensorView</span></code></a> parameters.
Reasons include:</p>
<ul class="simple">
<li><p>Avoiding fragmentation and performance pitfalls;</p></li>
<li><p>Avoiding cudagraph incompatibilities on GPU;</p></li>
<li><p>Allowing the outer framework to control allocation policy (pools, device strategies, etc.).</p></li>
</ul>
</div>
<p><strong>Custom Allocator.</strong> Use <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4I0DpEN3tvm3ffi6Tensor11FromNDAllocE6Tensor8TNDAllocN3ffi9ShapeViewE10DLDataType8DLDeviceDpRR9ExtraArgs" title="tvm::ffi::Tensor::FromNDAlloc"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::FromNDAlloc(custom_alloc,</span> <span class="pre">...)</span></code></a>,
or its advanced variant <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4I0DpEN3tvm3ffi6Tensor18FromNDAllocStridedE6Tensor8TNDAllocN3ffi9ShapeViewEN3ffi9ShapeViewE10DLDataType8DLDeviceDpRR9ExtraArgs" title="tvm::ffi::Tensor::FromNDAllocStrided"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Tensor::FromNDAllocStrided(custom_alloc,</span> <span class="pre">...)</span></code></a>,
to allocate a tensor with user-provided allocation callback.</p>
<p>Below is an example that uses <code class="docutils literal notranslate"><span class="pre">cudaMalloc</span></code>/<code class="docutils literal notranslate"><span class="pre">cudaFree</span></code> as custom allocators for GPU tensors.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">CUDANDAlloc</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">AllocData</span><span class="p">(</span><span class="n">DLTensor</span><span class="o">*</span><span class="w"> </span><span class="n">tensor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">data_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ffi</span><span class="o">::</span><span class="n">GetDataSize</span><span class="p">(</span><span class="o">*</span><span class="n">tensor</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="n">cudaError_t</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="p">);</span>
<span class="w">    </span><span class="n">TVM_FFI_ICHECK_EQ</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">cudaSuccess</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;cudaMalloc failed: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">cudaGetErrorString</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
<span class="w">    </span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">FreeData</span><span class="p">(</span><span class="n">DLTensor</span><span class="o">*</span><span class="w"> </span><span class="n">tensor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">cudaError_t</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<span class="w">      </span><span class="n">TVM_FFI_ICHECK_EQ</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">cudaSuccess</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;cudaFree failed: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">cudaGetErrorString</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
<span class="w">      </span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>

<span class="n">ffi</span><span class="o">::</span><span class="n">Tensor</span><span class="w"> </span><span class="n">cuda_tensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ffi</span><span class="o">::</span><span class="n">Tensor</span><span class="o">::</span><span class="n">FromNDAlloc</span><span class="p">(</span>
<span class="w">  </span><span class="n">CUDANDAlloc</span><span class="p">(),</span>
<span class="w">  </span><span class="cm">/*shape=*/</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span>
<span class="w">  </span><span class="cm">/*dtype=*/</span><span class="n">DLDataType</span><span class="p">({</span><span class="n">kDLFloat</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">}),</span>
<span class="w">  </span><span class="cm">/*device=*/</span><span class="n">DLDevice</span><span class="p">({</span><span class="n">kDLCUDA</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">})</span>
<span class="p">);</span>
</pre></div>
</div>
</section>
<section id="stream-handling-in-c">
<h3>Stream Handling in C++<a class="headerlink" href="#stream-handling-in-c" title="Link to this heading">#</a></h3>
<p>Besides tensors, stream context is another key concept in a kernel library, especially for kernel execution. While CUDA does not have a global context for default streams, frameworks like PyTorch maintain a “current stream” per device (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.cuda.current_stream.html#torch.cuda.current_stream" title="(in PyTorch v2.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.cuda.current_stream()</span></code></a>), and kernel libraries must read the current stream from the embedding environment.</p>
<p>As a hardware-agnostic abstraction layer, TVM-FFI is not linked to any specific stream management library, but to ensure GPU kernels launch on the correct stream, it provides standardized APIs to obtain stream context from the upper framework (e.g. PyTorch).</p>
<p><strong>Obtain Stream Context.</strong> Use C API <a class="reference internal" href="../reference/cpp/generated/function_c__env__api_8h_1a8ce2ba89ca1d010a084b4c36ed6b2965.html#_CPPv418TVMFFIEnvGetStream7int32_t7int32_t" title="TVMFFIEnvGetStream"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">TVMFFIEnvGetStream()</span></code></a> to obtain the current stream for a given device.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">ffi</span><span class="o">::</span><span class="n">TensorView</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ffi</span><span class="o">::</span><span class="n">DLDevice</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">device</span><span class="p">();</span>
<span class="w">  </span><span class="n">cudaStream_t</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">cudaStream_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TVMFFIEnvGetStream</span><span class="p">(</span><span class="n">device</span><span class="p">.</span><span class="n">device_type</span><span class="p">,</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="n">device_id</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>which is equivalent to:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">at</span><span class="o">::</span><span class="n">Tensor</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">c10</span><span class="o">::</span><span class="n">Device</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">device</span><span class="p">();</span>
<span class="w">  </span><span class="n">cudaStream_t</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">cudaStream_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">c10</span><span class="o">::</span><span class="n">cuda</span><span class="o">::</span><span class="n">getCurrentCUDAStream</span><span class="p">(</span><span class="n">device</span><span class="p">.</span><span class="n">index</span><span class="p">()).</span><span class="n">stream</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Auto-Update Stream Context.</strong> When converting framework tensors as mentioned above, TVM-FFI automatically updates the stream context to match the device of the converted tensors.</p>
<p>For example, when converting a PyTorch tensor at <code class="docutils literal notranslate"><span class="pre">torch.device('cuda:3')</span></code>, TVM-FFI automatically sets the stream context to <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.cuda.current_stream(device='cuda:3')()</span></code>.</p>
<p><strong>Set Stream Context.</strong> <a class="reference internal" href="../reference/python/generated/tvm_ffi.use_torch_stream.html#tvm_ffi.use_torch_stream" title="tvm_ffi.use_torch_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvm_ffi.use_torch_stream()</span></code></a> and <a class="reference internal" href="../reference/python/generated/tvm_ffi.use_raw_stream.html#tvm_ffi.use_raw_stream" title="tvm_ffi.use_raw_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvm_ffi.use_raw_stream()</span></code></a> are provided to manually update the stream context when the automatic update is insufficient.</p>
</section>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1TensorObj.html#_CPPv4N3tvm3ffi9TensorObjE" title="tvm::ffi::TensorObj"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TensorObj</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Tensor.html#_CPPv4N3tvm3ffi6TensorE" title="tvm::ffi::Tensor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> are part of the standard TVM-FFI object system.
See <a class="reference internal" href="abi_overview.html#object-storage-format"><span class="std std-ref">Object System</span></a> for details on how TVM-FFI objects work.</p></li>
<li><p><a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1AnyView.html#_CPPv4N3tvm3ffi7AnyViewE" title="tvm::ffi::AnyView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">AnyView</span></code></a> and <a class="reference internal" href="../reference/cpp/generated/classtvm_1_1ffi_1_1Any.html#_CPPv4N3tvm3ffi3AnyE" title="tvm::ffi::Any"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Any</span></code></a> are part of the stable C ABI.
Tutorial <a class="reference internal" href="../get_started/stable_c_abi.html"><span class="doc">Stable C ABI</span></a> explains the ABI design at a high level,
and <a class="reference internal" href="abi_overview.html"><span class="doc">ABI Overview</span></a> shares details on the design.</p></li>
<li><p>DLPack specification can be found at <a class="reference external" href="https://data-apis.org/array-api/latest/design_topics/data_interchange.html" title="(in Python array API standard)"><span class="xref std std-doc">DLPack protocol</span></a>, and documentation at <a class="reference external" href="https://dmlc.github.io/dlpack/latest/c_api.html" title="(in DLPack)"><span class="xref std std-doc">C API</span></a> and <a class="reference external" href="https://dmlc.github.io/dlpack/latest/python_spec.html" title="(in DLPack)"><span class="xref std std-doc">Python API</span></a>.</p></li>
<li><p>Kernel library developers may also refer to <a class="reference internal" href="../guides/kernel_library_guide.html"><span class="doc">Kernel Library Guide</span></a> and <a class="reference external" href="https://github.com/flashinfer-ai/flashinfer/">FlashInfer</a> for best practices on building high-performance kernel libraries with TVM-FFI.</p></li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="abi_overview.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">ABI Overview</p>
      </div>
    </a>
    <a class="right-next"
       href="../packaging/python_packaging.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Python Packaging</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">Glossary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-classes">Tensor Classes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dlpack-tensors">DLPack Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tvm-ffi-tensors">TVM-FFI Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-layouts">Tensor Layouts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-tensor-is-not">What Tensor is not</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-between-tvmffiany">Conversion between <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TVMFFIAny</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-non-owning-tensor">To Non-Owning Tensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-owning-tensor">To Owning Tensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#from-owning-tensor">From Owning Tensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#from-non-owning-tensor">From Non-Owning Tensor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-apis">Tensor APIs</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-apis">C++ APIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-apis">Python APIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#allocation-in-c">Allocation in C++</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stream-handling-in-c">Stream Handling in C++</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Apache TVM FFI contributors
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Jan 05, 2026.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  
  <div class="footer-container" style="margin: 5px 0; font-size: 0.9em; color: #6c757d;">
      <div class="footer-line1" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 3px;">
          <div class="footer-copyright-short">
              Copyright © 2025, Apache Software Foundation
          </div>
          <div class="footer-dropdown">
              <div class="dropdown">
                  <button class="btn btn-link dropdown-toggle" type="button" id="footerDropdown" data-bs-toggle="dropdown"
                  aria-expanded="false" style="font-size: 0.9em; color: #6c757d; text-decoration: none; padding: 0; border: none; background: none;">
                      ASF
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="footerDropdown" style="font-size: 0.9em;">
<li><a class="dropdown-item" href="https://apache.org/" target="_blank" style="font-size: 0.9em;">ASF Homepage</a></li>
<li><a class="dropdown-item" href="https://www.apache.org/licenses/" target="_blank" style="font-size: 0.9em;">License</a></li>
<li><a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html" target="_blank" style="font-size: 0.9em;">Sponsorship</a></li>
<li><a class="dropdown-item" href="https://tvm.apache.org/docs/reference/security.html" target="_blank" style="font-size: 0.9em;">Security</a></li>
<li><a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html" target="_blank" style="font-size: 0.9em;">Thanks</a></li>
<li><a class="dropdown-item" href="https://www.apache.org/events/current-event" target="_blank" style="font-size: 0.9em;">Events</a></li>
                  </ul>
              </div>
          </div>
      </div>
      <div class="footer-line2" style="font-size: 0.9em; color: #6c757d;">
          Apache TVM, Apache, the Apache feather, and the Apache TVM project logo are either trademarks or registered trademarks of the Apache Software Foundation.
      </div>
  </div>
  
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>