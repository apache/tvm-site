

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tvm.relay.testing &mdash; tvm 0.7.dev1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/tvm-logo-square.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/tvm_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="tvm.autotvm" href="../autotvm.html" />
    <link rel="prev" title="tvm.relay.dataflow_pattern" href="dataflow_pattern.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/tvm-logo-small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.7.dev1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">How to</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute/index.html">Contribute to TVM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../deploy/index.html">Deploy and Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/how_to.html">Developer How-To Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Get Started Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#compile-deep-learning-models">Compile Deep Learning Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#tensor-expression-and-schedules">Tensor Expression and Schedules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#optimize-tensor-operators">Optimize Tensor Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#auto-tuning">Auto tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#developer-tutorials">Developer Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#topi-tvm-operator-inventory">TOPI: TVM Operator Inventory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#micro-tvm">Micro TVM</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../langref/index.html">Language Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Python API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../runtime.html">tvm.runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ndarray.html">tvm.runtime.ndarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error.html">tvm.error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ir.html">tvm.ir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ir.html#module-tvm.transform">tvm.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../target.html">tvm.target</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir.html">tvm.tir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir.html#module-tvm.tir.transform">tvm.tir.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir.html#module-tvm.tir.analysis">tvm.tir.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir.html#module-tvm.tir.stmt_functor">tvm.tir.stmt_functor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../te.html">tvm.te</a></li>
<li class="toctree-l2"><a class="reference internal" href="../te.html#module-tvm.te.hybrid">tvm.te.hybrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../driver.html">tvm.driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html">tvm.relay</a></li>
<li class="toctree-l2"><a class="reference internal" href="frontend.html">tvm.relay.frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn.html">tvm.relay.nn</a></li>
<li class="toctree-l2"><a class="reference internal" href="vision.html">tvm.relay.vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="image.html">tvm.relay.image</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform.html">tvm.relay.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">tvm.relay.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="backend.html">tvm.relay.backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataflow_pattern.html">tvm.relay.dataflow_pattern</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">tvm.relay.testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autotvm.html">tvm.autotvm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rpc.html">tvm.rpc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../micro.html">tvm.micro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib.html">tvm.contrib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graph_runtime.html">tvm.contrib.graph_runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topi.html">tvm.topi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vta/index.html">vta</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../links.html">Links to Other API References</a></li>
</ul>
<p class="caption"><span class="caption-text">Deep Dive</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/index.html">Design and Architecture</a></li>
</ul>
<p class="caption"><span class="caption-text">MISC</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../vta/index.html">VTA: Deep Learning Accelerator Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../genindex.html">Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">tvm</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Python API</a> &raquo;</li>
        
      <li>tvm.relay.testing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/api/python/relay/testing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-tvm.relay.testing">
<span id="tvm-relay-testing"></span><h1>tvm.relay.testing<a class="headerlink" href="#module-tvm.relay.testing" title="Permalink to this headline">¶</a></h1>
<p>Utilities for testing and benchmarks</p>
<p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.Prelude" title="tvm.relay.testing.Prelude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Prelude</span></code></a>([mod])</p></td>
<td><p>Contains standard definitions.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.add_nat_definitions" title="tvm.relay.testing.add_nat_definitions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_nat_definitions</span></code></a>(prelude)</p></td>
<td><p>Given a Relay prelude, adds a Peano nat ADT, as well as functions for adding nats and doubling nats.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.testing.check_grad" title="tvm.relay.testing.check_grad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_grad</span></code></a>(func[, inputs, test_inputs, eps, …])</p></td>
<td><p>Perform numerical gradient checking given a relay function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.count" title="tvm.relay.testing.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count</span></code></a>(prelude, n)</p></td>
<td><p>Takes a ConstructorValue corresponding to a nat ADT and converts it into a Python integer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.testing.count_ops" title="tvm.relay.testing.count_ops"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_ops</span></code></a>(expr)</p></td>
<td><p>count number of times a given op is called in the graph</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.create_workload" title="tvm.relay.testing.create_workload"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_workload</span></code></a>(net[, initializer, seed])</p></td>
<td><p>Helper function to create benchmark image classification workload.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.testing.ctx_list" title="tvm.relay.testing.ctx_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ctx_list</span></code></a>()</p></td>
<td><p>Get context list for testcases</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.gradient" title="tvm.relay.testing.gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient</span></code></a>(expr[, mod, mode])</p></td>
<td><p>Transform the input function, returning a function that calculate the original result, paired with gradient of the input.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.testing.make_nat_expr" title="tvm.relay.testing.make_nat_expr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_nat_expr</span></code></a>(prelude, n)</p></td>
<td><p>Given a non-negative Python integer, constructs a Python expression representing that integer’s value as a nat.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.make_nat_value" title="tvm.relay.testing.make_nat_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_nat_value</span></code></a>(prelude, n)</p></td>
<td><p>The inverse of count(): Given a non-negative Python integer, constructs a ConstructorValue representing that value as a nat.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.testing.run_as_python" title="tvm.relay.testing.run_as_python"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_as_python</span></code></a>(expr[, mod, target])</p></td>
<td><p>Converts the given Relay expression into a Python script and executes it.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.to_python" title="tvm.relay.testing.to_python"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_python</span></code></a>(expr[, mod, target])</p></td>
<td><p>Converts the given Relay expression into a Python script (as a Python AST object).</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="tvm.relay.testing.Prelude">
<em class="property">class </em><code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">Prelude</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mod</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.Prelude" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains standard definitions.</p>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.Prelude.get_name" title="tvm.relay.testing.Prelude.get_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_name</span></code></a>(canonical, dtype)</p></td>
<td><p>Get name corresponding to the canonical name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.testing.Prelude.get_name_static" title="tvm.relay.testing.Prelude.get_name_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_name_static</span></code></a>(canonical, dtype, shape)</p></td>
<td><p>Get name corresponding to the canonical name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.Prelude.get_var" title="tvm.relay.testing.Prelude.get_var"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_var</span></code></a>(canonical, dtype)</p></td>
<td><p>Get var corresponding to the canonical name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.testing.Prelude.get_var_static" title="tvm.relay.testing.Prelude.get_var_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_var_static</span></code></a>(canonical, dtype, shape)</p></td>
<td><p>Get var corresponding to the canonical name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.testing.Prelude.load_prelude" title="tvm.relay.testing.Prelude.load_prelude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_prelude</span></code></a>()</p></td>
<td><p>Parses the Prelude from Relay’s text format into a module.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="tvm.relay.testing.Prelude.get_name">
<code class="sig-name descname">get_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">canonical</span></em>, <em class="sig-param"><span class="n">dtype</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.Prelude.get_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get name corresponding to the canonical name</p>
</dd></dl>

<dl class="py method">
<dt id="tvm.relay.testing.Prelude.get_var">
<code class="sig-name descname">get_var</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">canonical</span></em>, <em class="sig-param"><span class="n">dtype</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.Prelude.get_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Get var corresponding to the canonical name</p>
</dd></dl>

<dl class="py method">
<dt id="tvm.relay.testing.Prelude.get_name_static">
<code class="sig-name descname">get_name_static</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">canonical</span></em>, <em class="sig-param"><span class="n">dtype</span></em>, <em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.Prelude.get_name_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Get name corresponding to the canonical name</p>
</dd></dl>

<dl class="py method">
<dt id="tvm.relay.testing.Prelude.get_var_static">
<code class="sig-name descname">get_var_static</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">canonical</span></em>, <em class="sig-param"><span class="n">dtype</span></em>, <em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.Prelude.get_var_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Get var corresponding to the canonical name</p>
</dd></dl>

<dl class="py method">
<dt id="tvm.relay.testing.Prelude.load_prelude">
<code class="sig-name descname">load_prelude</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.Prelude.load_prelude" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Prelude from Relay’s text format into a module.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.ctx_list">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">ctx_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.ctx_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get context list for testcases</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.create_workload">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">create_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">net</span></em>, <em class="sig-param"><span class="n">initializer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.create_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to create benchmark image classification workload.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net</strong> (<a class="reference internal" href="index.html#tvm.relay.Function" title="tvm.relay.Function"><em>tvm.relay.Function</em></a>) – The selected function of the network.</p></li>
<li><p><strong>initializer</strong> (<em>Initializer</em>) – The initializer used</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The seed used in initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The created relay module.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.add_nat_definitions">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">add_nat_definitions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prelude</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.add_nat_definitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a Relay prelude, adds a Peano nat ADT, as well as functions
for adding nats and doubling nats. It also adds versions of
update, nth, and iterate that take nats instead of scalars (the
names are prefixed with <cite>nat_</cite>).</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.count">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">count</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prelude</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a ConstructorValue corresponding to a nat ADT
and converts it into a Python integer. This is an example of
using an ADT value in Python.</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.make_nat_value">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">make_nat_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prelude</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.make_nat_value" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse of count(): Given a non-negative Python integer,
constructs a ConstructorValue representing that value as a nat.</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.make_nat_expr">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">make_nat_expr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prelude</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.make_nat_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a non-negative Python integer, constructs a Python
expression representing that integer’s value as a nat.</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.to_python">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">to_python</code><span class="sig-paren">(</span><em class="sig-param">expr: tvm.ir.expr.RelayExpr</em>, <em class="sig-param">mod=None</em>, <em class="sig-param">target=llvm -keys=cpu</em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.to_python" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the given Relay expression into a Python script (as a Python AST object).
For easiest debugging, import the astor package and use to_source().</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.run_as_python">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">run_as_python</code><span class="sig-paren">(</span><em class="sig-param">expr: tvm.ir.expr.RelayExpr</em>, <em class="sig-param">mod=None</em>, <em class="sig-param">target=llvm -keys=cpu</em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.run_as_python" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the given Relay expression into a Python script and
executes it.</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.gradient">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em>, <em class="sig-param"><span class="n">mod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'higher_order'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the input function,
returning a function that calculate the original result,
paired with gradient of the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>tvm.relay.Expr</em>) – The input expression, which is a Function or a GlobalVar.</p></li>
<li><p><strong>mod</strong> (<em>Optional</em><em>[</em><em>tvm.IRModule</em><em>]</em>) – </p></li>
<li><p><strong>mode</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="../runtime.html#tvm.runtime.String" title="tvm.runtime.String"><em>String</em></a><em>]</em>) – The mode of the automatic differentiation algorithm.
‘first_order’ only works on first order code, but will not produce
reference nor closure.
‘higher_order’ works on all code using reference and closure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>expr</strong> – The transformed expression.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tvm.relay.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.check_grad">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">check_grad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="n">inputs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">test_inputs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">1e-06</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mean</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.check_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform numerical gradient checking given a relay function.</p>
<p>Compare analytical gradients to numerical gradients derived from two-sided approximation. Note
that this test may fail if your function input types are not of high enough precision.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<a class="reference internal" href="index.html#tvm.relay.Function" title="tvm.relay.Function"><em>tvm.relay.Function</em></a>) – The relay function to test.</p></li>
<li><p><strong>inputs</strong> (<a class="reference internal" href="dataflow_pattern.html#tvm.relay.dataflow_pattern.List" title="tvm.relay.dataflow_pattern.List"><em>List</em></a><em>[</em><em>np.array</em><em>]</em>) – Optional user-provided input parameters to use. If not given, will generate random normal
inputs scaled to be close to the chosen epsilon value to avoid numerical precision loss.</p></li>
<li><p><strong>test_inputs</strong> (<a class="reference internal" href="dataflow_pattern.html#tvm.relay.dataflow_pattern.List" title="tvm.relay.dataflow_pattern.List"><em>List</em></a><em>[</em><em>np.array</em><em>]</em>) – The inputs to test for gradient matching. Useful in cases where some inputs are not
differentiable, such as symbolic inputs to dynamic ops. If not given, all inputs are
tested.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The epsilon value to use for computing numerical gradient approximation.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The absolute tolerance on difference between numerical and analytical gradients. Note that
this needs to be scaled appropriately relative to the chosen eps and inputs.</p></li>
<li><p><strong>rtol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The relative tolerance on difference between numerical and analytical gradients. Note that
this needs to be scaled appropriately relative to the chosen eps.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The standard deviation of the inputs.</p></li>
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The mean of the inputs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.count_ops">
<code class="sig-prename descclassname">tvm.relay.testing.</code><code class="sig-name descname">count_ops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.count_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>count number of times a given op is called in the graph</p>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.mlp"></span><p>a simple multilayer perceptron</p>
<dl class="py function">
<dt id="tvm.relay.testing.mlp.get_net">
<code class="sig-prename descclassname">tvm.relay.testing.mlp.</code><code class="sig-name descname">get_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">num_classes</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">1, 28, 28</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.mlp.get_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Get network a simple multilayer perceptron.</p>
<dl class="simple">
<dt>batch_size<span class="classifier">int</span></dt><dd><p>The batch size used in the model</p>
</dd>
<dt>num_classes<span class="classifier">int, optional</span></dt><dd><p>Number of claseses</p>
</dd>
<dt>image_shape<span class="classifier">tuple, optional</span></dt><dd><p>The input image shape</p>
</dd>
<dt>dtype<span class="classifier">str, optional</span></dt><dd><p>The data type</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>net</strong> – The dataflow.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="index.html#tvm.relay.Function" title="tvm.relay.Function">relay.Function</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.mlp.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.mlp.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">num_classes</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">1, 28, 28</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.mlp.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Get benchmark workload for a simple multilayer perceptron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The batch size used in the model</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of claseses</p></li>
<li><p><strong>image_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The input image shape</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data type</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains a mlp network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.resnet"></span><p>Adapted from <a class="reference external" href="https://github.com/tornadomeet/ResNet/blob/master/symbol_resnet.py">https://github.com/tornadomeet/ResNet/blob/master/symbol_resnet.py</a>
Original author Wei Wu</p>
<p>Implemented the following paper:</p>
<p>Kaiming He, Xiangyu Zhang, Shaoqing Ren, Jian Sun. “Identity Mappings in Deep Residual Networks”</p>
<dl class="py function">
<dt id="tvm.relay.testing.resnet.residual_unit">
<code class="sig-prename descclassname">tvm.relay.testing.resnet.</code><code class="sig-name descname">residual_unit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">num_filter</span></em>, <em class="sig-param"><span class="n">stride</span></em>, <em class="sig-param"><span class="n">dim_match</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">bottle_neck</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">data_layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em>, <em class="sig-param"><span class="n">kernel_layout</span><span class="o">=</span><span class="default_value">'IOHW'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.resnet.residual_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ResNet Unit symbol for building ResNet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Input data</p></li>
<li><p><strong>num_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of output channels</p></li>
<li><p><strong>bnf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Bottle neck channels factor with regard to num_filter</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – Stride used in convolution</p></li>
<li><p><strong>dim_match</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – True means channel number between input and output is the same,
otherwise means differ</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Base name of the operators</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.resnet.resnet">
<code class="sig-prename descclassname">tvm.relay.testing.resnet.</code><code class="sig-name descname">resnet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">units</span></em>, <em class="sig-param"><span class="n">num_stages</span></em>, <em class="sig-param"><span class="n">filter_list</span></em>, <em class="sig-param"><span class="n">num_classes</span></em>, <em class="sig-param"><span class="n">data_shape</span></em>, <em class="sig-param"><span class="n">bottle_neck</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.resnet.resnet" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ResNet Program.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – Number of units in each stage</p></li>
<li><p><strong>num_stages</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of stages</p></li>
<li><p><strong>filter_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – Channel size of each stage</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Ouput size of symbol</p></li>
<li><p><strong>data_shape</strong> (<em>tuple of int.</em>) – The shape of input data.</p></li>
<li><p><strong>bottle_neck</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether apply bottleneck transformation.</p></li>
<li><p><strong>layout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The data layout for conv2d</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The global data type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.resnet.get_net">
<code class="sig-prename descclassname">tvm.relay.testing.resnet.</code><code class="sig-name descname">get_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">num_classes</span></em>, <em class="sig-param"><span class="n">num_layers</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">3, 224, 224</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.resnet.get_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Adapted from <a class="reference external" href="https://github.com/tornadomeet/ResNet/blob/master/train_resnet.py">https://github.com/tornadomeet/ResNet/blob/master/train_resnet.py</a>
Original author Wei Wu</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.resnet.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.resnet.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">num_classes</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">num_layers</span><span class="o">=</span><span class="default_value">18</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">3, 224, 224</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.resnet.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Get benchmark workload for resnet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The batch size used in the model</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of classes</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of layers</p></li>
<li><p><strong>image_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The input image shape</p></li>
<li><p><strong>layout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The data layout for conv2d</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data type</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Extra arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains a ResNet network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.dcgan"></span><p>Net of the generator of DCGAN</p>
<p>Adopted from:
<a class="reference external" href="https://github.com/tqchen/mxnet-gan/blob/master/mxgan/generator.py">https://github.com/tqchen/mxnet-gan/blob/master/mxgan/generator.py</a></p>
<p>Reference:
Radford, Alec, Luke Metz, and Soumith Chintala.
“Unsupervised representation learning with deep convolutional generative adversarial networks.”
arXiv preprint arXiv:1511.06434 (2015).</p>
<dl class="py function">
<dt id="tvm.relay.testing.dcgan.deconv2d">
<code class="sig-prename descclassname">tvm.relay.testing.dcgan.</code><code class="sig-name descname">deconv2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">ishape</span></em>, <em class="sig-param"><span class="n">oshape</span></em>, <em class="sig-param"><span class="n">kshape</span></em>, <em class="sig-param"><span class="n">layout</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">stride</span><span class="o">=</span><span class="default_value">2, 2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.dcgan.deconv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>a deconv layer that enlarges the feature map</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.dcgan.deconv2d_bn_relu">
<code class="sig-prename descclassname">tvm.relay.testing.dcgan.</code><code class="sig-name descname">deconv2d_bn_relu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">prefix</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.dcgan.deconv2d_bn_relu" title="Permalink to this definition">¶</a></dt>
<dd><p>a block of deconv + batch norm + relu</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.dcgan.get_net">
<code class="sig-prename descclassname">tvm.relay.testing.dcgan.</code><code class="sig-name descname">get_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">random_len</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">oshape</span><span class="o">=</span><span class="default_value">3, 64, 64</span></em>, <em class="sig-param"><span class="n">ngf</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.dcgan.get_net" title="Permalink to this definition">¶</a></dt>
<dd><p>get net of dcgan generator</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.dcgan.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.dcgan.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">oshape</span><span class="o">=</span><span class="default_value">3, 64, 64</span></em>, <em class="sig-param"><span class="n">ngf</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">random_len</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.dcgan.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Get benchmark workload for a DCGAN generator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The batch size used in the model</p></li>
<li><p><strong>oshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The shape of output image, layout=”CHW”</p></li>
<li><p><strong>ngf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The number of final feature maps in the generator</p></li>
<li><p><strong>random_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The length of random input</p></li>
<li><p><strong>layout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The layout of conv2d transpose</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data type</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains a DCGAN network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.mobilenet"></span><p>Port of NNVM version of MobileNet to Relay.</p>
<dl class="py function">
<dt id="tvm.relay.testing.mobilenet.conv_block">
<code class="sig-prename descclassname">tvm.relay.testing.mobilenet.</code><code class="sig-name descname">conv_block</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">channels</span></em>, <em class="sig-param"><span class="n">kernel_size</span><span class="o">=</span><span class="default_value">3, 3</span></em>, <em class="sig-param"><span class="n">strides</span><span class="o">=</span><span class="default_value">1, 1</span></em>, <em class="sig-param"><span class="n">padding</span><span class="o">=</span><span class="default_value">1, 1</span></em>, <em class="sig-param"><span class="n">epsilon</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.mobilenet.conv_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to construct conv_bn-relu</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.mobilenet.separable_conv_block">
<code class="sig-prename descclassname">tvm.relay.testing.mobilenet.</code><code class="sig-name descname">separable_conv_block</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">depthwise_channels</span></em>, <em class="sig-param"><span class="n">pointwise_channels</span></em>, <em class="sig-param"><span class="n">kernel_size</span><span class="o">=</span><span class="default_value">3, 3</span></em>, <em class="sig-param"><span class="n">downsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">padding</span><span class="o">=</span><span class="default_value">1, 1</span></em>, <em class="sig-param"><span class="n">epsilon</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.mobilenet.separable_conv_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to get a separable conv block</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.mobilenet.mobile_net">
<code class="sig-prename descclassname">tvm.relay.testing.mobilenet.</code><code class="sig-name descname">mobile_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_classes</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">1, 3, 224, 224</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">is_shallow</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.mobilenet.mobile_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to construct a MobileNet</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.mobilenet.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.mobilenet.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">num_classes</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">3, 224, 224</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.mobilenet.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Get benchmark workload for mobilenet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The batch size used in the model</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of classes</p></li>
<li><p><strong>image_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The input image shape, cooperate with layout</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data type</p></li>
<li><p><strong>layout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data layout of image_shape and the operators
cooperate with image_shape</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains a MobileNet network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.lstm"></span><p>Implementation of a Long Short-Term Memory (LSTM) cell.</p>
<p>Adapted from:
<a class="reference external" href="https://gist.github.com/merrymercy/5eb24e3b019f84200645bd001e9caae9">https://gist.github.com/merrymercy/5eb24e3b019f84200645bd001e9caae9</a></p>
<dl class="py function">
<dt id="tvm.relay.testing.lstm.lstm_cell">
<code class="sig-prename descclassname">tvm.relay.testing.lstm.</code><code class="sig-name descname">lstm_cell</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_hidden</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.lstm.lstm_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Long-Short Term Memory (LSTM) network cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_hidden</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of units in output symbol.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Batch size (length of states).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – A Relay function that evaluates an LSTM cell.
The function takes in a tensor of input data, a tuple of two
states, and weights and biases for dense operations on the
inputs and on the state. It returns a tuple with two members,
an output tensor and a tuple of two new states.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#tvm.relay.Function" title="tvm.relay.Function">tvm.relay.Function</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.lstm.get_net">
<code class="sig-prename descclassname">tvm.relay.testing.lstm.</code><code class="sig-name descname">get_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iterations</span></em>, <em class="sig-param"><span class="n">num_hidden</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.lstm.get_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs an unrolled RNN with LSTM cells</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.lstm.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.lstm.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iterations</span></em>, <em class="sig-param"><span class="n">num_hidden</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.lstm.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Get benchmark workload for an LSTM RNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of iterations in the desired LSTM RNN.</p></li>
<li><p><strong>num_hidden</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The size of the hiddxen state</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em><em> (</em><em>default 1</em><em>)</em>) – The batch size used in the model</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em><em> (</em><em>default &quot;float32&quot;</em><em>)</em>) – The data type</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains a LSTM network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.inception_v3"></span><p>Inception V3, suitable for images with around 299 x 299</p>
<p>Reference:
Szegedy, Christian, et al. “Rethinking the Inception Architecture for Computer Vision.”
arXiv preprint arXiv:1512.00567 (2015).</p>
<dl class="simple">
<dt>Adopted from <a class="reference external" href="https://github.com/apache/incubator-mxnet/blob/">https://github.com/apache/incubator-mxnet/blob/</a></dt><dd><p>master/example/image-classification/symbols/inception-v3.py</p>
</dd>
</dl>
<dl class="py function">
<dt id="tvm.relay.testing.inception_v3.get_net">
<code class="sig-prename descclassname">tvm.relay.testing.inception_v3.</code><code class="sig-name descname">get_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">num_classes</span></em>, <em class="sig-param"><span class="n">image_shape</span></em>, <em class="sig-param"><span class="n">dtype</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.inception_v3.get_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Get network a Inception v3 network.</p>
<dl class="simple">
<dt>batch_size<span class="classifier">int</span></dt><dd><p>The batch size used in the model</p>
</dd>
<dt>num_classes<span class="classifier">int, optional</span></dt><dd><p>Number of claseses</p>
</dd>
<dt>image_shape<span class="classifier">tuple, optional</span></dt><dd><p>The input image shape</p>
</dd>
<dt>dtype<span class="classifier">str, optional</span></dt><dd><p>The data type</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>net</strong> – The dataflow.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="index.html#tvm.relay.Function" title="tvm.relay.Function">relay.Function</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.inception_v3.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.inception_v3.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">num_classes</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">3, 299, 299</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.inception_v3.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Get benchmark workload for InceptionV3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The batch size used in the model</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of classes</p></li>
<li><p><strong>image_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The input image shape</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data type</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains an Inception V3 network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.squeezenet"></span><p>Symbol of SqueezeNet</p>
<p>Reference:
Iandola, Forrest N., et al.
“Squeezenet: Alexnet-level accuracy with 50x fewer parameters and&lt; 0.5 mb model size.” (2016).</p>
<dl class="py function">
<dt id="tvm.relay.testing.squeezenet.get_net">
<code class="sig-prename descclassname">tvm.relay.testing.squeezenet.</code><code class="sig-name descname">get_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">image_shape</span></em>, <em class="sig-param"><span class="n">num_classes</span></em>, <em class="sig-param"><span class="n">version</span></em>, <em class="sig-param"><span class="n">dtype</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.squeezenet.get_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Get symbol of SqueezeNet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The batch size used in the model</p></li>
<li><p><strong>image_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The input image shape</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of classification results</p></li>
<li><p><strong>version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – “1.0” or “1.1” of SqueezeNet</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.squeezenet.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.squeezenet.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">num_classes</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">version</span><span class="o">=</span><span class="default_value">'1.0'</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">3, 224, 224</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.squeezenet.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Get benchmark workload for SqueezeNet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The batch size used in the model</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of classes</p></li>
<li><p><strong>version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – “1.0” or “1.1” of SqueezeNet</p></li>
<li><p><strong>image_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The input image shape</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data type</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains a SqueezeNet network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.vgg"></span><p>References:</p>
<p>Simonyan, Karen, and Andrew Zisserman. “Very deep convolutional networks for
large-scale image recognition.” arXiv preprint arXiv:1409.1556 (2014).</p>
<dl class="py function">
<dt id="tvm.relay.testing.vgg.get_feature">
<code class="sig-prename descclassname">tvm.relay.testing.vgg.</code><code class="sig-name descname">get_feature</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">internal_layer</span></em>, <em class="sig-param"><span class="n">layers</span></em>, <em class="sig-param"><span class="n">filters</span></em>, <em class="sig-param"><span class="n">batch_norm</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.vgg.get_feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Get VGG feature body as stacks of convoltions.</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.vgg.get_classifier">
<code class="sig-prename descclassname">tvm.relay.testing.vgg.</code><code class="sig-name descname">get_classifier</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_data</span></em>, <em class="sig-param"><span class="n">num_classes</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.vgg.get_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Get VGG classifier layers as fc layers.</p>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.vgg.get_net">
<code class="sig-prename descclassname">tvm.relay.testing.vgg.</code><code class="sig-name descname">get_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">image_shape</span></em>, <em class="sig-param"><span class="n">num_classes</span></em>, <em class="sig-param"><span class="n">dtype</span></em>, <em class="sig-param"><span class="n">num_layers</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">batch_norm</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.vgg.get_net" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The batch size used in the model</p></li>
<li><p><strong>image_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The input image shape</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of claseses</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data type</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of layers for the variant of vgg. Options are 11, 13, 16, 19.</p></li>
<li><p><strong>batch_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>default False</em>) – Use batch normalization.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.testing.vgg.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.vgg.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">num_classes</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">3, 224, 224</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em>, <em class="sig-param"><span class="n">num_layers</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">batch_norm</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.vgg.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Get benchmark workload for VGG nets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The batch size used in the model</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of claseses</p></li>
<li><p><strong>image_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – The input image shape</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The data type</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of layers for the variant of vgg. Options are 11, 13, 16, 19.</p></li>
<li><p><strong>batch_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Use batch normalization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains a VGG network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-tvm.relay.testing.densenet"></span><p>Port of MxNet version of Densenet to Relay.
<a class="reference external" href="https://github.com/apache/incubator-mxnet/blob/master/python/mxnet/gluon/model_zoo/vision/densenet.py">https://github.com/apache/incubator-mxnet/blob/master/python/mxnet/gluon/model_zoo/vision/densenet.py</a></p>
<dl class="py function">
<dt id="tvm.relay.testing.densenet.get_workload">
<code class="sig-prename descclassname">tvm.relay.testing.densenet.</code><code class="sig-name descname">get_workload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">densenet_size</span><span class="o">=</span><span class="default_value">121</span></em>, <em class="sig-param"><span class="n">classes</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">3, 224, 224</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float32'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.testing.densenet.get_workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets benchmark workload for densenet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>densenet_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em><em> (</em><em>default 121</em><em>)</em>) – Parameter for the network size. The supported sizes
are 121, 161, 169, and 201.</p></li>
<li><p><strong>classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em><em> (</em><em>default 1000</em><em>)</em>) – The number of classes.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em><em> (</em><em>detault 4</em><em>)</em>) – The batch size for the network.</p></li>
<li><p><strong>image_shape</strong> (<em>shape</em><em>, </em><em>optional</em><em> (</em><em>default</em><em> (</em><em>3</em><em>, </em><em>224</em><em>, </em><em>224</em><em>)</em><em>)</em>) – The shape of the input data.</p></li>
<li><p><strong>dtype</strong> (<em>data type</em><em>, </em><em>optional</em><em> (</em><em>default 'float32'</em><em>)</em>) – The data type of the input data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>tvm.IRModule</em>) – The relay module that contains a DenseNet network.</p></li>
<li><p><strong>params</strong> (<em>dict of str to NDArray</em>) – The benchmark paraeters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../autotvm.html" class="btn btn-neutral float-right" title="tvm.autotvm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dataflow_pattern.html" class="btn btn-neutral float-left" title="tvm.relay.dataflow_pattern" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Apache Software Foundation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-75982049-2', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>