

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tvm.relay.vision &mdash; tvm 0.8.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/tvm_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/tvm-logo-square.png"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="tvm.relay.image" href="image.html" />
    <link rel="prev" title="tvm.relay.nn" href="nn.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/tvm-logo-small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.8.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">How to</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute/index.html">Contribute to TVM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../deploy/index.html">Deploy and Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/how_to.html">Developer How-To Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Get Started Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#compile-deep-learning-models">Compile Deep Learning Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#tensor-expression-and-schedules">Tensor Expression and Schedules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#optimize-tensor-operators">Optimize Tensor Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#autotvm-template-based-auto-tuning">AutoTVM : Template-based Auto Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#autoscheduler-template-free-auto-scheduling">AutoScheduler : Template-free Auto Scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#developer-tutorials">Developer Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#topi-tvm-operator-inventory">TOPI: TVM Operator Inventory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html#micro-tvm">Micro TVM</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../langref/index.html">Language Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Python API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../runtime.html">tvm.runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ndarray.html">tvm.runtime.ndarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error.html">tvm.error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ir.html">tvm.ir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ir.html#module-tvm.transform">tvm.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../target.html">tvm.target</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir.html">tvm.tir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir.html#module-tvm.tir.transform">tvm.tir.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir.html#module-tvm.tir.analysis">tvm.tir.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir.html#module-tvm.tir.stmt_functor">tvm.tir.stmt_functor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../te.html">tvm.te</a></li>
<li class="toctree-l2"><a class="reference internal" href="../te.html#module-tvm.te.hybrid">tvm.te.hybrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../driver.html">tvm.driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html">tvm.relay</a></li>
<li class="toctree-l2"><a class="reference internal" href="frontend.html">tvm.relay.frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn.html">tvm.relay.nn</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">tvm.relay.vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="image.html">tvm.relay.image</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform.html">tvm.relay.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">tvm.relay.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="backend.html">tvm.relay.backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataflow_pattern.html">tvm.relay.dataflow_pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">tvm.relay.testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autotvm.html">tvm.autotvm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_scheduler.html">tvm.auto_scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rpc.html">tvm.rpc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../micro.html">tvm.micro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib.html">tvm.contrib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graph_runtime.html">tvm.contrib.graph_runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topi.html">tvm.topi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vta/index.html">vta</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../links.html">Links to Other API References</a></li>
</ul>
<p class="caption"><span class="caption-text">Deep Dive</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/index.html">Design and Architecture</a></li>
</ul>
<p class="caption"><span class="caption-text">MISC</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../vta/index.html">VTA: Deep Learning Accelerator Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../genindex.html">Index</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">tvm</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Python API</a> &raquo;</li>
        
      <li>tvm.relay.vision</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/api/python/relay/vision.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-tvm.relay.vision">
<span id="tvm-relay-vision"></span><h1>tvm.relay.vision<a class="headerlink" href="#module-tvm.relay.vision" title="Permalink to this headline">¶</a></h1>
<p>Vision network related operators.</p>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.vision.get_valid_counts" title="tvm.relay.vision.get_valid_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_valid_counts</span></code></a>(data, score_threshold[, …])</p></td>
<td><p>Get valid count of bounding boxes given a score threshold.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.vision.multibox_prior" title="tvm.relay.vision.multibox_prior"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multibox_prior</span></code></a>(data[, sizes, ratios, steps, …])</p></td>
<td><p>Generate prior(anchor) boxes from data, sizes and ratios.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.vision.multibox_transform_loc" title="tvm.relay.vision.multibox_transform_loc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multibox_transform_loc</span></code></a>(cls_prob, loc_pred, …)</p></td>
<td><p>Location transformation for multibox detection</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.vision.non_max_suppression" title="tvm.relay.vision.non_max_suppression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_max_suppression</span></code></a>(data, valid_count, indices)</p></td>
<td><p>Non-maximum suppression operator for object detection.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.vision.proposal" title="tvm.relay.vision.proposal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proposal</span></code></a>(cls_prob, bbox_pred, im_info, …)</p></td>
<td><p>Proposal operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.vision.roi_align" title="tvm.relay.vision.roi_align"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roi_align</span></code></a>(data, rois, pooled_size, spatial_scale)</p></td>
<td><p>ROI align operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tvm.relay.vision.roi_pool" title="tvm.relay.vision.roi_pool"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roi_pool</span></code></a>(data, rois, pooled_size, spatial_scale)</p></td>
<td><p>ROI pool operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tvm.relay.vision.yolo_reorg" title="tvm.relay.vision.yolo_reorg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">yolo_reorg</span></code></a>(data, stride)</p></td>
<td><p>Yolo reorg operation used in darknet models.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="tvm.relay.vision.get_valid_counts">
<code class="sig-prename descclassname">tvm.relay.vision.</code><code class="sig-name descname">get_valid_counts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">score_threshold</span></em>, <em class="sig-param"><span class="n">id_index</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">score_index</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.vision.get_valid_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get valid count of bounding boxes given a score threshold.
Also moves valid boxes to the top of input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>relay.Expr</em>) – Input data. 3-D tensor with shape [batch_size, num_anchors, 6].</p></li>
<li><p><strong>score_threshold</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Lower limit of score for valid bounding boxes.</p></li>
<li><p><strong>id_index</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – index of the class categories, -1 to disable.</p></li>
<li><p><strong>score_index</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the scores/confidence of boxes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>valid_count</strong> (<em>relay.Expr</em>) – 1-D tensor for valid number of boxes.</p></li>
<li><p><strong>out_tensor</strong> (<em>relay.Expr</em>) – Rearranged data tensor.</p></li>
<li><p><strong>out_indices</strong> (<em>relay.Expr</em>) – Indices in input data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.vision.multibox_prior">
<code class="sig-prename descclassname">tvm.relay.vision.</code><code class="sig-name descname">multibox_prior</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">sizes</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">ratios</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">steps</span><span class="o">=</span><span class="default_value">- 1.0, - 1.0</span></em>, <em class="sig-param"><span class="n">offsets</span><span class="o">=</span><span class="default_value">0.5, 0.5</span></em>, <em class="sig-param"><span class="n">clip</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.vision.multibox_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate prior(anchor) boxes from data, sizes and ratios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>relay.Expr</em>) – The input data tensor.</p></li>
<li><p><strong>sizes</strong> (<em>tuple of float</em><em>, </em><em>optional</em>) – Tuple of sizes for anchor boxes.</p></li>
<li><p><strong>ratios</strong> (<em>tuple of float</em><em>, </em><em>optional</em>) – Tuple of ratios for anchor boxes.</p></li>
<li><p><strong>steps</strong> (<em>Tuple of float</em><em>, </em><em>optional</em>) – Priorbox step across y and x, -1 for auto calculation.</p></li>
<li><p><strong>offsets</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – Priorbox center offsets, y and x respectively.</p></li>
<li><p><strong>clip</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to clip out-of-boundary boxes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – 3-D tensor with shape [1, h_in * w_in * (num_sizes + num_ratios - 1), 4]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>relay.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.vision.multibox_transform_loc">
<code class="sig-prename descclassname">tvm.relay.vision.</code><code class="sig-name descname">multibox_transform_loc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cls_prob</span></em>, <em class="sig-param"><span class="n">loc_pred</span></em>, <em class="sig-param"><span class="n">anchor</span></em>, <em class="sig-param"><span class="n">clip</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">variances</span><span class="o">=</span><span class="default_value">0.1, 0.1, 0.2, 0.2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.vision.multibox_transform_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Location transformation for multibox detection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_prob</strong> (<em>tvm.relay.Expr</em>) – Class probabilities.</p></li>
<li><p><strong>loc_pred</strong> (<em>tvm.relay.Expr</em>) – Location regression predictions.</p></li>
<li><p><strong>anchor</strong> (<em>tvm.relay.Expr</em>) – Prior anchor boxes.</p></li>
<li><p><strong>clip</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to clip out-of-boundary boxes.</p></li>
<li><p><strong>threshold</strong> (<em>double</em><em>, </em><em>optional</em>) – Threshold to be a positive prediction.</p></li>
<li><p><strong>variances</strong> (<em>Tuple of float</em><em>, </em><em>optional</em>) – variances to be decoded from box regression output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ret</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of tvm.relay.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.vision.non_max_suppression">
<code class="sig-prename descclassname">tvm.relay.vision.</code><code class="sig-name descname">non_max_suppression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">valid_count</span></em>, <em class="sig-param"><span class="n">indices</span></em>, <em class="sig-param"><span class="n">max_output_size</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">iou_threshold</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">force_suppress</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">top_k</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">coord_start</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">score_index</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">id_index</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">return_indices</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">invalid_to_bottom</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.vision.non_max_suppression" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-maximum suppression operator for object detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>relay.Expr</em>) – 3-D tensor with shape [batch_size, num_anchors, 6]
or [batch_size, num_anchors, 5].
The last dimension should be in format of
[class_id, score, box_left, box_top, box_right, box_bottom]
or [score, box_left, box_top, box_right, box_bottom]. It could
be the second output out_tensor of get_valid_counts.</p></li>
<li><p><strong>valid_count</strong> (<em>relay.Expr</em>) – 1-D tensor for valid number of boxes. It could be the output
valid_count of get_valid_counts.</p></li>
<li><p><strong>indices</strong> (<em>relay.Expr</em>) – 2-D tensor with shape [batch_size, num_anchors], represents
the index of box in original data. It could be the third
output out_indices of get_valid_counts. The values in the
second dimension are like the output of arange(num_anchors)
if get_valid_counts is not used before non_max_suppression.</p></li>
<li><p><strong>max_output_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>relay.Expr</em><em>, </em><em>optional</em>) – Max number of output valid boxes for each instance.
Return all valid boxes if the value of max_output_size is less than 0.</p></li>
<li><p><strong>iou_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Non-maximum suppression threshold.</p></li>
<li><p><strong>force_suppress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Suppress all detections regardless of class_id.</p></li>
<li><p><strong>top_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Keep maximum top k detections before nms, -1 for no limit.</p></li>
<li><p><strong>coord_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The starting index of the consecutive 4 coordinates.</p></li>
<li><p><strong>score_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Index of the scores/confidence of boxes.</p></li>
<li><p><strong>id_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – index of the class categories, -1 to disable.</p></li>
<li><p><strong>return_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return box indices in input data.</p></li>
<li><p><strong>invalid_to_bottom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to move all valid bounding boxes to the top.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – return relay.Expr if return_indices is disabled, a 3-D tensor
with shape [batch_size, num_anchors, 6] or [batch_size, num_anchors, 5].
If return_indices is True, return relay.Tuple of two 2-D tensors, with
shape [batch_size, num_anchors] and [batch_size, num_valid_anchors] respectively.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>relay.Expr or <a class="reference internal" href="index.html#tvm.relay.Tuple" title="tvm.relay.Tuple">relay.Tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.vision.proposal">
<code class="sig-prename descclassname">tvm.relay.vision.</code><code class="sig-name descname">proposal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cls_prob</span></em>, <em class="sig-param"><span class="n">bbox_pred</span></em>, <em class="sig-param"><span class="n">im_info</span></em>, <em class="sig-param"><span class="n">scales</span></em>, <em class="sig-param"><span class="n">ratios</span></em>, <em class="sig-param"><span class="n">feature_stride</span></em>, <em class="sig-param"><span class="n">threshold</span></em>, <em class="sig-param"><span class="n">rpn_pre_nms_top_n</span></em>, <em class="sig-param"><span class="n">rpn_post_nms_top_n</span></em>, <em class="sig-param"><span class="n">rpn_min_size</span></em>, <em class="sig-param"><span class="n">iou_loss</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.vision.proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Proposal operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_prob</strong> (<em>relay.Expr</em>) – 4-D tensor with shape [batch, 2 * num_anchors, height, width].</p></li>
<li><p><strong>bbox_pred</strong> (<em>relay.Expr</em>) – 4-D tensor with shape [batch, 4 * num_anchors, height, width].</p></li>
<li><p><strong>im_info</strong> (<em>relay.Expr</em>) – 2-D tensor with shape [batch, 3]. The last dimension should be in format of
[im_height, im_width, im_scale]</p></li>
<li><p><strong>scales</strong> (<em>list/tuple of float</em>) – Scales of anchor windows.</p></li>
<li><p><strong>ratios</strong> (<em>list/tuple of float</em>) – Ratios of anchor windows.</p></li>
<li><p><strong>feature_stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The size of the receptive field each unit in the convolution layer of the rpn, for example
the product of all stride’s prior to this layer.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Non-maximum suppression threshold.</p></li>
<li><p><strong>rpn_pre_nms_top_n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of top scoring boxes to apply NMS. -1 to use all boxes.</p></li>
<li><p><strong>rpn_post_nms_top_n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of top scoring boxes to keep after applying NMS to RPN proposals.</p></li>
<li><p><strong>rpn_min_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Minimum height or width in proposal.</p></li>
<li><p><strong>iou_loss</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Usage of IoU loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – 2-D tensor with shape [batch * rpn_post_nms_top_n, 5]. The last dimension is in format of
[batch_index, w_start, h_start, w_end, h_end].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>relay.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.vision.roi_align">
<code class="sig-prename descclassname">tvm.relay.vision.</code><code class="sig-name descname">roi_align</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">rois</span></em>, <em class="sig-param"><span class="n">pooled_size</span></em>, <em class="sig-param"><span class="n">spatial_scale</span></em>, <em class="sig-param"><span class="n">sample_ratio</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.vision.roi_align" title="Permalink to this definition">¶</a></dt>
<dd><p>ROI align operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>relay.Expr</em>) – 4-D tensor with shape [batch, channel, height, width]</p></li>
<li><p><strong>rois</strong> (<em>relay.Expr</em>) – 2-D tensor with shape [num_roi, 5]. The last dimension should be in format of
[batch_index, w_start, h_start, w_end, h_end]</p></li>
<li><p><strong>pooled_size</strong> (<em>list/tuple of two ints</em>) – output size</p></li>
<li><p><strong>spatial_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Ratio of input feature map height (or w) to raw image height (or w). Equals the reciprocal
of total stride in convolutional layers, which should be in range (0.0, 1.0]</p></li>
<li><p><strong>sample_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Optional sampling ratio of ROI align, using adaptive size by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – 4-D tensor with shape [num_roi, channel, pooled_size, pooled_size]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>relay.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.vision.roi_pool">
<code class="sig-prename descclassname">tvm.relay.vision.</code><code class="sig-name descname">roi_pool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">rois</span></em>, <em class="sig-param"><span class="n">pooled_size</span></em>, <em class="sig-param"><span class="n">spatial_scale</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'NCHW'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.vision.roi_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>ROI pool operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>relay.Expr</em>) – 4-D tensor with shape [batch, channel, height, width]</p></li>
<li><p><strong>rois</strong> (<em>relay.Expr</em>) – 2-D tensor with shape [num_roi, 5]. The last dimension should be in format of
[batch_index, w_start, h_start, w_end, h_end]</p></li>
<li><p><strong>pooled_size</strong> (<em>list/tuple of two ints</em>) – output size</p></li>
<li><p><strong>spatial_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Ratio of input feature map height (or w) to raw image height (or w). Equals the reciprocal
of total stride in convolutional layers, which should be in range (0.0, 1.0]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – 4-D tensor with shape [num_roi, channel, pooled_size, pooled_size]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>relay.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tvm.relay.vision.yolo_reorg">
<code class="sig-prename descclassname">tvm.relay.vision.</code><code class="sig-name descname">yolo_reorg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">stride</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relay.vision.yolo_reorg" title="Permalink to this definition">¶</a></dt>
<dd><p>Yolo reorg operation used in darknet models.
This layer shuffles the input tensor values based on the stride value.
Along with the shuffling, it does the shape transform.
If ‘(n, c, h, w)’ is the data shape and ‘s’ is stride, output shape is ‘(n, c*s*s, h/s, w/s)’.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span class="n">data</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[[[</span> <span class="mi">0</span>  <span class="mi">1</span><span class="p">]</span> <span class="p">[</span> <span class="mi">2</span>  <span class="mi">3</span><span class="p">]]</span>
                    <span class="p">[[</span> <span class="mi">4</span>  <span class="mi">5</span><span class="p">]</span> <span class="p">[</span> <span class="mi">6</span>  <span class="mi">7</span><span class="p">]]</span>
                    <span class="p">[[</span> <span class="mi">8</span>  <span class="mi">9</span><span class="p">]</span> <span class="p">[</span><span class="mi">10</span> <span class="mi">11</span><span class="p">]]</span>
                    <span class="p">[[</span><span class="mi">12</span> <span class="mi">13</span><span class="p">]</span> <span class="p">[</span><span class="mi">14</span> <span class="mi">15</span><span class="p">]]]]</span>
<span class="n">stride</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ret</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[[[</span> <span class="mi">0</span><span class="p">]]</span>  <span class="p">[[</span> <span class="mi">2</span><span class="p">]]</span>  <span class="p">[[</span> <span class="mi">8</span><span class="p">]]</span>  <span class="p">[[</span><span class="mi">10</span><span class="p">]]</span>
                    <span class="p">[[</span> <span class="mi">1</span><span class="p">]]</span>  <span class="p">[[</span> <span class="mi">3</span><span class="p">]]</span>  <span class="p">[[</span> <span class="mi">9</span><span class="p">]]</span>  <span class="p">[[</span><span class="mi">11</span><span class="p">]]</span>
                    <span class="p">[[</span> <span class="mi">4</span><span class="p">]]</span>  <span class="p">[[</span> <span class="mi">6</span><span class="p">]]</span>  <span class="p">[[</span><span class="mi">12</span><span class="p">]]</span>  <span class="p">[[</span><span class="mi">14</span><span class="p">]]</span>
                    <span class="p">[[</span> <span class="mi">5</span><span class="p">]]</span>  <span class="p">[[</span> <span class="mi">7</span><span class="p">]]</span>  <span class="p">[[</span><span class="mi">13</span><span class="p">]]</span>  <span class="p">[[</span><span class="mi">15</span><span class="p">]]]]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>stride=1 has no significance for reorg operation.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>relay.Expr</em>) – The input data tensor.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The stride value for reorganisation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ret</strong> – The computed result.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>relay.Expr</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="image.html" class="btn btn-neutral float-right" title="tvm.relay.image" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="nn.html" class="btn btn-neutral float-left" title="tvm.relay.nn" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Apache Software Foundation

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-75982049-2', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>