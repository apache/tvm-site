<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tvm: include/tvm/relax/distributed/axis_group_graph.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tvm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b4c7d8e826c599ba55146c099a14beb5.html">tvm</a></li><li class="navelem"><a class="el" href="dir_039190d3b4246b6bdd648b90e06580e6.html">relax</a></li><li class="navelem"><a class="el" href="dir_bf4427a179fefdc4a587f4cf388c9e87.html">distributed</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">axis_group_graph.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="iter__affine__map_8h_source.html">tvm/arith/iter_affine_map.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="distributed_2struct__info_8h_source.html">tvm/relax/distributed/struct_info.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="relax_2expr_8h_source.html">tvm/relax/expr.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="tir_2function_8h_source.html">tvm/tir/function.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="stmt__functor_8h_source.html">tvm/tir/stmt_functor.h</a>&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;tuple&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;unordered_set&gt;</code><br />
<code>#include &lt;utility&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for axis_group_graph.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="axis__group__graph_8h__incl.svg" width="7984" height="2036"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="axis__group__graph_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1tir_1_1BufferAxisHash.html">tvm::tir::BufferAxisHash</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1tir_1_1BufferAxisGraphExtractor.html">tvm::tir::BufferAxisGraphExtractor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct an axis group graph from a <a class="el" href="classtvm_1_1tir_1_1PrimFunc.html" title="Managed reference to PrimFuncNode.">PrimFunc</a>. Two buffer axis are connected if they are accessed by the same index.  <a href="classtvm_1_1tir_1_1BufferAxisGraphExtractor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtvm_1_1relax_1_1distributed_1_1Axis.html">tvm::relax::distributed::Axis</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">tensor axis  <a href="structtvm_1_1relax_1_1distributed_1_1Axis.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1relax_1_1distributed_1_1AxisHash.html">tvm::relax::distributed::AxisHash</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1relax_1_1distributed_1_1AxisGroupHash.html">tvm::relax::distributed::AxisGroupHash</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1relax_1_1distributed_1_1AxisShardingSpecEqual.html">tvm::relax::distributed::AxisShardingSpecEqual</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1relax_1_1distributed_1_1AxisShardingSpecHash.html">tvm::relax::distributed::AxisShardingSpecHash</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1relax_1_1distributed_1_1AxisGroupGraph.html">tvm::relax::distributed::AxisGroupGraph</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A graph whose nodes are tensor axes, and the edge means some information can be propagated through the two axes. Although it only does sharding propagation, this data structure can be extended to perform all kinds of propagation that happens on tensor axes.  <a href="classtvm_1_1relax_1_1distributed_1_1AxisGroupGraph.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacetvm"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm.html">tvm</a></td></tr>
<tr class="memdesc:namespacetvm"><td class="mdescLeft">&#160;</td><td class="mdescRight">runtime implementation for LibTorch/TorchScript. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacetvm_1_1tir"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1tir.html">tvm::tir</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacetvm_1_1relax"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax.html">tvm::relax</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacetvm_1_1relax_1_1distributed"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html">tvm::relax::distributed</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:adae6fba969a8ae541944301374b70927"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1tir.html#adae6fba969a8ae541944301374b70927">tvm::tir::TIRVarAxis</a> = std::pair&lt; Var, int &gt;</td></tr>
<tr class="separator:adae6fba969a8ae541944301374b70927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a513e456de71660e7af137e15549998f1"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1tir.html#a513e456de71660e7af137e15549998f1">tvm::tir::BufferAxis</a> = std::pair&lt; Buffer, int &gt;</td></tr>
<tr class="separator:a513e456de71660e7af137e15549998f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56b93fc9f726d6abaa0a0e7149ed915f"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#a56b93fc9f726d6abaa0a0e7149ed915f">tvm::relax::distributed::AxisGroup</a> = std::unordered_set&lt; Axis, AxisHash &gt;</td></tr>
<tr class="separator:a56b93fc9f726d6abaa0a0e7149ed915f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83820b6820d475d9e64f6fe11e3b261"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#af83820b6820d475d9e64f6fe11e3b261">tvm::relax::distributed::ShardingSpec</a> = std::pair&lt; DeviceMesh, Placement &gt;</td></tr>
<tr class="separator:af83820b6820d475d9e64f6fe11e3b261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f85ef8cbcb42c73af66d468edb2d86"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#a91f85ef8cbcb42c73af66d468edb2d86">tvm::relax::distributed::AxisShardingSpec</a> = std::pair&lt; DeviceMesh, int &gt;</td></tr>
<tr class="separator:a91f85ef8cbcb42c73af66d468edb2d86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df05fae63bde04ab5312e0c17dd2941"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#a8df05fae63bde04ab5312e0c17dd2941">tvm::relax::distributed::FBuildAxisGraph</a> = std::function&lt; void(const Var &amp;output_var, const Call &amp;call, distributed::AxisGroupGraph *axis_group_graph)&gt;</td></tr>
<tr class="separator:a8df05fae63bde04ab5312e0c17dd2941"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a66bcb1b2f70d51f7d726c5ac1839efe8"><td class="memItemLeft" align="right" valign="top">Var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1tir.html#a66bcb1b2f70d51f7d726c5ac1839efe8">tvm::tir::GetShardingVarFromIndex</a> (PrimExpr index, Map&lt; Var, Range &gt; var_range, arith::Analyzer *analyzer)</td></tr>
<tr class="memdesc:a66bcb1b2f70d51f7d726c5ac1839efe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suppose we want to shard a buffer along a specific dimension, we need to know how to rewrite the access index of the buffer. To make it simple, we only support the case that the access can be rewritten by changing the extent of an iter var.  <a href="namespacetvm_1_1tir.html#a66bcb1b2f70d51f7d726c5ac1839efe8">More...</a><br /></td></tr>
<tr class="separator:a66bcb1b2f70d51f7d726c5ac1839efe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f5144f8b55b6c50c6cc8661a32f9045"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#a6f5144f8b55b6c50c6cc8661a32f9045">tvm::relax::distributed::BuildAxisGraphUnary</a> (const Var &amp;output_var, const Call &amp;call, distributed::AxisGroupGraph *axis_group_graph)</td></tr>
<tr class="separator:a6f5144f8b55b6c50c6cc8661a32f9045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a439ec1cbbc7bed014def33d39b0ab55d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#a439ec1cbbc7bed014def33d39b0ab55d">tvm::relax::distributed::BuildAxisGraphBinary</a> (const Var &amp;output_var, const Call &amp;call, distributed::AxisGroupGraph *axis_group_graph)</td></tr>
<tr class="separator:a439ec1cbbc7bed014def33d39b0ab55d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b69a84dc2f0467335bf16dfdc50e37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#ae8b69a84dc2f0467335bf16dfdc50e37">tvm::relax::distributed::BuildAxisGraphReduce</a> (const Var &amp;output_var, const Call &amp;call, distributed::AxisGroupGraph *axis_group_graph)</td></tr>
<tr class="separator:ae8b69a84dc2f0467335bf16dfdc50e37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a925bb8a17ff87e10e26c69aaa8ac0c99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#a925bb8a17ff87e10e26c69aaa8ac0c99">tvm::relax::distributed::BuildAxisGraphMatmul</a> (const Var &amp;output_var, const Call &amp;call, distributed::AxisGroupGraph *axis_group_graph)</td></tr>
<tr class="separator:a925bb8a17ff87e10e26c69aaa8ac0c99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6f09e7a4357e53771d0dafe048faba2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#af6f09e7a4357e53771d0dafe048faba2">tvm::relax::distributed::BuildAxisGraphPermuteDims</a> (const Var &amp;output_var, const Call &amp;call, distributed::AxisGroupGraph *axis_group_graph)</td></tr>
<tr class="separator:af6f09e7a4357e53771d0dafe048faba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa6c68749f26cce4555aa31bfdb1314"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#aaaa6c68749f26cce4555aa31bfdb1314">tvm::relax::distributed::BuildAxisGraphReshape</a> (const Var &amp;output_var, const Call &amp;call, distributed::AxisGroupGraph *axis_group_graph)</td></tr>
<tr class="separator:aaaa6c68749f26cce4555aa31bfdb1314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a839ea4126395c83461552272d3211ef4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1relax_1_1distributed.html#a839ea4126395c83461552272d3211ef4">tvm::relax::distributed::BuildAxisGraphCallTIR</a> (const Var &amp;output_var, const Call &amp;call, const tir::PrimFunc &amp;func, distributed::AxisGroupGraph *axis_group_graph)</td></tr>
<tr class="separator:a839ea4126395c83461552272d3211ef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
