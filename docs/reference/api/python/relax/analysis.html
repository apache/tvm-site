



<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tvm.relax.analysis &mdash; tvm 0.24.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/downloads/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/tlcpack_theme.css" type="text/css" />

  
  

  
  
  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=0bc77288"></script>
        <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <script type="text/javascript" src="../../../../_static/js/tlcpack_theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="tvm.relax.block_builder" href="block_builder.html" />
    <link rel="prev" title="tvm.relax" href="relax.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    
<header class="header">
    <div class="innercontainer">
      <div class="headerInner d-flex justify-content-between align-items-center">
          <div class="headerLogo">
               <a href="https://tvm.apache.org/"><img src=https://tvm.apache.org/assets/images/logo.svg alt="logo"></a>
          </div>

          <div id="headMenu" class="headerNav">
            <button type="button" id="closeHeadMenu" class="navCloseBtn"><img src="../../../../_static/img/close-icon.svg" alt="Close"></button>
             <ul class="nav">
                <li class="nav-item">
                   <a class="nav-link" href=https://tvm.apache.org/community>Community</a>
                </li>
                <li class="nav-item">
                   <a class="nav-link" href=https://tvm.apache.org/download>Download</a>
                </li>
                <li class="nav-item">
                   <a class="nav-link" href=https://tvm.apache.org/docs>Docs</a>
                </li>
                <li class="nav-item">
                   <a class="nav-link" href=https://github.com/apache/tvm/>Github</a>
                </li>
             </ul>
               <div class="responsivetlcdropdown">
                 <button type="button" class="btn-link">
                   ASF
                 </button>
                 <ul>
                     <li>
                       <a href=https://apache.org/>Apache Homepage</a>
                     </li>
                     <li>
                       <a href=https://www.apache.org/licenses/>License</a>
                     </li>
                     <li>
                       <a href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a>
                     </li>
                     <li>
                       <a href=https://tvm.apache.org/docs/reference/security.html>Security</a>
                     </li>
                     <li>
                       <a href=https://www.apache.org/foundation/thanks.html>Thanks</a>
                     </li>
                     <li>
                       <a href=https://www.apache.org/events/current-event>Events</a>
                     </li>
                 </ul>
               </div>
          </div>
            <div class="responsiveMenuIcon">
              <button type="button" id="menuBtn" class="btn-menu"><img src="../../../../_static/img/menu-icon.svg" alt="Menu Icon"></button>
            </div>

            <div class="tlcDropdown">
              <div class="dropdown">
                <button type="button" class="btn-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  ASF
                </button>
                <div class="dropdown-menu dropdown-menu-right">
                  <ul>
                     <li>
                       <a href=https://apache.org/>Apache Homepage</a>
                     </li>
                     <li>
                       <a href=https://www.apache.org/licenses/>License</a>
                     </li>
                     <li>
                       <a href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a>
                     </li>
                     <li>
                       <a href=https://tvm.apache.org/docs/reference/security.html>Security</a>
                     </li>
                     <li>
                       <a href=https://www.apache.org/foundation/thanks.html>Thanks</a>
                     </li>
                     <li>
                       <a href=https://www.apache.org/events/current-event>Events</a>
                     </li>
                  </ul>
                </div>
              </div>
          </div>
       </div>
    </div>
 </header>
 
    <nav data-toggle="wy-nav-shift" class="wy-nav-side fixed">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="sidetitle" alt="Documentation Home"> tvm
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../get_started/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../install/index.html">Installing TVM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../get_started/tutorials/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../get_started/tutorials/ir_module.html">IRModule</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How To</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/tutorials/e2e_opt_model.html">End-to-End Optimize Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/tutorials/customize_opt.html">Customize Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/tutorials/optimize_llm.html">Optimize Large Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/tutorials/cross_compilation_and_rpc.html">Cross Compilation and RPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/tutorials/export_and_load_executable.html">Export and Load Relax Executables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/dev/index.html">Development Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deep Dive</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../arch/index.html">Design and Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../deep_dive/tensor_ir/index.html">TensorIR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../deep_dive/relax/index.html">Relax</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Python API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../error.html">tvm.error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ir.html">tvm.ir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../instrument.html">tvm.instrument</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform.html">tvm.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../target.html">tvm.target</a></li>
<li class="toctree-l2"><a class="reference internal" href="../driver.html">tvm.driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runtime/runtime.html">tvm.runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runtime/vm.html">tvm.runtime.vm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runtime/disco.html">tvm.runtime.disco</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runtime/profiling.html">tvm.runtime.profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="relax.html">tvm.relax</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">tvm.relax.analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.BaseCheckResult"><code class="docutils literal notranslate"><span class="pre">BaseCheckResult</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.all_global_vars"><code class="docutils literal notranslate"><span class="pre">all_global_vars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.all_vars"><code class="docutils literal notranslate"><span class="pre">all_vars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.bound_vars"><code class="docutils literal notranslate"><span class="pre">bound_vars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.collect_non_negative_expressions"><code class="docutils literal notranslate"><span class="pre">collect_non_negative_expressions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.computable_at_compile_time"><code class="docutils literal notranslate"><span class="pre">computable_at_compile_time()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.contains_impure_call"><code class="docutils literal notranslate"><span class="pre">contains_impure_call()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.definable_tir_vars_in_struct_info"><code class="docutils literal notranslate"><span class="pre">definable_tir_vars_in_struct_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.defined_symbolic_vars"><code class="docutils literal notranslate"><span class="pre">defined_symbolic_vars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.derive_call_ret_struct_info"><code class="docutils literal notranslate"><span class="pre">derive_call_ret_struct_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.detect_recursion"><code class="docutils literal notranslate"><span class="pre">detect_recursion()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.erase_to_well_defined"><code class="docutils literal notranslate"><span class="pre">erase_to_well_defined()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.free_symbolic_vars"><code class="docutils literal notranslate"><span class="pre">free_symbolic_vars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.free_vars"><code class="docutils literal notranslate"><span class="pre">free_vars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.get_static_type"><code class="docutils literal notranslate"><span class="pre">get_static_type()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.used_vars"><code class="docutils literal notranslate"><span class="pre">used_vars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.get_var2val"><code class="docutils literal notranslate"><span class="pre">get_var2val()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.has_reshape_pattern"><code class="docutils literal notranslate"><span class="pre">has_reshape_pattern()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.name_to_binding"><code class="docutils literal notranslate"><span class="pre">name_to_binding()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.post_order_visit"><code class="docutils literal notranslate"><span class="pre">post_order_visit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.remove_all_unused"><code class="docutils literal notranslate"><span class="pre">remove_all_unused()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.struct_info_base_check"><code class="docutils literal notranslate"><span class="pre">struct_info_base_check()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.struct_info_lca"><code class="docutils literal notranslate"><span class="pre">struct_info_lca()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.suggest_layout_transforms"><code class="docutils literal notranslate"><span class="pre">suggest_layout_transforms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.tir_vars_in_struct_info"><code class="docutils literal notranslate"><span class="pre">tir_vars_in_struct_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.udchain"><code class="docutils literal notranslate"><span class="pre">udchain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.well_formed"><code class="docutils literal notranslate"><span class="pre">well_formed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tvm.relax.analysis.estimate_memory_usage"><code class="docutils literal notranslate"><span class="pre">estimate_memory_usage()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="block_builder.html">tvm.relax.block_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="frontend.html">tvm.relax.frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="op.html">tvm.relax.op</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform.html">tvm.relax.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir/tir.html">tvm.tir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir/analysis.html">tvm.tir.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir/stmt_functor.html">tvm.tir.stmt_functor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tir/transform.html">tvm.tir.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../s_tir/schedule.html">tvm.s_tir.schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../s_tir/dlight.html">tvm.s_tir.dlight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../te.html">tvm.te</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topi.html">tvm.topi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../meta_schedule.html">tvm.s_tir.meta_schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rpc.html">tvm.rpc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib.html">tvm.contrib</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../links.html">Other APIs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../contribute/index.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Index</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">Index</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      
      <nav class="wy-nav-top" aria-label="top navigation" data-toggle="wy-nav-top">
        
            <div class="togglemenu">

            </div>
            <div class="nav-content">
              <!-- tvm -->
              Table of Contents
            </div>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        

          




















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> <span class="br-arrow">></span></li>
        
          <li><a href="../index.html">Python API</a> <span class="br-arrow">></span></li>
        
      <li>tvm.relax.analysis</li>
    
    
      
      
        
      
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/tvm/edit/main/docs/reference/api/python/relax/analysis.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="module-tvm.relax.analysis">
<span id="tvm-relax-analysis"></span><h1>tvm.relax.analysis<a class="headerlink" href="#module-tvm.relax.analysis" title="Link to this heading"></a></h1>
<p>Relax IR analysis.</p>
<dl class="py class">
<dt class="sig sig-object py" id="tvm.relax.analysis.BaseCheckResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">BaseCheckResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relax.analysis.BaseCheckResult" title="Link to this definition"></a></dt>
<dd><p>Return result of fine-grained base check.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Base check comes with fine-grained fail levels.</p>
<ul class="simple">
<li><p>FAIL_L0: The lhs and rhs have no intersection at all.</p></li>
<li><p>FAIL_L1: We get the failure by looking at static information.</p></li>
<li><p>FAIL_L2: We get the failure due to unknown symbolic variable relations.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.all_global_vars">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">all_global_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.RelaxExpr" title="tvm.ir.expr.RelaxExpr"><span class="pre">RelaxExpr</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../ir.html#tvm.ir.GlobalVar" title="tvm.ir.expr.GlobalVar"><span class="pre">GlobalVar</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.all_global_vars" title="Link to this definition"></a></dt>
<dd><p>Return all global variables from expression expr.
:param expr: The expression.
:type expr: Expr</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ret</strong> – List of global vars in expr, in post-DFS order</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[<a class="reference internal" href="../ir.html#tvm.ir.GlobalVar" title="tvm.ir.GlobalVar">GlobalVar</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.all_vars">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">all_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.RelaxExpr" title="tvm.ir.expr.RelaxExpr"><span class="pre">RelaxExpr</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.all_vars" title="Link to this definition"></a></dt>
<dd><p>Return all (local) variables from expression expr.
:param expr: The expression.
:type expr: Expr</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ret</strong> – List of vars in expr, in post-DFS order</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.bound_vars">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">bound_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.RelaxExpr" title="tvm.ir.expr.RelaxExpr"><span class="pre">RelaxExpr</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.bound_vars" title="Link to this definition"></a></dt>
<dd><p>Return all bound variables from expression expr.
Bound variables are all variables that are declared in the expr.
They only have meaning inside that expr, and can only be used in it.
:param expr: The expression.
:type expr: Expr</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ret</strong> – List of bound vars in expr, in post-DFS order</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.collect_non_negative_expressions">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">collect_non_negative_expressions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sinfo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../ir.html#tvm.ir.PrimExpr" title="tvm.ir.expr.PrimExpr"><span class="pre">PrimExpr</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.collect_non_negative_expressions" title="Link to this definition"></a></dt>
<dd><p>Collect TIR expressions used in non-negative contexts</p>
<p>Get TIR variables that are non-negative within the context where
the struct info is used.  For example, any expression used as a
tensor shape.</p>
<p>The returned list is deduplicated - each TIR expression will
appear at most once.  The order of the list is in the order of
occurrence within the struct info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sinfo</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The struct info object to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The list of TIR variables that can be defined from the StructInfo</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="../tir/tir.html#tvm.tir.Var" title="tvm.tir.Var">tir.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.computable_at_compile_time">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">computable_at_compile_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.computable_at_compile_time" title="Link to this definition"></a></dt>
<dd><p>Collect variables whose value can be computed at compile-time</p>
<p>If a function has the <cite>kNumInput</cite> attribute, then the first
<cite>kNumInput</cite> parameters are provided at run-time, while all
remaining parameters may be known at compile-time.  This utility
collects all variable bindings that only depend, directly or
indirectly, on the parameters known at compile-time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.Function"><em>Function</em></a>) – The <cite>relax.Function</cite> to analyze</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The set of variables that can be computed at compile-time, in
order of their occurrence within the function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.contains_impure_call">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">contains_impure_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.RelaxExpr" title="tvm.ir.expr.RelaxExpr"><span class="pre">RelaxExpr</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">own_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../ir.html#tvm.ir.GlobalVar" title="tvm.ir.expr.GlobalVar"><span class="pre">GlobalVar</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.contains_impure_call" title="Link to this definition"></a></dt>
<dd><p>Check if the given expression (likely a function body) contains any impure calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>Expr</em>) – The expression to be examined. If expr is a function, we check the body.</p></li>
<li><p><strong>own_name</strong> (<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var"><em>relax.Var</em></a><em> or </em><a class="reference internal" href="../ir.html#tvm.ir.GlobalVar" title="tvm.ir.GlobalVar"><em>GlobalVar</em></a><em> (</em><em>optional</em><em>)</em>) – For a recursive function, the analysis can ignore the self-calls
for checking purity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – True if there is an impure call
(call to a function that may have visible side effects).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Relies on StructInfo annotations, so ensure that the module has been normalized first.
Also, an impure call in a <em>nested</em> function does <em>not</em> mean that the outer expression contains
an impure call–it only does if the nested function is <em>later called</em>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.definable_tir_vars_in_struct_info">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">definable_tir_vars_in_struct_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sinfo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../tir/tir.html#tvm.tir.Var" title="tvm.tir.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.definable_tir_vars_in_struct_info" title="Link to this definition"></a></dt>
<dd><p>Get the TIR variables that may be defined from input struct info.
The returned list is deduplicated - each TIR variable will appear at most once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sinfo</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The struct info object to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The list of TIR variables that can be defined from the StructInfo</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="../tir/tir.html#tvm.tir.Var" title="tvm.tir.Var">tir.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.defined_symbolic_vars">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">defined_symbolic_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.defined_symbolic_vars" title="Link to this definition"></a></dt>
<dd><p>Get the TIR variables that defined in the input function.
The returned list is deduplicated - each TIR variable will appear at most once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.Function"><em>Function</em></a>) – The function object to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The list of symbolic variables that are defined in the input function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.derive_call_ret_struct_info">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">derive_call_ret_struct_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_sinfo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.FuncStructInfo" title="tvm.relax.struct_info.FuncStructInfo"><span class="pre">FuncStructInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">call</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.Call" title="tvm.relax.expr.Call"><span class="pre">Call</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="block_builder.html#tvm.relax.block_builder.BlockBuilder" title="tvm.relax.block_builder.BlockBuilder"><span class="pre">BlockBuilder</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.derive_call_ret_struct_info" title="Link to this definition"></a></dt>
<dd><p>Derive the call’s ret value struct info from inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func_sinfo</strong> (<a class="reference internal" href="relax.html#tvm.relax.FuncStructInfo" title="tvm.relax.FuncStructInfo"><em>FuncStructInfo</em></a>) – The call’s function signature.</p></li>
<li><p><strong>call</strong> (<a class="reference internal" href="relax.html#tvm.relax.Call" title="tvm.relax.Call"><em>relax.Call</em></a>) – The call expression</p></li>
<li><p><strong>ctx</strong> (<em>tvm.relax.BlockBuilder</em>) – The context block builder.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The derived return value struct info.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo">StructInfo</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an internal derivation function, call.op field is
ignored in this case and the derivation only depends on func_sinfo.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.detect_recursion">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">detect_recursion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.IRModule" title="tvm.ir.module.IRModule"><span class="pre">IRModule</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../ir.html#tvm.ir.GlobalVar" title="tvm.ir.expr.GlobalVar"><span class="pre">GlobalVar</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.detect_recursion" title="Link to this definition"></a></dt>
<dd><p>Find all sets of recursive or mutually recursive functions in the module.</p>
<p>Two or more functions are mutually recursive if there is some cycle of references
among them. For example, if there are two functions A and B, they are
mutually recursive if A calls B and B calls A. Another case would be with
three functions A, B, and C, where A calls B, B calls C, and C calls A.</p>
<p>(Note that functions do not have to call each other to reference each other.
For example, if a function returns another function, that is still a reference
that could potentially be recursive, even without a call.)</p>
<p>If a function is simply recursive and not mutually recursive with any other,
it will be reported as a group by itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mod</strong> (<em>The module</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – Each member of the list is a list of global functions
that references each other mutually recursively.
If a function is simply recursive and not mutually recursive
with any other, it will be a singleton in this list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[<a class="reference internal" href="../ir.html#tvm.ir.GlobalVar" title="tvm.ir.GlobalVar">GlobalVar</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.erase_to_well_defined">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">erase_to_well_defined</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sinfo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_var_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../tir/tir.html#tvm.tir.Var" title="tvm.tir.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../ir.html#tvm.ir.PrimExpr" title="tvm.ir.expr.PrimExpr"><span class="pre">PrimExpr</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../ir.html#tvm.ir.RelaxExpr" title="tvm.ir.expr.RelaxExpr"><span class="pre">RelaxExpr</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.erase_to_well_defined" title="Link to this definition"></a></dt>
<dd><p>Erase sinfo into a well defined form.</p>
<p>This function removes the StructInfo’s dependencies on shape and vars that
are not defined in given maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sinfo</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The input struct info.</p></li>
<li><p><strong>shape_var_map</strong> (<em>Dict</em><em>[</em><a class="reference internal" href="../tir/tir.html#tvm.tir.Var" title="tvm.tir.Var"><em>tir.Var</em></a><em>, </em><em>tir.PrimExpr</em><em>]</em>) – Specifies the defined shape vars and the values they should map to.</p></li>
<li><p><strong>var_map</strong> (<em>Dict</em><em>[</em><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var"><em>relax.Var</em></a><em>, </em><em>Expr</em><em>]</em>) – Specifies the defined vars and the values they should map to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The corresponding erased struct info.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo">StructInfo</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.free_symbolic_vars">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">free_symbolic_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.free_symbolic_vars" title="Link to this definition"></a></dt>
<dd><p>Get the TIR variables that are used but not defined in the input function.
The returned list is deduplicated - each TIR variable will appear at most once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.Function"><em>Function</em></a>) – The function object to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The list of symbolic variables that are used but not defined in the input function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.free_vars">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">free_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.RelaxExpr" title="tvm.ir.expr.RelaxExpr"><span class="pre">RelaxExpr</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.free_vars" title="Link to this definition"></a></dt>
<dd><p>Return all free variables from expression expr.
Free variables are variables that are not bound by a
VarBinding or a function parameter in the expression.
:param expr: The expression.
:type expr: Expr</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ret</strong> – List of free vars in expr, in post-DFS order</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.get_static_type">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">get_static_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sinfo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../ir.html#tvm.ir.Type" title="tvm.ir.type.Type"><span class="pre">Type</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.get_static_type" title="Link to this definition"></a></dt>
<dd><p>Get the corresponding static type from a StructInfo.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sinfo</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The input struct info.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The corresponding static type.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../ir.html#tvm.ir.Type" title="tvm.ir.Type">Type</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.used_vars">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">used_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.RelaxExpr" title="tvm.ir.expr.RelaxExpr"><span class="pre">RelaxExpr</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.used_vars" title="Link to this definition"></a></dt>
<dd><p>Return all variables used in an expression.</p>
<p>This function collects all variable references within the given expression,
which is useful for analyzing variable dependencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>expr</strong> (<em>Expr</em>) – The expression to analyze.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – List of variables used in the expression.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.get_var2val">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">get_var2val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../ir.html#tvm.ir.RelaxExpr" title="tvm.ir.expr.RelaxExpr"><span class="pre">RelaxExpr</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.get_var2val" title="Link to this definition"></a></dt>
<dd><p>Get a mapping from relax.Var to Expr for each variable in the function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.Function"><em>Function</em></a>) – The input function to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A mapping from relax.Var to Expr.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>, Expr]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.has_reshape_pattern">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">has_reshape_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../tir/tir.html#tvm.tir.PrimFunc" title="tvm.tir.function.PrimFunc"><span class="pre">PrimFunc</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.has_reshape_pattern" title="Link to this definition"></a></dt>
<dd><p>Check if the given PrimFunc is essentially doing a reshape operation.
The reshape operation also includes expand_dims, squeeze, flatten, etc.</p>
<p>Here the allowed reshape pattern is: for example, assume the operation is
<cite>B[l_0, l_1, …, l_b] = A[r_0, r_1, …, r_a]</cite>, we check if we can prove
that the flattened index of l_0, …, l_b under buffer B equals to the
flattened index of r_0, …, r_a under buffer A.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<a class="reference internal" href="../tir/tir.html#tvm.tir.PrimFunc" title="tvm.tir.PrimFunc"><em>tir.PrimFunc</em></a>) – The function to be examined.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – A boolean indicating if the given PrimFunc is doing a reshape.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>According to the description above, the returned result can only be
false-negative and cannot be false-positive, since whenever we cannot
prove the equality, we return false. This property guarantees the safety
of this function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.name_to_binding">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">name_to_binding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Binding" title="tvm.relax.expr.Binding"><span class="pre">Binding</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.name_to_binding" title="Link to this definition"></a></dt>
<dd><p>Return a map from variable name to its bindings.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.post_order_visit">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">post_order_visit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fvisit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.relax.analysis.post_order_visit" title="Link to this definition"></a></dt>
<dd><p>Recursively visit the ir in post DFS order node,
apply fvisit. Each node is guaranteed to be visited
only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>tvm.relax.Expr</em>) – The input expression.</p></li>
<li><p><strong>fvisit</strong> (<em>function</em>) – The visitor function to be applied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.remove_all_unused">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">remove_all_unused</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.remove_all_unused" title="Link to this definition"></a></dt>
<dd><p>It removes:
1. Unused local VarBindings in a DataflowBlock.
2. Unused DataflowBlocks in a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.Function"><em>Function</em></a>) – The input function to be analyzed.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For IRModule-wise DCE, use py:func:<cite>tvm.relax.transform.DeadCodeElimination</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The function with unused variables removed.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.Function">Function</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.struct_info_base_check">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">struct_info_base_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">derived</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tvm.relax.analysis.BaseCheckResult" title="tvm.relax.analysis.analysis.BaseCheckResult"><span class="pre">BaseCheckResult</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.struct_info_base_check" title="Link to this definition"></a></dt>
<dd><p>Run a base check to see if base subsumes derived.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The base struct info.</p></li>
<li><p><strong>derived</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The derived struct info.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The derived return value struct info.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo">StructInfo</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.struct_info_lca">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">struct_info_lca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.struct_info_lca" title="Link to this definition"></a></dt>
<dd><p>Unify the two struct info to their least common ancestor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lhs</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The left operand.</p></li>
<li><p><strong>rhs</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The right operand.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The corresponding lca result.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo">StructInfo</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.suggest_layout_transforms">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">suggest_layout_transforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../tir/tir.html#tvm.tir.PrimFunc" title="tvm.tir.function.PrimFunc"><span class="pre">PrimFunc</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_buffer_transforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../tir/tir.html#tvm.tir.IndexMap" title="tvm.tir.function.IndexMap"><span class="pre">IndexMap</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../tir/tir.html#tvm.tir.SBlock" title="tvm.tir.stmt.SBlock"><span class="pre">SBlock</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../tir/tir.html#tvm.tir.SBlock" title="tvm.tir.stmt.SBlock"><span class="pre">SBlock</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../tir/tir.html#tvm.tir.Buffer" title="tvm.tir.buffer.Buffer"><span class="pre">Buffer</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../tir/tir.html#tvm.tir.IndexMap" title="tvm.tir.function.IndexMap"><span class="pre">IndexMap</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.suggest_layout_transforms" title="Link to this definition"></a></dt>
<dd><p>Suggest Layout transformations of blocks and buffers in a PrimFunc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<a class="reference internal" href="../tir/tir.html#tvm.tir.PrimFunc" title="tvm.tir.PrimFunc"><em>PrimFunc</em></a>) – PrimFunc on which analysis will be performed and transformations suggested.</p></li>
<li><p><strong>write_buffer_transforms</strong> (<em>List</em><em>[</em><em>Union</em><em>[</em><a class="reference internal" href="../tir/tir.html#tvm.tir.IndexMap" title="tvm.tir.IndexMap"><em>IndexMap</em></a><em>, </em><em>Callable</em><em>]</em>) – List of layout transformations on the output buffers. The number of layout
transformations must match the number of outputs of the PrimFunc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – Suggested transforms per block in <cite>func</cite>. For each block the returned value is a map
from the object (block or buffer) to it’s index map transformation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="../tir/tir.html#tvm.tir.SBlock" title="tvm.tir.SBlock">SBlock</a>, Dict[Union[<a class="reference internal" href="../tir/tir.html#tvm.tir.SBlock" title="tvm.tir.SBlock">SBlock</a>, <a class="reference internal" href="../tir/tir.html#tvm.tir.Buffer" title="tvm.tir.Buffer">Buffer</a>], <a class="reference internal" href="../tir/tir.html#tvm.tir.IndexMap" title="tvm.tir.IndexMap">IndexMap</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.tir_vars_in_struct_info">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">tir_vars_in_struct_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sinfo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.expr.StructInfo"><span class="pre">StructInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../tir/tir.html#tvm.tir.Var" title="tvm.tir.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.tir_vars_in_struct_info" title="Link to this definition"></a></dt>
<dd><p>Get the TIR variables that appear in the input struct info.
The returned list is deduplicated - each TIR variable will appear at most once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sinfo</strong> (<a class="reference internal" href="relax.html#tvm.relax.StructInfo" title="tvm.relax.StructInfo"><em>StructInfo</em></a>) – The struct info object to be analyzed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – The list of TIR variables that appear in the input struct info.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="../tir/tir.html#tvm.tir.Var" title="tvm.tir.Var">tir.Var</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.udchain">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">udchain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="relax.html#tvm.relax.DataflowBlock" title="tvm.relax.expr.DataflowBlock"><span class="pre">DataflowBlock</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.expr.Var"><span class="pre">Var</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#tvm.relax.analysis.udchain" title="Link to this definition"></a></dt>
<dd><p>Analyze the variable use-def chain in a dataflow block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dfb</strong> (<a class="reference internal" href="relax.html#tvm.relax.DataflowBlock" title="tvm.relax.DataflowBlock"><em>DataflowBlock</em></a>) – The dataflow block to analyze</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A mapping from variable definition to its uses.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>, List[<a class="reference internal" href="relax.html#tvm.relax.Var" title="tvm.relax.Var">relax.Var</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.well_formed">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">well_formed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.IRModule" title="tvm.ir.module.IRModule"><span class="pre">IRModule</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_struct_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.well_formed" title="Link to this definition"></a></dt>
<dd><p>Check if the IRModule is well formed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<em>Union</em><em>[</em><em>tvm.IRModule</em><em>, </em><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.Function"><em>Function</em></a><em>]</em>) – The input IRModule or relax.Function.</p></li>
<li><p><strong>check_struct_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – A boolean flag indicating if the property “every Expr must
have defined structure info” will be checked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ret</strong> – True if the IRModule is well formed, False if not.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default the structure info is always checked. It is only in test cases
where <cite>check_struct_info</cite> might be false, so that other well-formed requirements
will be well tested and will not be blocked by not having structure info.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tvm.relax.analysis.estimate_memory_usage">
<span class="sig-prename descclassname"><span class="pre">tvm.relax.analysis.</span></span><span class="sig-name descname"><span class="pre">estimate_memory_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../ir.html#tvm.ir.IRModule" title="tvm.ir.module.IRModule"><span class="pre">IRModule</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.expr.Function"><span class="pre">Function</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="headerlink" href="#tvm.relax.analysis.estimate_memory_usage" title="Link to this definition"></a></dt>
<dd><p>Analysis function that estimates the memory usage of Relax functions
in an IRModule. The estimation includes the total memory size needed to
be allocated before and after memory planning.</p>
<p>The result might be over-estimated, as the estimation is static, which
does not consider control flows (such as “if” and cross-function calls).
It simply accumulates the size of every alloc_tensor and alloc_storage.</p>
<p>This analysis function is used to demonstrate the effect of memory
planning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mod</strong> (<em>Union</em><em>[</em><a class="reference internal" href="../ir.html#tvm.ir.IRModule" title="tvm.ir.IRModule"><em>IRModule</em></a><em>, </em><a class="reference internal" href="relax.html#tvm.relax.Function" title="tvm.relax.Function"><em>Function</em></a><em>]</em>) – The input IRModule whose functions inside are to be analyzed.
If the input is a Function, we will wrap it with a IRModule, with
the function named “main”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>est</strong> – The estimation information, in the form of a string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We regards “relax.memory.alloc_tensor/storage” as the results produced by memory planning.</p>
</dd></dl>

</section>


           </div>
           
          </div>
          

<footer>

    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="block_builder.html" class="btn btn-neutral float-right" title="tvm.relax.block_builder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="relax.html" class="btn btn-neutral float-left" title="tvm.relax" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>

<div id="button" class="backtop"><img src="../../../../_static/img/right.svg" alt="backtop"/> </div>
<section class="footerSec">
    <div class="footerHeader">
      <div class="d-flex align-md-items-center justify-content-between flex-column flex-md-row">
        <div class="copywrite d-flex align-items-center">
          <h5 id="copy-right-info">© 2024 Apache Software Foundation | All rights reserved</h5>
        </div>
      </div>

    </div>

    <div>
      <div class="footernote">Copyright © 2024 The Apache Software Foundation. Apache TVM, Apache, the Apache feather, and the Apache TVM project logo are either trademarks or registered trademarks of the Apache Software Foundation.</div>
    </div>

</section>
</footer>
        </div>
      </div>

    </section>

  </div>
  

    <script src="../../../../_static/downloads/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="../../../../_static/downloads/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

  </body>
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>