<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tvm: include/tvm/ir/transform.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tvm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b4c7d8e826c599ba55146c099a14beb5.html">tvm</a></li><li class="navelem"><a class="el" href="dir_dc867ff9a37cad1764f1670dc7eba6c1.html">ir</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">transform.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="diagnostic_8h_source.html">tvm/ir/diagnostic.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="error_8h_source.html">tvm/ir/error.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="instrument_8h_source.html">tvm/ir/instrument.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="ir_2module_8h_source.html">tvm/ir/module.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="array_8h_source.html">tvm/runtime/container/array.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">tvm/runtime/container/string.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="with_8h_source.html">tvm/support/with.h</a>&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;utility&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for transform.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ir_2transform_8h__incl.svg" width="4734" height="1291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ir_2transform_8h__dep__incl.svg" width="5319" height="663"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="ir_2transform_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1transform_1_1PassContextNode.html">tvm::transform::PassContextNode</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classtvm_1_1transform_1_1PassContextNode.html" title="PassContextNode contains the information that a pass can rely on, such as analysis results...">PassContextNode</a> contains the information that a pass can rely on, such as analysis results.  <a href="classtvm_1_1transform_1_1PassContextNode.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1transform_1_1PassContext.html">tvm::transform::PassContext</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classtvm_1_1transform_1_1PassContext.html" title="PassContext that is used to configure the pass behavior. ">PassContext</a> that is used to configure the pass behavior.  <a href="classtvm_1_1transform_1_1PassContext.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1transform_1_1PassInfoNode.html">tvm::transform::PassInfoNode</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Meta data that will be used to help optimization and analysis.  <a href="classtvm_1_1transform_1_1PassInfoNode.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1transform_1_1PassInfo.html">tvm::transform::PassInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Managed reference class for <a class="el" href="classtvm_1_1transform_1_1PassInfoNode.html" title="Meta data that will be used to help optimization and analysis. ">PassInfoNode</a>.  <a href="classtvm_1_1transform_1_1PassInfo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1transform_1_1PassNode.html">tvm::transform::PassNode</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classtvm_1_1transform_1_1PassNode.html" title="PassNode is the base type of differnt types of optimization passes. It is designed as a pure class an...">PassNode</a> is the base type of differnt types of optimization passes. It is designed as a pure class and implemented by different pass subclasses at different granularity of Relay nodes.  <a href="classtvm_1_1transform_1_1PassNode.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1transform_1_1Pass.html">tvm::transform::Pass</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1transform_1_1SequentialNode.html">tvm::transform::SequentialNode</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classtvm_1_1transform_1_1SequentialNode.html" title="The SequentialNode contains a set of passes that transform Relay programs from one AST to another sem...">SequentialNode</a> contains a set of passes that transform Relay programs from one AST to another semantically equivalent one.  <a href="classtvm_1_1transform_1_1SequentialNode.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtvm_1_1transform_1_1Sequential.html">tvm::transform::Sequential</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacetvm"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm.html">tvm</a></td></tr>
<tr class="memdesc:namespacetvm"><td class="mdescLeft">&#160;</td><td class="mdescRight">runtime implementation for LibTorch/TorchScript. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacetvm_1_1transform"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1transform.html">tvm::transform</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af18caf4263a1f9e5f8f300c4aae5e094"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ir_2transform_8h.html#af18caf4263a1f9e5f8f300c4aae5e094">TVM_PASS_CTX_CONFIG_VAR_DEF</a>&#160;&#160;&#160;static <a class="el" href="object_8h.html#a744c2fdb7ff7dc43070c1841a5873c84">TVM_ATTRIBUTE_UNUSED</a> uint32_t __make_PassContext_tid</td></tr>
<tr class="separator:af18caf4263a1f9e5f8f300c4aae5e094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5576002bc3ea1141558d1afa1aca33b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ir_2transform_8h.html#a5576002bc3ea1141558d1afa1aca33b6">TVM_REGISTER_PASS_CONFIG_OPTION</a>(Key,  ValueType)</td></tr>
<tr class="memdesc:a5576002bc3ea1141558d1afa1aca33b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper macro to register the object type to runtime. Makes sure that the runtime type table is correctly populated.  <a href="#a5576002bc3ea1141558d1afa1aca33b6">More...</a><br /></td></tr>
<tr class="separator:a5576002bc3ea1141558d1afa1aca33b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a241d7d09dbbff79f935e67a8c5fce7e9"><td class="memItemLeft" align="right" valign="top">Pass&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1transform.html#a241d7d09dbbff79f935e67a8c5fce7e9">tvm::transform::CreateModulePass</a> (const runtime::TypedPackedFunc&lt; IRModule(IRModule, PassContext)&gt; &amp;pass_func, int opt_level, String name, Array&lt; runtime::String &gt; required)</td></tr>
<tr class="separator:a241d7d09dbbff79f935e67a8c5fce7e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cca5b98fb5d34e66444343786d85529"><td class="memItemLeft" align="right" valign="top">Pass&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetvm_1_1transform.html#a8cca5b98fb5d34e66444343786d85529">tvm::transform::PrintIR</a> (String header=&quot;&quot;, bool show_meta_data=false)</td></tr>
<tr class="memdesc:a8cca5b98fb5d34e66444343786d85529"><td class="mdescLeft">&#160;</td><td class="mdescRight">A special trace pass that prints the header and IR to LOG(INFO).  <a href="namespacetvm_1_1transform.html#a8cca5b98fb5d34e66444343786d85529">More...</a><br /></td></tr>
<tr class="separator:a8cca5b98fb5d34e66444343786d85529"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file implements a pass manager. The pass manager manages a sequence of IRModule -&gt; IRModule transformation passes over a particlar unit of AST. The design is largely inspired from LLVM's pass manager and modern deep learning frameworks that perform tensor-&gt;tensor transformations.</p>
<p>The responsibilities of a traditional compiler pass manager usually involves:</p><ul>
<li>Organizing the execution order of optimization passes though not necessarily in the optimal sequence.</li>
<li>Collecting required analysis information and keep them up-to-date.</li>
<li>Reducing the effort required to implement new passes for compiler developers, etc.</li>
</ul>
<p>Similar to LLVM's pass manager, we designed the Relay pass manager to work different granularity, i.e. module level, function level, and even sequential passe that contains a host of passes.</p>
<p>However, we also extend the functionality of the traditional pass manager with the consideration of requirements/convention from deep learning frameworks, such as Pytorch and Gluon, etc. Each pass in the Relay pass manager performs the IRModule -&gt; IRModule transformation. All different types of passes, including the sequential-level pass object, are essentially pass objects. This design, therefore, effectively provides users a consistent and convenient interface, i.e. Pass, to play with. It offers a means to ease the development and testing of Relay passes. For example, with the pass manager, external users will be able to have custom passes correctly scheduled without having to modify a single handcrafted pass order.</p>
<p>In the future we need to describe constraints between passes. For example, we may want to preserve dependencies between different passes and validate them on the completion of a certain pass.</p>
<p>We also need to store side information and import the error reporting system. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af18caf4263a1f9e5f8f300c4aae5e094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af18caf4263a1f9e5f8f300c4aae5e094">&#9670;&nbsp;</a></span>TVM_PASS_CTX_CONFIG_VAR_DEF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TVM_PASS_CTX_CONFIG_VAR_DEF&#160;&#160;&#160;static <a class="el" href="object_8h.html#a744c2fdb7ff7dc43070c1841a5873c84">TVM_ATTRIBUTE_UNUSED</a> uint32_t __make_PassContext_tid</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5576002bc3ea1141558d1afa1aca33b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5576002bc3ea1141558d1afa1aca33b6">&#9670;&nbsp;</a></span>TVM_REGISTER_PASS_CONFIG_OPTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TVM_REGISTER_PASS_CONFIG_OPTION</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">Key, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ValueType&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code" href="object_8h.html#a73bf3e57b9d7a6e0dd55d901321d01ed">TVM_STR_CONCAT</a>(<a class="code" href="ir_2transform_8h.html#af18caf4263a1f9e5f8f300c4aae5e094">TVM_PASS_CTX_CONFIG_VAR_DEF</a>, __COUNTER__) = \</div><div class="line">      ::tvm::transform::PassContext::RegisterConfigOption&lt;ValueType&gt;(Key)</div><div class="ttc" id="object_8h_html_a73bf3e57b9d7a6e0dd55d901321d01ed"><div class="ttname"><a href="object_8h.html#a73bf3e57b9d7a6e0dd55d901321d01ed">TVM_STR_CONCAT</a></div><div class="ttdeci">#define TVM_STR_CONCAT(__x, __y)</div><div class="ttdef"><b>Definition:</b> object.h:684</div></div>
<div class="ttc" id="ir_2transform_8h_html_af18caf4263a1f9e5f8f300c4aae5e094"><div class="ttname"><a href="ir_2transform_8h.html#af18caf4263a1f9e5f8f300c4aae5e094">TVM_PASS_CTX_CONFIG_VAR_DEF</a></div><div class="ttdeci">#define TVM_PASS_CTX_CONFIG_VAR_DEF</div><div class="ttdef"><b>Definition:</b> transform.h:267</div></div>
</div><!-- fragment -->
<p>Helper macro to register the object type to runtime. Makes sure that the runtime type table is correctly populated. </p>
<p>Use this macro in the cc file for each terminal class. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
